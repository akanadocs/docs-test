---
layout: page
title: Upgrading Akana API Platform 8.2 to 8.4
description: Provides instructions for upgrading from Akana API Platform 8.2 to Akana API Platform 8.4.
product: sp
category: ref
sub-nav-class: Upgrade - Akana API Platform
weight: 5
type: page
nav-title: Upgrade 8.2 to 8.4
---
<h2 id="top">Upgrading Akana API Platform From Version 8.2 to Version 8.4x</h2>
<p>Learn how to download, install, and configure the Akana API Platform 8.2x, including the Akana Platform and all features previously included in Policy Manager and Community Manager.</p>
<p><strong>Note</strong>: If you’re upgrading Policy Manager for DataPower, follow the steps in this document that you would use for upgrading Network Director.</p>
<p><strong>Note</strong>: This document covers instructions for the combined features available in version 8.2x. For versions prior to 8.2x, see <a href="../platform_install/installing_policy_manager_v80.htm">Installing Policy Manager 8.x</a>.</p>

<p>
<a href="../admin_console/using_admin_console.htm" class="button secondary">Using Admin Console</a>
<a href="../admin_console/installing_tools.htm" class="button secondary">Installing Tools</a>
<a href="../admin_console/installing_plugins.htm" class="button secondary">Installing Plug-ins</a></p>

<p>
<a href="../../ag/assets/PM_ConfigurationCategories_6x_7x.pdf" class="button secondary">Configuration Categories</a>
<a href="../admin_console/config_actions.htm" class="button secondary">Configuration Actions</a></p>

<h5 class="stamp">Supported Platforms: 8.4x</h5>
<div class = "divider1"></div>
<h3 style="color: gray;">Table of Contents</h3>




<h5 style="color: gray;"><a href="#h_upgrade_planning">Planning the Upgrade</a></h5>


<ol class="table_of_contents">
  <li><a href="#01_00">Overview</a></li>
  <li><a href="#01_01">Step 1-1: Review release notes</a></li>
  <li><a href="#01_02">Step 1-2: Plan the upgrade for additional features</a></li>
  <li><a href="#01_03">Step 1-3: Gather ZIP files and create folder</a></li>
</ol>



<h5 style="color: gray;"><a href="#h_upgrade_performing">Performing the Upgrade</a></h5>



<ol class="table_of_contents">
  <li><a href="#02_00">Overview</a></li>
  <li><a href="#02_0a">Step 2-0a: Conditional, Pre-Upgrade Task for upgrades from 8.0.5 or earlier</a></li>
  <li><a href="#02_0b">Step 2-0b: Conditional, if Akana Integration Services feature is installed: uninstall the feature</a></li>
  <li><a href="#02_01">Step 2-1: Turn off scheduled jobs</a></li>
  <li><a href="#02_02">Step 2-2: Back up Policy Manager 8.0 and stop container</a></li>
  <li><a href="#02_03">Step 2-3: Extract new ZIP files in sequence</a></li>
  <li><a href="#02_04">Step 2-4: Copy AP82 container instances to AP84</a></li>
  <li><a href="#02_05">Step 2-5: Clear Configurator cache (if needed)</a></li>
  <li><a href="#02_06">Step 2-6: Upgrade container</a></li>
  <li><a href="#02_07">Step 2-7: Upgrade additional containers</a></li>
  <li><a href="#02_08">Step 2-8: (Conditional): Unregister and re-register the Windows service</a></li>
  <li><a href="#02_09">Step 2-9: Start the containers</a></li>
  <li><a href="#02_10">Step 2-10: Clear browser cache</a></li>
  <li><a href="#02_11">Step 2-11: Launch the Akana Administration Console</a></li>
  <li><a href="#02_12">Step 2-12: Refresh repository</a></li>
  <li><a href="#02_13">Step 2-13: Verify that features were updated correctly</a></li>
  <li><a href="#02_14">Step 2-14: Run pending installation tasks and restart container</a></li>
  <li><a href="#02_15">Step 2-15: Upgrade all containers before installing the upgrade tool</a></li>
  <li><a href="#02_16">Step 2-16: Install Akana AP 8.4 upgrade tool to upgrade database</a></li>
  <li><a href="#02_17">Step 2-17: After installing upgrade tool, complete configuration</a></li>
  <li><a href="#02_18">Step 2-18: Turn scheduled jobs back on</a></li>
  <li><a href="#02_19">Step 2-19: Update container metadata and authentication options</a></li>
</ol>



<h5 style="color: gray;"><a href="#h_post_upgrade_tasks_old">Post-Upgrade Tasks OLD</a></h5>



<ol class="table_of_contents">
  <li><a href="#03_00_old">Overview: Completing the API Platform Post-Upgrade Tasks (old)</a></li>
  <li><a href="#03_01_old">Step 3-1: Upgrade CM Models</a></li>
  <li><a href="#03_02_old">Step 3-2: Update CM API</a></li>
  <li><a href="#03_03_old">Step 3-3: (Conditional): Update OAuth API</a></li>
  <li><a href="#03_04_old">Step 3-4: (Conditional): Rebuild CM Styles</a></li>
</ol>



<h5 style="color: gray;"><a href="#h_post_upgrade_tasks">Post-Upgrade Tasks {{NEW}}</a></h5>



<ol class="table_of_contents">
  <li><a href="#03_00">Upgrade tasks when upgrading to 8.4: Overview</a></li>
  <li><a href="#03_01">Step 3-1: Run upgrade tool: "Akana 8.2 to 8.4 model upgrade"</a></li>
  <li><a href="#03_02">Step 3-2: Post-Upgrade Task for upgrades to 8.4: Provisioning and Upgrade CM Models tasks</a></li>
  <li><a href="#03_03">Step 3-3: Upgrade task when upgrading to 8.4: delete and install object mappings</a></li>
  <li><a href="#03_04">Step 3-4: Post-Upgrade Task for upgrades to 8.4: MongoDB Updates</a></li>
  <li><a href="#03_05">Step 3-5: Post-Upgrade Task for upgrades to 8.4: Rebuild CM Styles</a></li>
</ol>



<div class = "divider1"></div>
<a name="h_upgrade_planning"></a><h3>Planning the Upgrade</h3>




<a name="01_00"></a><h4>Overview</h4>
<p>There are some steps you might need to take before starting the upgrade process, and some information you’ll need to consider to determine how to proceed, including:</p>
<ul>
  <li>Review the Akana API Platform release notes</li>
  <li>Plan the upgrade for additional features.</li>
  <li>Gather ZIP files and create folder.</li>
</ul>
<p><a href="#top">back to top</a></p>



<a name="01_01"></a><h4>Step 1-1: Review release notes</h4>
<p>Review the release notes so that you are aware of changes to the platform. Check for upgrade notes.</p>
<p>Release notes are available from the Akana support site.</p>
<p><a href="#top">back to top</a></p>



<a name="01_02"></a><h4>Step 1-2: Plan the upgrade for additional features</h4>
<p>If you have a specific add-on feature installed, such as the Integration Services option pack, SiteMinder Security Provider, or SAML Web SSO Security Provider feature, it’s important that you download the new release version package for the same feature.</p>
<p><strong>Note</strong>: In version 8.2, some of the additional packages have been incorporated into the Akana API Platform along with Community Manager and Policy Manager. Depending on the additional features you’re using, you might not have to install updates. {{follow up for more info on features}}</p>
<p>If one of the features is installed in a container that you copy over from the earlier version during the upgrade process, and you don’t upgrade the add-on, container startup might fail after you complete the upgrade process. When you upgrade, make sure you have the latest version for any features you’re using. See <a href="#02_13">Step 2-13: Verify that features were updated correctly</a>.</p>
<p><strong>Note</strong>: The SAML Web SSO feature remains at version 8.0. There is no upgrade to version 8.4.</p>
<p><strong>Note</strong>: If you’re upgrading from an earlier version up to and including 8.0.5, you’ll need to uninstall a specific bundle, com.soa.oauth.interfaces, as the first step before starting the upgrade procedure. For instructions, see <a href="#02_0a">Step 2-0a: Conditional, Pre-Upgrade Task for upgrades from 8.0.5 or earlier</a>.</p>
<p><a href="#top">back to top</a></p>



<a name="01_03"></a><h4>Step 1-3: Gather ZIP files and create folder</h4>
<p>Before starting the upgrade, gather all the ZIP files from the Akana Support site, and collect any other information you’ll need for the entire process.</p>
<p>You’ll need all the ZIP files listed below. They are listed in the order in which they should be installed.</p>
<p>All files listed below are available from the Akana Support site, <strong>Downloads</strong> page: https://library.akana.com/display/MAIN/Downloads.</p>
<p>You’ll need to install files for:</p>
<ol>
  <li><strong>The Akana Platform</strong>: an OSGI environment. Akana features run within this environment, obey its constraints, and make use of its facilities. The platform supports Windows and Unix (Linux, Solaris, AIX) environments.</li>
  <li><strong>The Akana API Platform</strong>.</li>
  <li><strong>Add-Ons</strong>: Any platform add-ons you are using that are not included in the Akana API Platform. {{research}}
<p><strong>Note</strong>: If your installation uses the Akana Integration Services add-on, you’ll have to complete an extra step before beginning the upgrade process. Integration Services are now part of the main Akana API Platform installation ZIP file; there is no longer a separate bundle to install. However, you must uninstall the Akana Integration Services feature as the first step of the installation procedure. See <a href="#02_0b">Step 2-0b: Conditional, if Akana Integration Services feature is installed: uninstall the feature</a>.</p></li>
</ol>
<h5>Gather ZIP files and create folder</h5>
<ol>
  <li>On your installation machine, create a folder for the new version: for example, AP84 for API platform 8.4.</li>
  <li>In this folder, copy all the ZIP files listed below. You should have at minimum two files, with additional files if there are updates and/or add-ons.</li>
</ol>

<a name="upgrade_zips_82_84"></a><h5>ZIP files for upgrade to version 8.4</h5>
<ol>
  <li>To upgrade the Akana platform, first locate the appropriate file for the operating system you’re using (see http://docs.akana.com/sp/platform_install/installing_akana_platform.htm#download_platform_zip_84, section For Version 8.4). You’ll see the below or a later version (online doc not yet updated):
    <ol>
  <li>Windows (includes JRE): akana-platform-win-jre-8.4.xxx.zip </li>
  <li>Linux only (includes JRE): akana-platform-linux-jre-8.4.xxx.zip </li>
  <li>Windows, Linux, or Solaris (does not include JRE; provide your own JRE, version 1.8): akana-platform-8.4.xxx.zip
    <p><strong>Note</strong>: When using this JRE you must modify the bin/setDEMS.sh script and comment out lines that relate to your JRE and then ensure you have JAVA set correctly.</p></li>
</ol></li>
  <li>Check if there are any Akana platform updates, and if so download the latest ZIP file. 
<p><strong>Note</strong>: Akana API Platform 8.2 requires Akana Platform 8.4.</p></li>
  <li>To upgrade the Akana API platform to version 8.4, locate the file below, which contains all necessary files for Akana API Platform installation, including Policy Manager and Community Manager installation:
    <ul>
  <li>akana-api-platform-8.4.xxx.zip</li>
</ul></li>
  <li>Check if there are any Akana API platform updates, and if so download the latest ZIP file.</li>
</ol>
<h5>ZIP files for add-ons</h5>
<p>Check the Akana Support site, <strong>Downloads</strong> page: https://library.akana.com/display/MAIN/Downloads for the latest ZIP file for any additional add-ons you are using in your installation. Get all applicable update files for your installation. You’ll extract these after the other files.</p>
<p>For product compatibility information, refer to the applicable matrix on the Akana support site: https://library.akana.com/display/MAIN/Product+Compatibility+Matrices.</p>
<p><a href="#top">back to top</a></p>



<div class = "divider1"></div>
<a name="h_upgrade_performing"></a><h3>Performing the Upgrade</h3>



<a name="02_00"></a><h4>Overview</h4>
<p><strong>Note</strong>: The instructions in this document are for upgrade from Akana API Platform 8.2 to Akana API Platform 8.4. If you’re upgrading from a version earlier than 8.2, you’ll need to perform additional steps first, to upgrade to Policy Manager 8.0. For instructions, see http://docs.akana.com/ag/assets/AAP_80_82_Upgrade_Guide.pdf.</p>
<p>There is a conditional first step, see <a href="#02_0a">Step 2-0a: Conditional, Pre-Upgrade Task for upgrades from 8.0.5 or earlier</a> below.</p>
<p>Then, at a high level, to perform the upgrade, you’ll complete the following actions:</p>
<ol>
  <li>Install the Akana API Platform 8.4 in a new location.</li>
  <li>Copy the AP82 container instances to the instances folder for the AP84 installation.</li>
  <li>Perform the upgrade steps from the AP84 installation, following the exact sequence given below.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_0a"></a><h4>Step 2-0a: <span class="apidoc_red">Conditional, Pre-Upgrade Task for upgrades from 8.0.5 or earlier</span></h4>
<p><strong>{{<span class="apidoc_red">need to determine whether we need to do this step.</span>}}</strong></p>
<p>If you’re upgrading from an earlier version up to and including 8.0.5, and using Community Manager, and didn’t perform this step during a 7.2 to 8.0 upgrade, you’ll need to uninstall a specific bundle, com.soa.oauth.interfaces, as the first step before starting the upgrade procedure. </p>
<p>Complete this step before any other tasks.</p>
<p>Follow this procedure on all Policy Manager containers with Community Manager, or any Community Manager add-on features, installed.</p>
<h5>To uninstall the com.soa.oauth.interfaces bundle</h5>
<ol>
  <li>Identify the ID of the com.soa.oauth.interfaces bundle:
<ol>
  <li>Log in to the Akana Administration Console for the container.</li>
  <li>Click the <strong>Installed Features</strong> tab.</li>
  <li>From the drop-down menu at the top left, choose Bundle, as shown below.
<p><img src="images/000_00_bundle_com_soa_oauth_interfaces.jpg" alt="Choosing the com.soa.oauth.interfaces bundle" /></p>
  </li>
  <li>Look for the com.soa.oauth.interfaces bundle.</li>
  <li>Note the ID of the bundle (in the Bundle ID column).</li>
</ol></li>
  <li>Open up the shell or command prompt that you use to start the container.</li>
  <li>Run the following command to uninstall the bundle:
<pre>uninstall {bundleID}</pre></li>
  <li>{{note from Scott he is using a container that's already started, and he didn't start it from xxxand this command didn't work for him}}</li>
  <li>Repeat Steps 1–3 for any additional containers that have Policy Manager plus any Community Manager features installed.</li>
</ol>
<p>Once these steps are complete, proceed with the standard upgrade process.</p>
<p><a href="#top">back to top</a></p>



<a name="02_0b"></a><h4>Step 2-0b: <span class="apidoc_red">Conditional, if Akana Integration Services feature is installed: uninstall the feature</span></h4>
<p>If your previous installation included the Akana Integration Services feature, for integration with the Lifecycle Manager product, you won’t need to install that feature separately in 8.4. However, you’ll need to uninstall the existing version of the feature before continuing with the installation process.</p>
<h5>To uninstall the Akana Integration Services feature</h5>
<ol>
  <li>Log in to the version 8.0 Akana Administration Console using Administrator credentials.</li>
  <li>Click the <strong>Installed Features</strong> tab.</li>
  <li>Click the Akana Integration Services feature.</li>
  <li>In the right column, click the Uninstall icon.</li>
  <li>Follow the prompts to uninstall the feature.</li>
</ol>
<p>The next step is to start the upgrade.</p>
<p><a href="#top">back to top</a></p>



<a name="02_01"></a><h4>Step 2-1: Turn off scheduled jobs</h4>
<p>Before upgrading, you must turn off scheduled jobs in the configuration settings, including:</p>
<ul>
  <li>com.soa.scheduler.quartz</li>
  <li>simple.scheduler.enabled</li>
</ul>
<p>When upgrade is complete, you’ll turn these properties back on again (see <a href="#02_18">Step 2-18: Turn scheduled jobs back on</a>). </p>
<p><strong>Note</strong>: Perform this step for all AP84 containers with Policy Manager features installed.</p>
<h5>To turn off scheduled jobs</h5>
<ol>
  <li>Log in to the Akana Administration Console using Administrator credentials.</li>
  <li>Click the <strong>Configuration</strong> tab.</li>
  <li>Turn off com.soa.scheduler.quartz:
<ol>
  <li>In the <strong>Configuration Categories</strong> section, find <strong>com.soa.scheduler.quartz</strong>. </li>
  <li>Locate the <strong>org.quartz.scheduler.enabled</strong> property and change it to <strong>false</strong>.</li>
  <li>Click <strong>Apply Changes</strong>.</li>
</ol></li>
  <li>Turn off com.soa.scheduler:
<ol>
  <li>In the <strong>Configuration Categories</strong> section, find <strong>com.soa.scheduler</strong>. </li>
  <li>Locate the <strong>simple.scheduler.enabled</strong> property and change it to <strong>false</strong>, as shown below.
<p><img src="images/01_config_categ.jpg" alt="Turning off scheduled jobs" /></p></li>
  <li>Click <strong>Apply Changes</strong>.</li>
</ol></li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_02"></a><h4>Step 2-2: Back up <span class="apidoc_red">Policy Manager</span> 8.2 and stop container</h4>
<p>The next step is to back up your AP82 and stop containers, before you upgrade. Follow the steps below.</p>
<h5>To back up <span class="apidoc_red">Policy Manager 8.2</span> and stop containers</h5>
<ol>
  <li>Back up your AP82 database.</li>
  <li>Stop any containers that are currently running. 
<p>This is required to update the database schema to AP82. Stopping the containers ensures that the database is not locked while the update is in progress. For more information, refer to Starting and Stopping a Container Instance on the Akana docs site: http://docs.akana.com/sp/container_management/start_stop_container_instance.htm.</p></li>
  <li>Back up your AP82 release directory, using your database management tool, and save the backup file to a safe location. For example, if you’re using MySQL, the backup command might look <span class="apidoc_red">something like the below</span>:
<pre>C:\Program Files\MySQL\MySQL Server 5.1\bin>mysqldump.exe -e -u root -p -h localhost pm71 &gt; C:\backups\pm80-20160101</pre></li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_03"></a><h4>Step 2-3: Extract new ZIP files in sequence</h4>
<p>Now you’re ready to install the new version. Make sure you install from the various ZIP files in the correct sequence.</p>
<p><strong>Note</strong>: the filenames used below are examples. When you download files from the Support site, you might have an updated variation.</p>
<h5>To extract the new ZIP files</h5>
<p><strong>Note</strong>: When unzipping files, if you are prompted to replace a file, choose All to accept all the new files.</p>
<ol>
  <li>Go to the folder with the downloaded ZIP files, which you created earlier. See <a href="#01_03">Step 1-3: Gather ZIP files and create folder</a>.
<p>Make sure the folder includes all the ZIP files you’ll need for upgrade. You should have at least two files, and possibly more, as detailed in <a href="#upgrade_zips_82_84">ZIP files for upgrade to version 8.4</a>.</p></li>
  <li>Extract the Akana platform file: 
<ol>
  <li>akana-platform-win-jre-8.4.xxx.zip or comparable file for Linux or other operating system.</li>
  <li>If there are any updates for the Akana Platform, extract the update file next.</li>
</ol></li>
  <li>Extract the Akana API Platform file (contains all necessary files for Policy Manager and API Platform/Community Manager installation): 
<ol>
  <li>akana-api-platform-8.4.xxx.zip </li>
  <li>If there are any updates for the Akana API Platform, extract the update file next.</li>
</ol></li>
  <li>Extract the ZIP files for any add-ons you’re using.</li>
</ol>
<p><strong>Note</strong>: After the installation is complete, do not launch the Configure Container Instance Wizard/configure the API Platform container until you’ve completed the next step, below.</p>
<p><a href="#top">back to top</a></p>



<a name="02_04"></a><h4>Step 2-4: Copy AP82 container instances to AP84</h4>
<p>The next step is to copy container instances to your new installation.</p>
<h5>To copy<span class="apidoc_red"> AP82 Container Instances to AP84</span></h5>
<ol>
  <li>Go to the AP82 backup directory, and locate the AP82 container instances. For example:
AP82/instances/{instance}</li>
  <li>Copy the AP82 container instances. Note:
    <ul>
  <li>Include AP82, Network Director, and Agent container instances. </li>
  <li>Do not include <span class="apidoc_red">the PM80 configurator or the PM80 default container folder</span>.
<p>An example is shown below.</p>
<p><img src="images/02_update_instances.jpg" alt="Copy container instances" /></p></li>
</ul></li>
  <li>In the AP84 container instances folder (AP84/instances/{pm_instance}, paste the container instances that you copied.</li>
  <li>Delete the log folder so that the logs will only include information for the new version, not for the old version.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_05"></a><h4>Step 2-5: Clear Configurator cache (if needed)</h4>
<p>Before performing the upgrade, make sure the configurator cache is clear. At this point, there won’t be any cache unless you launched the Configurator at the end of Step 2-3. To be sure, follow the steps below.</p>
<h5>To clear configurator cache</h5>
<ol>
  <li>Locate the configurator cache folder: \instances\configurator\cache, as shown below.
<p><img src="images/01_05_configurator_cache.jpg" alt="Configurator cache folder" /></p></li>
  <li>Delete the folder if it exists (if there is no cache, the folder will not be there).</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_06"></a><h4>Step 2-6: Upgrade container</h4>
<p>You’ll need to perform the upgrade procedure on each container you’re upgrading to AP84, using the <strong>Configure Container Instance</strong> wizard.</p>
<p>First upgrade the Policy Manager container, then Network Director, and then any other containers.</p>
<p><strong>Note</strong>: Before you upgrade, make sure you’ve completed all previous steps, including copying the container instances (see <a href="#02_04">Step 2-4: Copy AP82 container instances to AP84</a>).</p>
<p>There are three ways you can upgrade the container:</p>
<ul>
  <li>Via the user interface: see <a href="#02_06_01">Upgrade container to Akana API Platform 8.4 (GUI)</a>.</li>
  <li>Silent install: see <a href="#02_06_02">Upgrade container to Akana API Platform 8.4 (silent upgrade)</a>.</li>
  <li>Command line install: see <a href="#02_06_03">Upgrade container to Akana API Platform 8.4 (command line)</a>.</li>
</ul>


<a name="02_06_01"></a><h4>Upgrade container to Akana API Platform 8.4 (GUI)</h4>
<p>Upgrade via the GUI launches the Configurator wizard, which walks you through the upgrade process.</p>
<h5>To upgrade the container to Akana API Platform 8.4 (via the GUI)</h5>
<ol>
  <li>Open up a command prompt.</li>
  <li>Go to the new folder where you unzipped the version 8.4 files, then navigate to the \bin subfolder and run the following command:
<pre>startup configurator</pre></li>
  <li>The Configurator starts, and the <strong>Welcome to Configure Container Instance Wizard</strong> page displays. Click <strong>Next</strong>.</li>
  <li>At the Instance Name screen, specify the name of the Akana container instance the upgrade will be applied to, as shown in the example below (same name as previous installation). Leave the Container Key field blank; the upgrade process will use the container key for the container being upgraded. Click <strong>Next</strong>.
<p><img src="images/01_06_InstanceName.jpg" alt="Instance Name page" /></p></li>
  <li>At the <strong>Instance Already Exists page</strong>, to apply the AP82 to AP84 upgrade, click <strong>Update</strong>, as shown below, and then click <strong>Next</strong>.
<strong>Note</strong>: This updates the instance you copied over in <a href="#02_04">Step 2-4: Copy AP82 container instances to AP84</a>.
<p><img src="images/01_06_instance_already_exists.jpg" alt="Instance Already Exists message" /></p></li>
  <li>At the <strong>Instance Configuration Summary</strong> page, shown below, verify that the instance has been stopped, and then click <strong>Finish</strong>.
<p><img src="images/01_06_Instance_Config_Summary.jpg" alt="Instance Configuration Summary page" /></p></li>
  <li>When the container update process is complete, the <strong>Update Complete</strong> page displays with a summary of the number of bundles that were updated.</li>
  <li>Click <strong>OK</strong> to close the wizard.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_06_02"></a><h4>Upgrade container to Akana API Platform 8.4 (silent upgrade)</h4>
<p>You can set up the Configure Container Instance Wizard update process to run in an automated mode (silent mode).</p>
<p>To do this you essentially need to set up a properties file that contains a set of property values that the wizard uses to automatically configure a container instance.</p>
<h5>To upgrade to Akana API Platform 8.4 using silent mode</h5>
<ol>
  <li>Define a properties file for upgrade in silent mode:
<ol>
  <li>Choose a file name; for example, upgrade.properties.</li>
  <li>In the file, add the following default content:
<pre>container.instance.name=[container_instance_name]
wizard.mode=update</pre>
<p>For example:</p>
<pre>container.instance.name=policymanager
wizard.mode=update</pre></li>
</ol></li>
  <li>Determine system properties you want to use when running the upgrade in silent mode. There are two possible properties, which together are used to perform the silent upgrade:
<ol>
  <li>silent (If true, silent configuration will be performed)</li>
  <li>properties (path/filename for properties file to be used for configuration)</li>
</ol></li>
  <li>Run the upgrade in silent mode, using either of the following commands, depending on the operating system:
<ul>
  <li>Windows:
<pre>\bin>startup.bat configurator "-Dsilent=true" "-Dproperties={property file directory location}\upgrade.properties"</pre></li>
  <li>Unix:
<pre>/bin>startup.sh configurator -Dsilent=true -Dproperties=opt/{property file directory location}/upgrade.properties</pre></li>
</ul></li>
  <li>Repeat for Network Director or Agent containers:
<ol>
  <li>Before upgrading each instance, repeat <a href="#02_05">Step 2-5: Clear Configurator cache (if needed)</a>.</li>
  <li>Then, for each container, repeat the steps above.</li>
</ol></li>
  <li>Optional post-upgrade step for silent mode users not using the Admin Console:
<ol>
  <li>If you will not be using the Akana Administration Console, you can install the Policy Manager 8.4.0 schema manually using a third-party database schema management tool.</li>
  <li>For assistance in installing the schema, contact Akana Customer Support.</li>
</ol></li>
</ol>
<p><strong>Note</strong>: If you are not using the Akana Administration Console, you are done with the upgrade; skip the rest of the upgrade steps.</p>


<a name="02_06_03"></a><h4>Upgrade container to Akana API Platform 8.4 (command line)</h4>
<p>You can also perform the upgrade process from the command line. Follow the steps below.</p>
<h5>To upgrade to Akana API Platform 8.4 from the command line</h5>
<ol>
  <li>Execute the following in the \bin folder depending on your operating system:
<ul>
  <li>Windows:
<pre>startup.bat configurator "-Dsilent=true" "-Dcontainer.instance.name={Instance name}"  "-Dwizard.mode=update"</pre></li>
  <li>Unix:
<pre>startup.sh configurator -Dsilent=true -Dcontainer.instance.name={instance name} -Dwizard.mode=update</pre></li>
</ul></li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_07"></a><h4>Step 2-7: Upgrade additional containers</h4>
<p>Repeat the upgrade process for all additional containers:</p>
<ul>
  <li>First, any additional containers running Policy Manager and/or the API Platform.</li>
  <li>Then, any Network Director or Agent containers.</li>
</ul>
<h5>To upgrade additional containers</h5>
<ol>
  <li>Before upgrading each instance, repeat <a href="#02_05">Step 2-5: Clear Configurator cache (if needed)</a>.</li>
  <li>Then, for each container, repeat <a href="#02_06">Step 2-6: Upgrade container</a>.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_08"></a><h4>Step 2-8: (Conditional): Unregister and re-register the Windows service</h4>
<p>If your containers are registered as a Windows service, so that the container will start automatically when Windows starts, you must unregister the old version and register the new version, for each container.</p>
<p>If you’re not sure which containers are registered as a Windows service, you can check in the Windows Control Panel (Administrative Tools &gt; Services). To change the services, you must run as Administrator.</p>
<h5>To unregister and re-register the Windows service</h5>
<ol>
  <li>Open a command prompt in Administrator mode (If you don’t use Administrator mode, Windows prompts for Admin permission before unregistering/registering the service, but doesn’t actually start the service).</li>
  <li>Unregister the existing Windows Service from the previous installation. For the specific command, see Command to unregister and re-register the Windows service below.</li>
  <li>Register the new version as a Windows service. For the specific command, see Command to unregister and re-register the Windows service below.
<p>If you’re running in Administrator mode, Windows registers the service and also starts it.</p></li>
  <li>Repeat steps 2 and 3 for each additional container that’s registered as a Windows service.</li>
</ol>
<h5>Command to unregister and re-register the Windows service</h5>
<p>The exact command/filename for unregistering/registering the Windows service might be different depending on the version of the product that you’re upgrading to.</p>
<p>Versions<span class="apidoc_red"> up to 8.1.6 or 8.2.1</span></p>
<p>For upgrade of versions up to 8.1.6 or 8.2.1, use the older commands:</p>
<ul>
  <li>To unregister the Windows service:
<pre>.\sm70\bin\unregisterContainerService.bat {instance_name}</pre></li>
  <li>To register the Windows service:
<pre>.\{AP84_foldername}\bin\registerContainerService.bat {instance_name}</pre></li>
</ul>
<p>Versions <span class="apidoc_red">8.1.7 and later or 8.2.2 and later</span></p>
<p>For upgrade of versions 8.1.7 and later or 8.2.2 and later, use the new commands:</p>
<ul>
  <li>To unregister the Windows service:
<pre>.\sm70\bin\unregisterContainerServiceYAJWS.bat {instance_name}</pre></li>
  <li>To register the Windows service:
<pre>.\{AP84_foldername}\bin\registerContainerServiceYAJWS.bat {instance_name}</pre></li>
</ul>
<p><a href="#top">back to top</a></p>



<a name="02_09"></a><h4>Step 2-9: Start the containers</h4>
<p><strong>Note</strong>: If you registered your containers as Windows services, in the previous step, the containers should already be running.</p>
There are several ways you can start a container: Windows, as Windows service, or Unix. Follow the applicable procedure below.
<h5>To start the container (Windows)</h5>
<ol>
  <li>Navigate to the \bin folder.</li>
  <li>Type the following:
<pre>startup {instance_name}</pre></li>
</ol>
<h5>To start the container (as Windows service)</h5>
<ol>
  <li>Launch the Program Group (Settings &gt; Control Panel &gt; Administrative Tools &gt; Services).</li>
  <li>Select the Akana Container Instance (the instance name is displayed as the Container Key).</li>
  <li>From the Actions menu, select Start.</li>
</ol>
<h5>To start the container (Unix)</h5>
<ol>
  <li>Navigate to the /bin folder.</li>
  <li>Type the following:
<pre>startup.sh {instance_name}</pre></li>
</ol>
<h5>To start the container (Unix, Background)</h5>
<ol>
  <li>Navigate to the /bin folder.</li>
  <li>Type the following:
<pre>startup.sh {instance_name} -bg</pre></li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_10"></a><h4>Step 2-10: Clear browser cache</h4>
<p>Before launching the Akana Administration Console, clear the browser cache and then refresh the page, or start a new session in a browser private window. This ensures that you see the user interface changes included in the Policy Manager updates.</p>
<p>This completes the product installation. The next steps walk you through additional updates you’ll need to make to complete the process, including updating database schemas and data.</p>
<p><a href="#top">back to top</a></p>



<a name="02_11"></a><h4>Step 2-11: Launch the Akana Administration Console</h4>
<p>Now it’s time to launch the Administration Console and complete the installation tasks.</p>
<p><strong>Note</strong>: The rest of the installation tasks are completed on containers running PM/CM only. There is no need to run them on Network Director containers.</p>
<h5>To launch the Akana Administration Console</h5>
<ol>
  <li>Launch the Akana Administration Console for the updated container instance:
<pre>http://{hostname}:{port}/admin</pre></li>
  <li>Log in to the Akana Administration Console as an Administrator. The Akana Administration Console launches and displays the <strong>Available Features</strong> tab, as shown below.
<p><img src="images/01_10_Available_Features_Tab.jpg" alt="Available Features tab" /></p></li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_12"></a><h4>Step 2-12: Refresh repository</h4>
<p>Verify that the repository is there. Refresh if needed.</p>
<h5>To verify/refresh the repository</h5>
<ol>
  <li>Click the <strong>Repository</strong> tab and verify that the Akana API Platform Repository 8.4.0 and Akana Platform Repository 8.4.0 are both present. An example is shown below.
<p><img src="images/01_11_repository.jpg" alt="Repository tab" /></p></li>
  <li>Conditional: if you don’t see both these repositories, click <strong>Refresh</strong> to update.</li>
</ol>
<p>Further installation steps are conditional:</p>
<ul>
  <li>If your container doesn’t have Policy Manager features installed (Akana Policy Manager Console and Akana Policy Manager Services), the upgrade is complete. </li>
  <li>If your container does have Policy Manager features installed (Akana Policy Manager Console and Akana Policy Manager Services), continue.</li>
</ul>
<p><a href="#top">back to top</a></p>



<a name="02_13"></a><h4>Step 2-13: Verify that features were updated correctly</h4>
<p>At this point, check that all the features installed in your implementation have been correctly upgraded to the new version you’re installing.</p>
<p>If there are any issues, check that you followed all steps correctly.</p>
<p>If needed, contact Technical Support.</p>
<p><a href="#top">back to top</a></p>



<a name="02_14"></a><h4>Step 2-14: Run pending installation tasks and restart container</h4>
<p>Once you've installed and configured the Policy Manager features (Akana Policy Manager Console and Akana Policy Manager Services) on your container, the next step is to run any pending installation tasks.</p>
<p>Pending Installation tasks should include at least the below:</p>
<ul>
  <li>Manage Schemas: Updates the database schemas for the new version. This task needs to be done only once.</li>
  <li>Provisioning: Initializes resources associated with the feature set you’re installing. This task needs to be done on each container.</li>
</ul>
<h5>To run pending installation tasks</h5>
<p><strong>Note</strong>: Pending installation tasks might vary according to your upgrade process. When you click <strong>Complete Configuration</strong>, the upgrade process leads you through any tasks that are needed.</p>
<ol>
  <li>In the Akana Administration Console, go to Installed Features &gt; Pending Installation Tasks. At the bottom left, click <strong>Complete Configuration</strong>, as shown below.
<p><img src="images/01_12_01_admin_console_installedfeatures.jpg" alt="Click Complete Configuration" /></p></li>
  <li>The Manage Schemas Wizard starts. In the Available Schemas section, add the schemas listed. It should look something like the below. There might be variations depending on the features you’re using. Click <strong>Finish</strong>.
<p><img src="images/01_12_02_available_schemas.jpg" alt=" Available Schemas section" /></p></li>
  <li>The schemas are installed. At the summary page, click <strong>Next Task</strong>.</li>
  <li>Conditional: Depending on the container scenario, the Provisioning wizard might start, as shown below. Make sure Perform Provisioning is checked, and then click <strong>Finish</strong>. The provisioning task runs, and the Provisioning Summary displays.
<p><img src="images/01_12_03_provisioning.jpg" alt="Provisioning Summary" /></p></li>
  <li>Restart the container.
<strong>Note</strong>: If the container doesn’t restart automatically, restart it manually.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_15"></a><h4>Step 2-15: Upgrade all containers before installing the upgrade tool</h4>
Before you install the Akana Upgrade Tool 8.4 (next step), make sure:
<ul>
  <li>All containers are upgraded.</li>
  <li>Pending installation tasks are complete for all containers.</li>
</ul>
<p>Essentially, make sure all steps, from <a href="#02_05">Step 2-5: Clear Configurator cache (if needed)</a> through to <a href="#02_14">Step 2-14: Run pending installation tasks and restart container</a>, are complete for every container.</p>
<p><a href="#top">back to top</a></p>



<a name="02_16"></a><h4>Step 2-16: Install <span class="apidoc_red">Akana PM 8.4 upgrade tool</span> to upgrade database</h4>
<p><strong>Note</strong>: Perform this step only once, on one container that has database connectivity and has Policy Manager Service installed.</p>
<p>After the container has successfully restarted, the next step is to install the 8.4 upgrade tool. This upgrades the database to the new version. Follow the steps below.</p>
<h5>To install the upgrade tool</h5>
<ol>
  <li>Launch the Akana Administration Console for AP84 using Administrator credentials.</li>
  <li>Click the <strong>Available Features</strong> tab.</li>
  <li>From the <strong>Filter</strong> drop-down, select <strong>Tool</strong>.</li>
  <li>Select Akana PM 8.4 Upgrade and click <strong>Install Feature</strong>, as shown below. The upgrade tool is installed.
<p><img src="images/01_14_upgrade_tool_82.jpg" alt="The upgrade tool" /></p></li>
  <li>Click <strong>Configure</strong>. The 8.2 to 8.4 upgrade wizard appears, as shown below.
    <p><img src="images/01_15_80_82_upgrade_tool.jpg" alt="Upgrade wizard" /></p></li>
  <li>To complete the configuration, click <strong>Finish</strong>.</li>
  <li>At the prompt, restart the container.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_17"></a><h4>Step 2-17: After installing upgrade tool, complete configuration</h4>
Once you’ve installed and run the upgrade tool, there are three more tasks to run to complete the configuration:
<ol>
  <li>An additional pending configuration task: Upgrade Database Objects to the 8.4 Model. See To upgrade database objects to 8.4 below.</li>
  <li>Run the provisioning task again, once for each Policy Manager container. See To run provisioning on all containers below.</li>
  <li>Restart all containers. See To restart all containers below.</li>
</ol>
<h5>To upgrade database objects to 8.4</h5>
<ol>
  <li>Run the pending configuration task (once per installation):</li>
  <li>In the Akana Administration Console, go to the <strong>Configuration</strong> tab.</li>
  <li>At the bottom left, click <strong>Upgrade Database Objects to 8.4 model</strong>.</li>
  <li>Follow the steps of the wizard.</li>
  <li>Then, run the provisioning task again, once for each Policy Manager container.</li>
  <li>Restart all containers.</li>
</ol>
<h5>To run provisioning on all containers</h5>
<ol>
  <li>In the Akana Administration Console for the first Policy Manager container, click the <strong>Configuration</strong> tab.</li>
  <li>At the bottom left, under Configuration Actions, click <strong>Provisioning</strong>.</li>
  <li>Make sure the checkbox is checked, and then click <strong>Finish</strong>.</li>
  <li>Repeat steps 1–3 for each Policy Manager container.</li>
</ol>
<h5>To restart all containers</h5>
<p>Shut down all the containers.</p>
<p>Restart the containers. The recommended sequence is to start PM first, then CM, then ND.</p>
<p><a href="#top">back to top</a></p>



<a name="02_18"></a><h4>Step 2-18: Turn scheduled jobs back on</h4>
<p>Now it’s time to turn back on the properties that you turned off in Step 2-1.</p>
<p><strong>Note</strong>: Perform this step for all the AP82 containers with Policy Manager features installed, which have now been upgraded to AP84. Before performing this step, make sure the container was restarted.</p>
<h5>To turn scheduled jobs back on</h5>
<ol>
  <li>Log in to the Akana Administration Console using Administrator credentials.</li>
  <li>Click the <strong>Configuration</strong> tab.</li>
  <li>Turn on com.soa.scheduler.quartz:
<ol>
  <li>In the Configuration Categories section, find com.soa.scheduler.quartz. </li>
  <li>Locate the org.quartz.scheduler.enabled property and change it to true.</li>
  <li>Click <strong>Apply Changes</strong>.</li>
</ol></li>
  <li>Turn on com.soa.scheduler:
<ol>
  <li>In the Configuration Categories section, find com.soa.scheduler. </li>
  <li>Locate the simple.scheduler.enabled property and change it to true.</li>
  <li>Click <strong>Apply Changes</strong>.</li>
</ol></li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="02_19"></a><h4>Step 2-19: Update container metadata and authentication options</h4>
<p>The final step in the upgrade process is to update the Metadata URL and Authentication Options of each container you upgraded, in Policy Manager. This updates the container capabilities to support the latest features.</p>
<h5>To update container metadata and authentication options</h5>
<ol>
  <li>Log in to the Policy Manager Management Console as the Administrator.</li>
  <li>In the left pane, from the Containers folder, select the AP84 container.</li>
  <li>In the right pane, from the Actions Portlet, select Update Container Metadata, as shown below.
<p><img src="images/01_16_01_update_container_metadata.jpg" alt="Update Container Metadata" /></p></li>
  <li>Enter the metadata URL for the container being updated (http://{pm_host}:{pm_port}/metadata or http://{nd_host}:{nd_port}/metadata), or the metadata path for the Network Director. An example is shown below.
<p><img src="images/01_16_02_metadata_import.jpg" alt="Metadata path for the ND" /></p></li>
  <li>Conditional: If Authentication options are being used or updated, select the authentication options.</li>
  <li>If the metadata URL is not accessible from Policy Manager, you can update the metadata from a file:
<ol>
  <li>First, access the metadata URL from a machine that has access to the container and save the metadata document to a file.</li>
  <li>Then, upload the file to Policy Manager.</li>
</ol></li>
</ol>
<p>That completes the upgrade.</p>
<p>After upgrading, run the post-install tasks on one of the containers with the Akana API Platform feature installed, as covered in the next group of tasks.</p>
<p><a href="#top">back to top</a></p>




<div class = "divider1"></div>
<a name="h_post_upgrade_tasks_old"></a><h3>Post-Upgrade Tasks (<span class="apidoc_red">OLD: CARRIED OVER FROM 8.0 TO 8.2 DOC: VERIFY/DELETE</span>)</h3>




<a name="03_00_old"></a><h3>Overview: Completing the API Platform Post-Upgrade Tasks</h3>
<p>Once you’ve completed the product version update, there are additional post-upgrade tasks you’ll need to complete if you’re running the Akana API Platform developer portal. Run these tasks on one of the containers with the Akana API Platform feature installed. Some of these steps are conditional depending on platform features you’re using. They include:</p>
<ul>
  <li><a href="#03_01_old">Step 3-1: Upgrade CM Models</a></li>
  <li><a href="#03_02_old">Step 3-2: Update CM API</a></li>
  <li><a href="#03_03_old">Step 3-3: (Conditional): Update OAuth API</a></li>
  <li><a href="#03_04_old">Step 3-4: (Conditional): Rebuild CM Styles</a></li>
</ul>
<p><a href="#top">back to top</a></p>



<a name="03_01_old"></a><h4>Step 3-1: Upgrade CM Models</h4>
<p>After upgrading, run the Upgrade CM Models post-upgrade task on one of the containers with the Akana API Platform feature installed:</p>
<ol>
  <li>In the Akana Administration Console, on the <strong>Configuration</strong> tab, under <strong>Configuration Actions</strong>, choose <strong>Upgrade CM Models</strong>.</li>
  <li>When done, click <strong>Close</strong>.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="03_02_old"></a><h4>Step 3-2: Update CM API</h4>
<p>Run the Update CM API task on one of the containers with the Akana API Platform feature installed. This task updates APIs that were already provisioned.</p>
<ol>
  <li>In the Akana Administration Console, on the <strong>Configuration</strong> tab, under <strong>Configuration Actions</strong>, choose <strong>Update CM API</strong>.</li>
  <li>When done, click <strong>Close</strong>.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="03_03_old"></a><h4>Step 3-3: (Conditional): Update OAuth API</h4>
Conditional, if the OAuth Provider feature is installed: run the Update OAuth API upgrade task. This task updates any changes to two key API services needed for OAuth:
<ul>
  <li>AuthorizationServerAgentAPI: Used when the OAuth Provider Agent feature is deployed in a container without database access.</li>
  <li>ResourceServerAPI: Used by the API Gateway to validate OAuth access tokens when processing API requests.</li>
</ul>
<h5>To update OAuth API</h5>
<ol>
  <li>In the Akana Administration Console, on the <strong>Configuration</strong> tab, under <strong>Configuration Actions</strong>, choose <strong>Update OAuth API</strong>.</li>
  <li>When done, click <strong>Close</strong>.</li>
</ol>
<p><a href="#top">back to top</a></p>



<a name="03_04_old"></a><h4>Step 3-4: (Conditional): Rebuild CM Styles</h4>
<p>As part of every upgrade, if you are using the developer portal, you’ll need to run the <strong>Rebuild CM Styles</strong> post-install task. This makes sure that you have the latest style updates, for all themes and tenants.</p>
<h5>To rebuild CM styles</h5>
<ol>
  <li>In the Akana Administration Console, on the <strong>Configuration</strong> tab, under <strong>Configuration Actions</strong>, choose <strong>Rebuild CM Styles</strong>.</li>
  <li>When done, click <strong>Close</strong>.</li>
</ol>
<p><a href="#top">back to top</a></p>




<div class = "divider1"></div>
<a name="h_post_upgrade_tasks"></a><h3>Post-Upgrade Tasks</h3>



<a name="03_00"></a><h4>Upgrade tasks when upgrading to 8.4: Overview</h4>
<p>Once you’ve completed the product version update, there are additional post-upgrade tasks you’ll need to complete. Run these tasks on one of the containers with the Akana API Platform feature installed. Some of these steps are conditional depending on platform features you’re using. They include:</p>
<ul>
  <li><a href="#03_01">Step 3-1: Run upgrade tool: "Akana 8.2 to 8.4 model upgrade"</a></li>
  <li><a href="#03_02">Step 3-2: Post-Upgrade Task for upgrades to 8.4: Provisioning and Upgrade CM Models tasks</a></li>
  <li><a href="#03_03">Step 3-3: Upgrade task when upgrading to 8.4: delete and install object mappings</a></li>
  <li><a href="#03_04">Step 3-4: Post-Upgrade Task for upgrades to 8.4: MongoDB Updates</a></li>
  <li><a href="#03_05">Step 3-5: Post-Upgrade Task for upgrades to 8.4: Rebuild CM Styles</a></li>
</ul>
<p><a href="#top">back to top</a></p>



<a name="03_01"></a><h4>Step 3-1: Run upgrade tool: "Akana 8.2 to 8.4 model upgrade"</h4>
<p>The next step is to run the 8.2 to 8.4 upgrade tool, to update Policy Manager database objects from version 8.2 to 8.4.</p>
<p>Before running this tool, change the <strong>failure.data.capture.enabled</strong> setting in the configuration file. Changing this setting will save memory for logging events during the upgrade process. It’s important to change this setting; if you don’t, there might be memory issues during upgrade. If you want to, you can change the setting back afterwards. When set to true, this setting indents entries in the log file.</p>
<p>Follow these two steps:</p>
<ol>
  <li>To change the <strong>failure.data.capture.enabled</strong> configuration setting (below)</li>
  <li>To install the 8.2 to 8.4 upgrade tool (below)</li>
</ol>
<p><strong>Note</strong>: Perform these steps only once, on one container that has database connectivity and has Policy Manager Service installed.</p>
<h5>To change the failure.data.capture.enabled configuration setting</h5>
<ol>
  <li>Log in to the Akana Administration Console for your upgraded installation, using Administrator credentials.</li>
  <li>Click the <strong>Configuration</strong> tab.</li>
  <li>Turn off <strong>failure.data.capture.enabled</strong>:
<ol>
  <li>On the left, under <strong>Configuration Categories</strong>, find the <strong>com.soa.framework</strong> category.</li>
  <li>Locate the <strong>failure.data.capture.enabled</strong> property and change it to false.</li>
  <li>Click <strong>Apply Changes</strong>.</li>
</ol></li>
</ol>
<h5>To install the 8.2 to 8.4 upgrade tool</h5>
<ol>
  <li>Launch the Akana Administration Console for your upgraded installation, using Administrator credentials.</li>
  <li>Click the <strong>Available Features</strong> tab.</li>
  <li>From the <strong>Filter</strong> drop-down, select <strong>Tool</strong>.</li>
  <li>Select <strong>Akana 8.2 to 8.4 model upgrade</strong>, as shown below, and click <strong>Install Feature</strong>. The upgrade tool is installed.
  <p>uptohere UpgradeTool.png</p></li>
</ol>
<p>Now, continue with the standard upgrade process in the upgrade documentation; see http://docs.akana.com/sp/upgrade/upgrading_akana_api_platform_82_84.htm (Akana docs site).</p>
<p><a href="#top">back to top</a></p>



<a name="03_02"></a><h4>Step 3-2: Post-Upgrade Task for upgrades to 8.4: Provisioning and Upgrade CM Models tasks</h4>
<p>If you’re upgrading from any previous version to version 8.4, you’ll need to complete the <strong>Provisioning</strong> and <strong>Upgrade CM Model</strong>s tasks as part of the upgrade process.</p>
<p>Make sure the below steps are included in your upgrade process:</p>
<ol>
  <li>In the Akana Administration Console, click the <strong>Configuration</strong> tab.</li>
  <li>In the <strong>Configuration Actions</strong> section, choose the <strong>Provisioning</strong> configuration action. You’ll be prompted for any input needed to complete the provisioning step.</li>
  <li>Repeat as needed for additional containers.</li>
  <li>Stop and restart all containers.</li>
  <li>Complete the <strong>Upgrade CM Models</strong> post-upgrade task:
<ol>
  <li>In the Akana Administration Console, on the <strong>Configuration</strong> tab, under <strong>Configuration Actions</strong>, choose <strong>Upgrade CM Models</strong>.</li>
  <li>When done, click <strong>Close</strong>.</li>
</ol></li></ol>
<p><a href="#top">back to top</a></p>



<a name="03_03"></a><h4>Step 3-3: Upgrade task when upgrading to 8.4: delete and install object mappings</h4>
<p>Because of specific changes in the Elasticsearch mappings in version 8.3 and 8.4, as part of the upgrade process you’ll need to delete the object mappings, and then add the updated mappings. This is because an additional object, Organizations, was added.</p>
<p>You’ll need to delete the existing Elasticsearch app and API mappings and then update app, API, and business organization mappings from the installation bundle.</p>
<p>There are two steps to this:</p>
<ol>
  <li>Delete mappings using the API: see To delete mappings using the API below.</li>
  <li>Run a database script: see To reindex objects using a database script below.</li>
</ol>
<h5>To delete mappings using the API</h5>
<ol>
  <li>Run the operation below to delete the existing API mappings:
<pre>Accept: text/plain
DELETE
{protocol}:{hostname}/api/index/default/api/mapping</pre>
<p>For example: http://open:9900/api/index/default/api/mapping</p></li>
  <li>Run the operation below to delete the existing app mappings:
<pre>DELETE
{protocol}:{hostname}/api/index/default/app/mapping</pre></li>
  <li>Run the operation below to update the API mappings from the new files in the installation bundle:
<pre>Content-Type: application/x-www-form-urlencoded
PUT
http://open:9900/api/index/default/api/mapping</pre></li>
  <li>Run the operation below to update the app mappings from the new files in the installation bundle:
<pre>Content-Type: application/x-www-form-urlencoded
PUT
http://open:9900/api/index/default/app/mapping</pre></li>
  <li>Run the operation below to update the business organization mappings from the installation bundle:
<pre>Content-Type: application/x-www-form-urlencoded
PUT
http://open:9900/api/index/default/business/mapping</pre></li>
</ol>
<h5>To reindex objects using a database script</h5>
<p>When you’ve completed the above steps, you’ll need to reindex the API, app, and business objects by running this database command:</p>
<pre>delete from INDEX_STATUS where OBJECTTYPE in ('api', 'app', ‘business’);</pre>
<p>Now, complete the next step, Run upgrade tool: "Akana 8.2 to 8.4 model upgrade" below, before resuming the standard upgrade procedure.</p>
<p><a href="#top">back to top</a></p>



<a name="03_04"></a><h4>Step 3-4: Post-Upgrade Task for upgrades to 8.4: MongoDB Updates</h4>
<p>Version 8.4 includes some changes to the MongoDB database schema. To implement these updates, the upgrade process includes a new configuration action, <strong>Install Configuration Data and Indexes in MongoDB</strong>. Make sure you complete this configuration action along with all others when upgrading.</p>
<p>The upgrade wizard steps you through the configuration action; if you don’t complete the installation in one session, be sure to go back and make sure all configuration actions are complete. In the Akana Administration Console, Configuration tab, at the bottom left, the <strong>Configuration Actions</strong> section should be empty when the upgrade process is complete.</p>
<p><a href="#top">back to top</a></p>



<a name="03_05"></a><h4>Step 3-5: Post-Upgrade Task for upgrades to 8.4: Rebuild CM Styles</h4>
<p>As part of every upgrade, if you are using the developer portal, you’ll need to run the <strong>Rebuild CM Styles</strong> post-install task. Make sure you complete this step for your 8.4 upgrade. This makes sure that you have the latest style updates, for all themes and tenants.</p>
<h5>To rebuild CM styles</h5>
<ol>
  <li>In the Akana Administration Console, on the <strong>Configuration</strong> tab, under <strong>Configuration Actions</strong>, choose <strong>Rebuild CM Styles</strong>.</li>
  <li>When done, click <strong>Close</strong>.</li>
</ol>
<p><a href="#top">back to top</a></p>



<div class = "divider1"></div>



<h3 id="related_topics">Related Topics</h3>
<table width="700" border="0" cellspacing="0" cellpadding="2" class="doctable">
  <tr>
    <td width="300" valign="top"><p><strong>Version 8.2:</strong></p>
      <ul>
        <li><a href="../platform_install/install_cm_jython_script.htm">Installation Jython Script</a></li>
        <li><a href="../platform_install/implementation_planning.htm">Planning Your Implementation</a></li>
      </ul>
    </td>
    <td width="400" valign="top"><p><strong>Version 8.0:</strong></p>
      <ul>
        <li><a href="../platform_install/installing_akana_platform.htm">Installing Akana Platform 8.x</a></li>
        <li><a href="../platform_install/installing_policy_manager_v80.htm">Installing Policy Manager 8.x</a></li>
      </ul>
    </td>
  </tr>
</table>