---
layout: page
title: Upgrading Akana API Platform to Version 2019.x.x
description: Provides instructions for upgrading the Akana API Platform from an earlier version to version 2019.x.x.
product: sp
category: ref
sub-nav-class: Upgrade - Akana API Platform
weight: 3
type: page
nav-title: Upgrade to 2019.x.x
---
<h2 id="top">Upgrading Akana API Platform to Version 2019.x.x</h2>
<p>Learn how to upgrade the Akana API Platform from an earlier version to version 2019.x.x.</p>
<p>These upgrade instructions cover the process for a manual upgrade, creating new containers. Automation options are also available (Linux-only for container creation, Windows and Linux for all other automation tasks).</p>
<p>This upgrade addresses a simple container scenario of:</p>
<ul>
	<li>One container with Policy Manager and Community Manager installed</li>
	<li>One container running the API Gateway (Network Director)</li>
</ul>
<p>The documentation includes some notes and additional information that would be applicable if you're creating other container scenarios&#8212;for example, if you have multiple PM/CM containers, or a separate Scheduled Jobs container&#8212;but the main path is to create these two containers.</p>
<p><strong>Note</strong>: If you're upgrading Policy Manager for DataPower, follow the steps in this document that you would use for upgrading Network Director.</p>
<p>This document covers instructions for any scenario where you are upgrading from any earlier version to 2019.x.x:</p>
<ul>
	<li>Upgrading from any earlier major/minor version to 2019.x.x.</li>
	<li>Upgrading from any 2019.x.x version to a later 2019.x.x version (minor-version upgrade). For additional notes, see <a href="upgrading_micro.htm">Minor-Version Update Notes</a>.</li>
</ul>
<p>You can also use automation to standardize the upgrade process. Automation might take a little more time to set up, but it has great benefits including standardization and reusability. For information on automation, see <a href="../automation/automation_ref.htm">Automation Reference</a>. For information about which automation recipes to use for upgrade, see <a href="#upgrade_automation">Automating the upgrade</a>.</p>
<p>Previous versions of this document recommended an incremental approach, upgrading from one major version to the next and then to the next. Incremental upgrade is not necessary. You can upgrade from an earlier version to the latest version in one upgrade process. This documentation takes you through the steps to create new containers and then transfer existing settings, including container key, certificate, and configuration settings, to the new container.</p>

<p>
<a href="../admin_console/using_admin_console.htm" class="button secondary">Using Admin Console</a>
<a href="../admin_console/installing_tools.htm" class="button secondary">Installing Tools</a>
<a href="../admin_console/installing_plugins.htm" class="button secondary">Installing Plug-ins</a> 
<a href="../admin_console/config_actions.htm" class="button secondary">Configuration Actions</a> 
<a href="../automation/automation_ref.htm" class="button secondary">Automation Reference</a>
</p>

<h5 class="stamp">Supported Platforms: 2019.x.x</h5>
<div class = "divider1"></div>
<h3 style="color: gray;">Table of Contents</h3>



<h5 style="color: gray;"><a href="#h_upgrade_planning">Planning the Upgrade</a></h5>
<ol class="table_of_contents">
	<li><a href="#s01_strategy">Upgrade strategy</a></li>
	<li><a href="#s01_00_overview">Overview</a></li>
	<li><a href="#s01_01_review_rn">Step 1-1: Review release notes</a></li>
	<li><a href="#s01_02_plan">Step 1-2: Plan the upgrade</a></li>
	<li><a href="#s01_03_es_install_config">Step 1-3: Install and configure Elasticsearch (if not already done)</a></li>
</ol>



<h5 style="color: gray;"><a href="#h_upgrade_performing">Performing the Upgrade</a></h5>
<ol class="table_of_contents">
	<li><a href="#s02_01_shutdown">Step 2-1: Shut down and back up the previous version</a></li>
	<li><a href="#s02_02_download">Step 2-2: Download and extract ZIP files</a></li>
	<li><a href="#s02_03_save_props">Step 2-3: Save properties from old container</a></li>
	<li><a href="#s02_04_es_verify">Step 2-4: Verify that Elasticsearch is running</a></li>
	<li><a href="#s02_05_container_01">Step 2-5: Create and configure the first container</a></li>
	<li><a href="#s02_06_container_others">Step 2-6: Create and configure additional containers</a></li>
</ol>



<h5 style="color: gray;"><a href="#h_post_upgrade_tasks">Additional Tasks</a></h5>
<ol class="table_of_contents">

	<li><a href="#perform_config_actions">Perform configuration actions</a></li>
	<li><a href="#check_system_health">Check system health</a></li>
	<li><a href="#es_config">Configure Elasticsearch</a></li>
	<li><a href="#restart_all">Restart all containers</a></li>
</ol>



<h5 style="color: gray;"><a href="#h_upgrade_tasks_reference">Upgrade Procedures/Reference:</a></h5>
<ol class="table_of_contents">
	<li><a href="#launch_console">Launching the Akana Administration Console</a></li>
	<li><a href="#running_upgrade_tools">Installing and running upgrade tools</a></li>
	<li><a href="#post_upgrade_tasks_running">Running post-upgrade tasks</a>
		<ul>
			<li><a href="#post_upgrade_01">Manage PKI Keys</a></li>
			<li><a href="#post_upgrade_02">Configure Database Options</a></li>
			<li><a href="#post_upgrade_03">Manage Schemas</a></li>
			<li><a href="#post_upgrade_04">Create Policy Manager Admin User</a></li>
			<li><a href="#post_upgrade_05">Provisioning</a></li>
		</ul>
	</li>
	<li><a href="#check_features_installed">Checking that features were installed correctly</a></li>
	<li><a href="#find_container_key">Saving the container key</a></li>
	<li><a href="#sched_jobs_off">Turning the scheduled jobs off</a></li>
	<li><a href="#sched_jobs_on">Turning the scheduled jobs back on</a></li>
	<li><a href="#unreg-rereg_win">Unregistering and re-registering the Windows service</a></li>
	<li><a href="#s02_09">Starting a container</a></li>
	<li><a href="#auto_prop_xfer">Automating the transfer of container properties</a></li>
	<li><a href="#upgrade_automation">Automation recipes for upgrade</a></li>
	<li><a href="#tech_support_contact">Contacting Technical Support</a></li>
</ol>
<div class = "divider1"></div>
<h3 id="h_upgrade_planning">Planning the Upgrade</h3>




<h3 id="s01_strategy">Upgrade strategy</h3>
<p>There are several approaches you can take to upgrading:</p>
<ol>
	<li>Automated upgrade, using automation recipes to help make your upgrade faster, more standardized, and more error-free. For information on automation, see <a href="../automation/automation_ref.htm">Automation Reference</a>. For information about which automation recipes to use for upgrade, see <a href="#upgrade_automation">Automating the upgrade</a>.</li>
	<li>Manual upgrade, creating a new container and then using it to replicate an old one. This documentation steps through that approach.
<p><strong>Note</strong>: We highly recommend that you use automation to transfer the container properties.</p></li>
	<li>Manual upgrade, creating new containers, and then configuring the new containers to suit your requirements. This is essentially a fresh install.</li>
</ol>
<p>This documentation takes you through the steps to create new containers and then transfer existing settings, including container key, certificate, and configuration settings, to the new container (#3 above). For example, as part of <a href="#s02_05_container_01">Step 2-5: Create and configure the first container</a> you'll upload the same certificate that you used for the old container, from your secure external storage location to the new container. </p>
<p>Some of the steps are the same for all approaches.</p>
<p><a href="#top">back to top</a></p>



<h3 id="s01_00_overview">Overview</h3>
<p>These instructions address the scenario of creating new containers for your 2019.x.x installation.</p>
<p>There are some steps you might need to take before starting the upgrade process, and some information you'll need to consider that might affect how you proceed, including:</p>
<ul>
	<li><a href="#s01_01_review_rn">Step 1-1: Review release notes</a></li>
	<li><a href="#s01_02_plan">Step 1-2: Plan the upgrade</a></li>
	<li><a href="#s01_03_es_install_config">Step 1-3: Install and configure Elasticsearch (if not already done)</a></li>
	<li>Check if there are any constraints or requirements associated with the type of database you're using, such as permissions required. For details, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#database_notes">Database Notes</a> (installation doc).</li>
</ul>
<p><a href="#top">back to top</a></p>



<h3 id="s01_01_review_rn">Step 1-1: Review release notes</h3>
<p>Review the release notes so that you are aware of changes to the platform. Check for upgrade notes.</p>
<p>Release notes are available on the Rogue Wave documentation site:</p>
<ul>
	<li><a href="https://docs.roguewave.com/en/akana/release_notes/2019.1/AAP_20191_Release_Notes.html" title="Link to Rogue Wave docs site" target="_blank">2019.1.x release notes</a></li>
	<li><a href="https://docs.roguewave.com/en/akana/release_notes/2019/AAP_2019_Release_Notes.html" title="Link to Rogue Wave docs site" target="_blank">2019.0.x release notes</a></li>
</ul>
<p><a href="#top">back to top</a></p>



<h3 id="s01_02_plan">Step 1-2: Plan the upgrade</h3>
<p>Before you start downloading and installing, plan your upgrade. You'll need to gather information about the old container so that you can correctly set up and configure the new container. Do the following:</p>
<ol>
	<li>In your existing installation, in the Akana Administration Console for each container, note the features and add-ons that are installed in each container, so that you can replicate this in the new containers.	When you're following the steps of the procedures below, install the features for your own containers.</li>
	
	<li>In the Akana Administration Console for each container, take all steps needed to save out container settings so that you can reproduce the configuration on the new container, where applicable. You'll need this information when you're setting up the new container. Save all other container properties that you've customized.
	<p><strong>Note</strong>: you can use an automation task to save out the configuration settings.</p></li>
	<li>Make a note of the container key value. This is needed for replicating the existing container in your new container. You can get the container key from the Akana Administration Console for the container. For instructions, see <a href="#find_container_key">Finding the container key</a>. When you're setting up the new container, you'll use this key (<a href="#s02_05_container_01">Step 2-5: Create and configure the first container</a> below).</li>
		<li>Make sure you have the certificate that you used to create the original container. You can then upload the certificate when configuring the new container.</li>
	<li>Conditional: If standalone Elasticsearch is new for your implementation, determine where you'll install Elasticsearch, needed for the search feature. For full information on Elasticsearch, see <a href="../platform_install/install_es_config.htm">Installing and Configuring Elasticsearch</a>.</li>
</ol>
<p><a href="#top">back to top</a></p>



<h3 id="s01_03_es_install_config">Step 1-3: Install and configure Elasticsearch (if not already done)</h3>
<p>Versions 2018.0.0 and later require standalone Elasticsearch.</p>
<p>For instructions, see <a href="../platform_install/install_es_config.htm">Installing and Configuring Elasticsearch</a>.</p>
<p><a href="#top">back to top</a></p>



<div class = "divider1"></div>
<h3 id="h_upgrade_performing">Performing the Upgrade</h3>



<h3 id="s02_01_shutdown">Step 2-1: Shut down and back up the previous version</h3>
<ol>
	<li>Shut down all containers in your installation. See <a href="../platform_install/installing_akana_api_platform_v2019.htm#stopping_container">Stopping a container</a> (installation doc).</li>
	<li>Copy the entire installation folder structure to a secure backup location.</li>
	<li>Back up your database.</li>
</ol>
<p><a href="#top">Back to top</a></p>



<h3 id="s02_02_download">Step 2-2: Download and extract ZIP files</h3>
<p><strong>Download:</strong></p>
<p>The first step is to download the required ZIP files. You'll need to:</p>
<ul>
	<li>Create a folder for your 2019.x.x installation; for example, <strong>aap2019xx</strong>.</li>
	<li>Download the ZIP files for the latest version.</li>
</ul>
<p>For detailed instructions on this step, refer to the installation guide, <a href="../platform_install/installing_akana_api_platform_v2019.htm#gather_zip_files">Download ZIP files</a>.</p>
<p><strong>Note</strong>: For information about limitations and extra steps for specific databases, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#supported_databases">Supported databases</a> (installation doc). If you're using a MySQL database with API Platform and the Lifecycle Repository feature, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#notes_database_mysql_rm_all">Database notes: MySQL with Lifecycle Repository</a>.</p>
<p>If you have a specific add-on feature installed, such as the Integration Services option pack, SiteMinder Security Provider, or SAML Web SSO Security Provider feature, it's important that you also download the corresponding version of the same feature.</p>
<p><strong>Extract:</strong></p>
<p>The next step is to extract the files.</p>
<p><strong>Note</strong>: You'll need a password to unzip the files. If you don't know the password, contact your Akana representative.</p>
<h5>To unzip the installation files</h5>
<p>In your installation folder, unzip all files:</p>
<ul>
	<li>Akana Platform latest ZIP</li>
	<li>Akana API Platform latest ZIP</li>
	<li>Any add-ons</li>
</ul>
<p><a href="#top">back to top</a></p>



<h3 id="s02_03_save_props">Step 2-3: Save properties from old container</h3>
<p>You'll need to save out the information on any custom properties, from the old container, so that you can reconfigure the new container with the same properties in <a href="#s02_05_container_01">Step 2-5: Create and configure the first container</a> (or subsequent containers).</p>
<h5>To save out the properties from the old container</h5>
<ol>
	<li>Start up the old container. See <a href="../platform_install/installing_akana_api_platform_v2019.htm#starting_container">Starting a container</a> (installation doc).</li>
	<li>With the old container running, extract the information on custom property settings from the old container. If you're using the automated process to extract the properties, see <a href="#auto_prop_xfer">Automating the transfer of container properties</a>.</li>
	<li>When you have the configuration information, shut down the old container. See <a href="../platform_install/installing_akana_api_platform_v2019.htm#stopping_container">Stopping a container</a> (installation doc).</li>
</ol>
<p><a href="#top">Back to top</a></p>



<h3 id="s02_04_es_verify">Step 2-4: Verify that Elasticsearch is running</h3>
<p>Elasticsearch is a separate installation. Make sure it's installed successfully and is running.</p>
<p>For example, run this command:</p>
<pre>
ps -ef
</pre>
<p>If there is response content, Elasticsearch is running. For example:</p>
<pre>/usr/share/elasticsearch/modules/x-pack/x-pack-ml/platform/linux-x86_64/bin/controller</pre>
<p>See also:</p>
<ul>
	<li> Elasticsearch website: <a href="https://www.elastic.co/">https://www.elastic.co/</a>.</li>
	<li>Information about configuring Elasticsearch with the Akana API Platform: <a href="../platform_install/install_es_config.htm">Installing and Configuring Elasticsearch</a>.</li>
</ul>
<p><a href="#top">Back to top</a></p>



<h3 id="s02_05_container_01">Step 2-5: Create and configure the first container</h3>
<p>Create the first Community Manager/Policy Manager container. For features to install, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#features_cm_pm">Community Manager/Policy Manager container features with access to MongoDB</a>. Follow these three main groups of steps:</p>
<ul>
	<li><a href="#proc_container_first">To create the first container and install features and plug-ins</a></li>
	
	<li><a href="#proc_post_upgrade_tasks_01">To perform the post-upgrade tasks for the first container </a></li>
	
	<li><a href="#proc_update_container_props">To update container properties</a></li>
</ul>
<p><strong>Notes</strong>:</p>
<ul>
	<li>In creating the containers, make sure that you set up at least one container running Policy Manager before you set up the Network Director container.</li>
	<li>Depending on the version that you're upgrading from, you might have to install one or more upgrade tools, in the Akana Administration Console for the container. For more information, see <a href="#running_upgrade_tools">Installing and running upgrade tools</a>.</li>
	<li>If you're using automation to replicate the container property settings, follow the sequence of steps in <a href="#auto_prop_xfer">Automating the transfer of container properties</a> below.</li>
</ul>

<h5 id="proc_container_first">To create the first container and install features and plug-ins</h5>
<ol>
	<li>Run Configurator to create the first container, either via the GUI or using silent install. See <a href="../platform_install/installing_akana_api_platform_v2019.htm#run_configurator_pm">Step 2-3: Run Configurator to create the first container</a>.
		<p><strong>Note</strong>: Rather than letting a new container key be assigned, you'll need to use the container key from the old container, which you saved in <a href="#s01_02_plan">Step 1-2: Plan the upgrade</a> above.</p>
		<ul>
			<li>Windows install: <a href="../platform_install/installing_akana_api_platform_v2019.htm#creating_container_gui">Creating a container via the GUI</a> (second page, Container Key).</li>
			<li>Linux install: <a href="../platform_install/installing_akana_api_platform_v2019.htm#creating_container_silent">Creating a container using silent install (Linux)</a>. Add the container key value to the properties file, as shown in the example.</li>
		</ul>
	</li>
	<li>In the Akana Administration Console for the container, install Policy Manager/Community Manager. See <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_pm_cm">Step 2-4: Install Policy Manager/Community Manager features on the container</a> (installation doc).</li>
	<li>At the <strong>Installation Complete</strong> summary, do not click <strong>Configure</strong> yet. Instead, click <strong>Cancel</strong>; you'll need to install plug-ins and upgrade tools and then turn off the scheduled jobs before running the post-upgrade tasks.</li>
	<li>Install&nbsp;any plug-ins that you want to install. See <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_plugins">Step 2-5: (as needed) Install plug-ins on the container</a>.&nbsp; At the end, click <strong>Cancel</strong>.</li>
	<li>If you're upgrading from an older version such as 8.2, you'll need to install one or more upgrade tools, in the Akana Administration Console for the container. Choose all that are applicable for the earliest version you're upgrading from, up to the current version. For more information, see <a href="#running_upgrade_tools">Running upgrade tools</a>. At the end, click <strong>Cancel</strong>.
	<p><strong>Note</strong>: Upgrade tools only need to be run once per installation. You only need to install upgrade tools on the first container and run the resulting post-upgrade tasks once.</p></li>
	<li>Turn off the scheduled jobs. For instructions, see <a href="#sched_jobs_off">Turning the scheduled jobs off</a>.</li>
	<li>Go to the next procedure below.</li>
	</ol>

<h5 id="proc_post_upgrade_tasks_01">To perform the post-upgrade tasks for the first container </h5>
<ol>
	<li>In the Akana Administration Console for the container, under <strong>Installed Features</strong>, check at the bottom of the page under <strong>Pending Installation Tasks</strong>.</li>
	<li>Run any tasks that are pending. The specific list depends on the version you're upgrading from and the features you're installing. Complete all tasks. For information about specific tasks, see <a href="#post_upgrade_tasks_running">Running post-upgrade tasks</a>. Some tasks are run once per installation, some are once per container. Key tasks include:
		<ul>
			<li><strong>Setting up the certificate for the container</strong>. At the Manage PKI Keys wizard (<strong>Generate PKI Keys &amp; X.509 Certificate</strong> page), upload the container certificate from your secure external location. See <a href="#post_upgrade_01">Manage PKI Keys</a>.</li>
			<li><strong>Configuring the database</strong> (once per installation). See <a href="#post_upgrade_02">Configure Database Options</a>.
			<p><strong>Note</strong>: When you're configuring the database, choose <strong>Use Existing Database</strong> and put in the values and credentials for the database from your prior version of the Akana API Platform. Depending on the database you're using, you might need to put a database driver in place, or take some other steps. See <a href="../platform_install/installing_akana_api_platform_v2019.htm#database_notes">Database notes</a> and <a href="../platform_install/installing_akana_api_platform_v2019.htm#database_drivers">Database drivers</a> (installation doc).</p></li>
		</ul>
	</li>
	<li>When pending installation tasks are all complete, restart the container. For instructions, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#starting_container">Starting a container</a>.</li>
		<li> Turn the scheduled jobs back on. For instructions, see <a href="#sched_jobs_on">Turning the scheduled jobs back on</a>.</li>
		<li>Go to the next procedure below.</li>
</ol>

<h5 id="proc_update_container_props">To update container properties</h5>
<p>When you've created the new container and installed the features, it's time to set the configuration properties. You'll need to transfer any customized settings that were set on the old container, to the new container.</p>
<p>Use the setting values that you saved out in <a href="#s02_03_save_props">Step 2-3: Save properties from old container</a>, and set them on the new container.</p>
<p>If you used automation to extract the properties, run the extracted recipe that you created, to set the properties so they are the same as the old container. For instructions, see <a href="#auto_prop_xfer">Automating the transfer of container properties</a>.</p>
<p><a href="#top">back to top</a></p>



<h3 id="s02_06_container_others">Step 2-6: Create and configure additional containers</h3>
<p>Once you have the first container set up, it's time to create and configure additional containers. Essentially you'll follow the same set of steps as above, for these additional containers:</p>
<ol>
	<li>Optional: Subsequent Community Manager/Policy Manager containers. If you're following the sample deployment scenario, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#features_cm_pm">Community Manager/Policy Manager container features with access to MongoDB</a>.</li>
	<li>Network Director container. For features to install, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#features_nd_oauth">API Gateway/Internal Gateway (Network Director)</a>. For Network Director, pending tasks might include the pending tasks below, and/or others:
		<ol>
			<li><strong>WS-Metadata Exchange Options</strong>: see <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_tasks_nd_configure_wsmex">Installation wizard, ND container: Configure WS-Metadata Exchange Options</a>.</li>
			<li>Manage PKI Keys wizard (<strong>Select Key Management Option</strong> page): see <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_tasks_manage_pki_keys">Installation wizard: Manage PKI Keys</a>.</li>
		</ol>
		<p>For a full list of possible tasks, see <a href="../admin_console/config_actions.htm#config_actions_all">Configuration Actions: full list</a>.</p>
	</li>
	<li>OAuth container. For features to install, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#features_oauth_alone">OAuth Provider</a>.</li>
	<li>Scheduled Jobs container. For features to install, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#features_sched_jobs">Job Scheduler</a>.</li>
</ol>
<p>For each container:</p>
<ul>
	<li>Install the features, then turn off scheduled jobs, perform all post-upgrade tasks, turn scheduled jobs back on, and update the container properties, as covered in <a href="#s02_05_container_01">Step 2-5: Create and configure the first container</a> above.</li>
</ul>
<p>Create containers in this sequence:</p>
<ol>
	<li>First, create all Policy Manager/Community Manager containers.</li>
	<li>Then, create all Network Director containers.
	<p>You can create a Network Director container using either <a href="../admin_console/using_network_director_feature.htm#container_gui">GUI</a> or <a href="../admin_console/using_network_director_feature.htm#container_silent">Silent</a> options. For instructions on how to install a Network Director Container, install and configure the Network Director feature, and register a new Network Director<strong> </strong>container in Policy Manager, refer to <a href="../admin_console/using_network_director_feature.htm">Using the Network Director Feature</a>.</p></li>
</ol>
<p>For information about the features and plug-ins to install for additional container configurations, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#installation_scenarios">Sample Deployment Scenarios</a> (Install doc).</p>
<p><a href="#top">back to top</a></p>




<div class = "divider1"></div>
<h3 id="h_post_upgrade_tasks">Additional Tasks</h3>




<h3 id="s03_00">Additional tasks: overview</h3>
<p>Once you've completed the product version update, and performed the post-upgrade tasks for each container, there are a few additional steps to complete the upgrade. You might have completed some of the steps below.</p>
<p><a href="#top">back to top</a></p>



<h3 id="perform_config_actions">Perform configuration actions</h3>
<p>Optional, recommended.</p>
<p>If you're upgrading from a previous version, it's a good idea to run the following configuration actions, even if they were not listed under Pending Installation Tasks:</p>
<ul>
	<li><a href="#proc_provisioning">Provisioning</a> (once per container running PM/CM)</li>
	<li><a href="#proc_upgrade_cm_models">Upgrade CM Models</a> (once per installation)</li>
	<li><a href="#proc_rebuild_cm_styles">Rebuild CM Styles</a> (once per installation)</li>
</ul>

<h3 id="check_system_health">Check system health</h3>
<p>Optional, recommended.</p>
<p>After installation, it's a good idea to check the system health.</p>
<p>Log into the Akana Administration Console for the PM/CM container and check the system health (<strong>Health</strong> tab).</p>
<p><a href="#top">back to top</a></p>



<h3 id="es_config">Configure Elasticsearch</h3>
<p>The developer portal is now available, but search will not work until you configure Elasticsearch.</p>
<p><strong>Note</strong>: These steps assume that Elasticsearch is already installed and configured. See <a href="#s01_03_es_install_config">Step 1-3: Install and configure Elasticsearch (if not already done)</a>.</p>
<p>Steps:</p>
<ol>
	<li><a href="#proc_es_config_global">Configure global settings</a></li>
	<li><a href="#proc_es_index_clear">Clear the Elasticsearch index</a></li>
	<li><a href="#proc_es_check_status">Check Elasticsearch status</a></li>
	<li><a href="#proc_container_restart">Restart the container</a></li>
	<li><a href="#proc_search_verify">Verify that search is working</a></li>
</ol>

<h5 id="proc_es_config_global">Configure global settings</h5>
<p>As part of installation or upgrade, you'll need to configure a couple of global settings in the Akana Administration Console so that the Elasticsearch feature will work correctly.</p>
<p>In the Akana Administration Console for any one container:</p>
<p><strong>Configuration</strong> &gt; <strong>Configuration Actions</strong> &gt; <strong>Configure Elasticsearch Global Configuration</strong>.</p>
<p>For instructions, see <a href="../platform_install/install_es_config.htm#config_es_ac">How do I configure Elasticsearch?</a></p>

<h5 id="proc_es_index_clear">Clear the Elasticsearch index</h5>
<p>You'll need to clear out the old Elasticsearch index so it can be refreshed. To do this, complete these two steps, at the same time:</p>
<ul>
	<li>Empty the INDEX_STATUS table in the database by running this database command:
		<pre>delete from {database_name}.INDEX_STATUS;</pre>
		<p><strong>For example:</strong></p>
		<p><img src="images_2019_all/es_delete_index.jpg" alt="Clearing the Elasticsearch index" /></p>
	</li>
	<li>Delete the index folders from their storage location, so that new index folders will be created when the index is regenerated.</li>
</ul>
<h5 id="proc_es_check_status">Check Elasticsearch status</h5>
<p>You can use the Elasticsearch API to check the status of your Elasticsearch, to make sure all is running smoothly. In the below, substitute the node where Elasticsearch is running:</p>
<pre>GET {protocol}://{hostname}:{port}/</pre>
<p>The response is a JSON object with information about your Elasticsearch. For more information, refer to the Elasticsearch website: <a href="https://www.elastic.co/guide/en/cloud-enterprise/2.0/ece-getting-started-connect.html" title="Link to Elasticsearch API" target="_blank">Connect to Elasticsearch</a>.</p>

<h5 id="proc_container_restart">Restart the container</h5>
<p>Stop and restart the container.</p>
<p>For instructions, see:</p>
<ul>
	<li><a href="../platform_install/installing_akana_api_platform_v2019.htm#starting_container">Starting a container</a></li>
	<li><a href="../platform_install/installing_akana_api_platform_v2019.htm#stopping_container">Stopping a container</a></li>
</ul>

<h5 id="proc_search_verify">Verify that search is working</h5>
<p>Log in to the developer portal user interface and verify that search is now working. For example, search for an API or an app.</p>
<p>This completes the Elasticsearch steps.</p>
<p><a href="#top">back to top</a></p>



<h3 id="restart_all">Restart all containers</h3>
<p>After running the configuration actions on all containers, stop and restart all containers.</p>
<p>For instructions, see:</p>
<ul>
	<li><a href="../platform_install/installing_akana_api_platform_v2019.htm#starting_container">Starting a container</a></li>
	<li><a href="../platform_install/installing_akana_api_platform_v2019.htm#stopping_container">Stopping a container</a></li>
</ul>
<p><a href="#top">back to top</a></p>



<div class = "divider1"></div>
<h3 id="h_upgrade_tasks_reference">Upgrade Procedures/Reference</h3>




<h3 id="launch_console">Launching the Akana Administration Console</h3>
<p>Installation and configuration tasks are performed in the Akana Administration Console for the container. First you create the container, and then you install features into the container and configure them.</p>
<h5>To launch the Akana Administration Console</h5>
<ol>
	<li>Launch the Akana Administration Console for the container instance:
<pre>http://{hostname}:{port}/admin</pre></li>
	<li>Log in to the Akana Administration Console as an Administrator. The Akana Administration Console launches and displays the <strong>Available Features</strong> tab. See <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_options">Installation Options: Full List</a> (installation doc).</li>
</ol>
<p><a href="#top">back to top</a></p>



<h3 id="running_upgrade_tools">Installing and running upgrade tools</h3>
<p>Sometimes, if there are significant changes to the database between versions, upgrade includes a specific upgrade tool that performs certain actions on the database to bring it up to date.</p>
<p>Depending on the version that you're upgrading from, you might have to install one or more of these upgrade tools, in the Akana Administration Console for the container, and run the tools. For example:</p>
<ul>
	<li>Akana 8.2 to 8.4 Model Upgrade</li>
	<li>Akana PM 8.0 Upgrade</li>
</ul>
<p>For a list of all the tools, see <a href="../platform_install/installing_akana_api_platform_v2019.htm#installation_tools">Installation Tools</a> (installation doc).</p>
<p>When you install an upgrade tool, it creates a post-upgrade task that makes changes to the database to upgrade it.</p>
<p>Post-upgrade tasks relating&nbsp;to upgrade tools are  once per installation, not per container.</p>
<p>Install and run all tools that are applicable to the version you're upgrading from/to.</p>
<p><a href="#top">back to top</a></p>



<h3 id="post_upgrade_tasks_running">Running post-upgrade tasks</h3>
<p>The specific post-upgrade tasks you'll need to run for a specific container depends on the version you're upgrading from, the features you're installing on the container, and the post-upgrade tasks that have already been done. For example, <strong>Configure Database Options</strong> is done once per installation; some other tasks are done for each container. Some tasks are only applicable if you're upgrading from a specific earlier version.</p>
<p>This section contains information about tasks you're likely to run into when upgrading using the simple scenario described in this document.</p>
<p>Common post-upgrade tasks are:</p>
<ul>
	<li><a href="#post_upgrade_01">Manage PKI Keys</a> (once per container)</li>
	<li><a href="#post_upgrade_02">Configure Database Options</a> (once per installation)</li>
	<li><a href="#post_upgrade_03">Manage Schemas</a> (once per installation)</li>
	<li><a href="#post_upgrade_04">Create Policy Manager Admin User</a> (once per installation)</li>
	<li><a href="#post_upgrade_05">Provisioning</a> (once per installation)</li>
	<li><a href="#proc_upgrade_cm_models">Upgrade CM Models</a> (once per installation)</li>
	<li><a href="#proc_rebuild_cm_styles">Rebuild CM Styles</a> (once per installation)</li>
</ul>
<p>For a full list of possible tasks, see <a href="../admin_console/config_actions.htm#config_actions_all">Configuration Actions: full list</a> (Akana Administration Console doc).</p>


<h4 id="post_upgrade_01">Manage PKI keys</h4>
<p>At the Manage PKI Keys wizard (<strong>Generate PKI Keys &amp; X.509 Certificate</strong> page), upload the container certificate from your secure external location. You'll need to upload a&nbsp;.JKS or&nbsp;.P12 file.</p>
<p>In the Akana Administration Console for the container, go to <strong>Configuration</strong> &gt; <strong>Manage PKI Keys</strong> and choose <strong>Import Private Key &amp; X.509 Certificate</strong>. See <a href="../admin_console/config_actions.htm#aac_ca_managepkikeys">Installation wizard: Manage PKI Keys</a> (Akana Administration Console doc).</p>
<p>For general information about container identity in the context of upgrading, see <a href="upgrade_managing_container_identity.htm">Managing Container Identity Across Upgrades</a>.</p>
<p>See <a href="../admin_console/config_actions.htm#aac_ca_managepkikeys">Installation wizard: Manage PKI Keys</a> (Akana Administration Console doc).</p>


<h4 id="post_upgrade_02">Configure Database Options</h4>
<p>Configure Database Options wizard (<strong>Select Database Options</strong> page): here, choose <strong>Use Existing Database</strong> and put in the values and credentials for the database from your prior version of the Akana API Platform. </p>
<p>See <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_tasks_add_database">Installation wizard: Add Database</a> (installation doc).</p>
<p><strong>Note</strong>: Depending on the database you're using, you might need to put a database driver in place, or take some other steps.</p>
<p>See <a href="../platform_install/installing_akana_api_platform_v2019.htm#database_notes">Database notes</a> and <a href="../platform_install/installing_akana_api_platform_v2019.htm#database_drivers">Database drivers</a> (installation doc).</p>

<h4 id="post_upgrade_03">Manage Schemas</h4>
<p>Manage Schemas wizard (<strong>Install Schemas</strong> page): Manages the database schemas for the container. </p>
<p>See <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_tasks_manage_schemas">Installation wizard: Manage Schemas</a> (installation doc).</p>

<h4 id="post_upgrade_04">Create Policy Manager Admin User</h4>
<p>Create Policy Manager Admin User (<strong>Define Policy Manager Administrator Credentials</strong> page): Creates the top-level Policy Manager user. </p>
<p>See <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_tasks_create_pm_admin_user">Installation wizard: Define Policy Manager Administrator Credentials</a> (installation doc).</p>

<h4 id="post_upgrade_05">Provisioning</h4>
<p>Provisioning: Initializes resources associated with the features installed on the container.</p>
<p>Must be completed for each container running PM/CM.</p>
<p>See <a href="../platform_install/installing_akana_api_platform_v2019.htm#install_tasks_provisioning">Installation wizard: Provisioning</a> (installation doc).</p>
<h5 id="proc_provisioning">To perform provisioning</h5>
<ol>
	<li>In the Akana Administration Console, click the <strong>Configuration</strong> tab.</li>
	<li>In the <strong>Configuration Actions</strong> section, choose the <strong>Provisioning</strong> configuration action, as shown below.
	<p><img src="images_2019_all/03_01_Manual_Provisioning.jpg" alt="Running Provisioning manually" /></p></li>
	<li>On the <strong>Provisioning</strong> page, make sure <strong>Perform Provisioning</strong> is checked, as shown below, and then click <strong>Finish</strong>.
		<p><strong>Note</strong>: Make sure the Provisioning task is 100% complete before moving to the next task.</p>
	<p><img src="images_2019_all/03_02_provisioning.jpg" alt="Provisioning Summary" /></p>
	</li>
	<li>When provisioning is 100% complete, click <strong>Close</strong>.</li>
</ol>

<h5 id="proc_upgrade_cm_models">To complete the Upgrade CM Models configuration action</h5>
<ol>
	<li>In the Akana Administration Console, click the <strong>Configuration</strong> tab.</li>
	<li>In the <strong>Configuration Actions</strong> section, choose <strong>Upgrade CM Models</strong>.</li>
	<li>When done, click <strong>Close</strong>.</li>
</ol>

<p>The <strong>Rebuild CM Styles</strong> task makes sure that you have the latest style updates, for all themes and tenants.</p>

<h5 id="proc_rebuild_cm_styles">To rebuild CM styles</h5>
<ol>
	<li>In the Akana Administration Console, click the <strong>Configuration</strong> tab.</li>
	<li>In the <strong>Configuration Actions</strong> section, choose <strong>Rebuild CM Styles</strong>.</li>
	<li>When done, click <strong>Finish</strong>.</li>
</ol>

<p><a href="#top">back to top</a></p>



<p><a href="#top">back to top</a></p>



<h3 id="check_features_installed">Checking that features were installed correctly</h3>
<p>When you've installed features in a container, it's a good idea to check to make sure that features have been installed correctly.</p>
<ol>
	<li>In the Akana Administration Console, go to<strong> Installed Features</strong>.</li>
	<li>Look at the <strong>Version</strong> column to make sure each feature has the correct version number. An example is shown below.
<p><img src="images_2019_all/ac_features_installed.jpg" alt="Features installed tab: 2019.0.0" /></p>
	</li>
</ol>
<p>If there are any issues, check that you followed all steps correctly.</p>
<p>If needed, <a href="#tech_support_contact">contact Technical Support</a>.</p>
<p><a href="#top">back to top</a></p>



<h3 id="find_container_key">Finding the container key</h3>
<p>To find the container key for your old container in the Akana Administration Console for the container, follow the steps below.</p>

<h5 id="proc_find_container_key">To find the container key</h5>
<ol>
	<li>Log in to the Akana Administration Console using Administrator credentials.</li>
	<li>Click the <strong>Configuration</strong> tab.</li>
	<li>In the <strong>Configuration Categories</strong> section, find <strong>com.soa.config</strong>. An example is shown below.
	<p><img src="images_2019_all/ac_config_com_soa_config_container_key.png" alt="Finding the container key" /></p></li>
	<li>Locate the <strong>container.key</strong> property and note the value.</li>
</ol>
<p><a href="#top">back to top</a></p>




<h3 id="sched_jobs_off">Turning the scheduled jobs off</h3>
<p>If you turn off the scheduled jobs, turn off these two jobs, for all containers with Policy Manager installed, in this sequence:</p>
<ol>
	<li>com.soa.scheduler.quartz</li>
	<li>simple.scheduler.enabled</li>
</ol>

<h5>To turn off scheduled jobs</h5>
<ol>
	<li>Log in to the Akana Administration Console using Administrator credentials.</li>
	<li>Click the <strong>Configuration</strong> tab.</li>
	<li>In the <strong>Configuration Categories</strong> section, find <strong>com.soa.scheduler.quartz</strong>. </li>
	<li>Locate the <strong>org.quartz.scheduler.enabled</strong> property and change it to <strong>false</strong>.</li>
	<li>Click <strong>Apply Changes</strong>.</li>
	<li>In the <strong>Configuration Categories</strong> section, find <strong>com.soa.scheduler</strong>. </li>
	<li>Locate the <strong>simple.scheduler.enabled</strong> property and change it to <strong>false</strong>, as shown below.
			<p><img src="images_2019_all/02_01_config_categ.jpg" alt="Turning off scheduled jobs" /></p></li>
	<li>Click <strong>Apply Changes</strong>.</li>
</ol>
<p><a href="#top">back to top</a></p>



<h3 id="sched_jobs_on">Turning the scheduled jobs back on</h3>
<p>If you turned the scheduled jobs off, and are ready to turn them back on again, turn them on in this sequence, the reverse of the sequence in which you turned them off, for all containers with Policy Manager installed:</p>
<ol>
	<li>simple.scheduler.enabled</li>
	<li>com.soa.scheduler.quartz</li>
</ol>

<h5>To turn scheduled jobs back on</h5>
<ol>
	<li>Log in to the Akana Administration Console using Administrator credentials.</li>
	<li>Click the <strong>Configuration</strong> tab.</li>
	<li>In the Configuration Categories section, find <strong>com.soa.scheduler</strong>. </li>
	<li>Locate the <strong>simple.scheduler.enabled</strong> property and change it to <strong>true</strong>.</li>
	<li>Click <strong>Apply Changes</strong>.</li>
	<li>In the <strong>Configuration Categories</strong> section, find <strong>com.soa.scheduler.quartz</strong>. </li>
	<li>Locate the <strong>org.quartz.scheduler.enabled</strong> property and change it to <strong>true</strong>.</li>
	<li>Click <strong>Apply Changes</strong>.</li>
</ol>
<p><a href="#top">back to top</a></p>



<h3 id="unreg-rereg_win">Unregistering and re-registering the Windows service</h3>
<p>If your containers are registered as a Windows service, so that the container will start automatically when Windows starts, you must unregister the old version and register the new version, for each container.</p>
<p>If you're not sure which containers are registered as a Windows service, you can check in the Windows Control Panel (<strong>Administrative Tools</strong> &gt; <strong>Services</strong>). To change the services, you must run as Administrator.</p>

<h5 id="proc_register_unregister_windows">To unregister and register the Windows service</h5>
<ol>
	<li>Open a command prompt in Administrator mode (If you don't use Administrator mode, Windows prompts for Admin permission before unregistering/registering the service, but doesn't actually start the service).</li>
	<li>Unregister the previous version as a windows service:
		<pre>.\{install_folder}\bin\unregisterContainerServiceYAJWS.bat {instance_name}</pre></li>
	<li>Register the new version as a Windows service:
	<pre>.\{install_folder}\bin\registerContainerServiceYAJWS.bat {instance_name}</pre></li>
	<li>If you're running in Administrator mode, Windows registers the service and also starts it.</li>
	<li>Repeat steps 2 and 3 for each additional container that's registered as a Windows service.</li>
</ol>
<p><a href="#top">back to top</a></p>



<h3 id="s02_09">Starting a container</h3>
<p>There are several ways you can start a container: Windows, as Windows service, or Unix. Follow the applicable procedure:</p>
<ul>
	<li><a href="#container_start_win">To start the container (Windows)</a></li>
	<li><a href="#container_start_win_svc">To start the container (as Windows service)</a></li>
	<li><a href="#container_start_unix">To start the container (Unix)</a></li>
	<li><a href="#container_start_unix_bg">To start the container (Unix, Background</a></li>
</ul>

<h5 id="container_start_win">To start the container (Windows)</h5>
<ol>
	<li>Navigate to the <strong>\{install_folder}\bin\</strong> folder.</li>
	<li>Type the following:
<pre>startup {instance_name}</pre></li>
</ol>

<h5 id="container_start_win_svc">To start the container (as Windows service)</h5>
<ol>
	<li>Launch the Program Group (<strong>Settings</strong> &gt; <strong>Control Panel</strong> &gt; <strong>Administrative Tools</strong> &gt; <strong>Services</strong>).</li>
	<li>Select the Akana Container Instance (the instance name is displayed as the Container Key).</li>
	<li>From the <strong>Actions</strong> menu, select <strong>Start</strong>.</li>
</ol>

<h5 id="container_start_unix">To start the container (Unix)</h5>
<ol>
	<li>Navigate to the <strong>/{install_folder}/bin/</strong> folder.</li>
	<li>Type the following:
<pre>startup.sh {instance_name}</pre></li>
</ol>

<h5 id="container_start_unix_bg">To start the container (Unix, Background)</h5>
<ol>
	<li>Navigate to the /bin folder.</li>
	<li>Type the following:
<pre>startup.sh {instance_name} -bg</pre></li>
</ol>
<p><a href="#top">back to top</a></p>



<h3 id="auto_prop_xfer">Automating the transfer of container properties</h3>
<p>When upgrading by creating a new container, you'll need to transfer, or re-create, the configuration settings on the new container. There are two ways to do this:</p>
<ul>
	<li><strong>Manual configuration</strong>: Create the new container, install the features into it, then manually replicate any custom settings from the old container, to the new container.</li>
	<li><strong>Automated configuration (recommended)</strong>: With the old container running, use automation to extract the custom configuration properties, into a recipe. Next, create the new container and install the features into it. Finally, use automation to run the recipe you created, to replicate the configuration of the old container.
	<p>For instructions to run the recipe, see <a href="../automation/automation_ref.htm#running_recipes_remotely">Running Recipes Remotely</a>. An example is shown below. Use the name of the recipe that you used when you extracted the properties<a href="#s02_03_save_props"></a>.</p>
<pre>&gt; ./jython.sh -m akana.recipe --recipe &lt;name of extracted recipe&gt; --url http://localhost:9900 --user administrator --password password</pre></li>
</ul>

<h5 id="proc_xfer_properties">To transfer configuration properties from an old container to a new container via automation</h5>
<ol>
	<li>Before creating the new container, and with the old container running, extract the custom properties. See <a href="#s02_03_save_props">Step 2-3: Save properties from old container</a>.
	<p>For instructions, see <a href="../automation/automation_ref.htm#recipe_extract">Extracting a Recipe</a> (Automation doc).</p></li>
	<li>Create the new container. See <a href="#s02_05_container_01">Step 2-5: Create and configure the first container</a>, Step #6, after doing the initial configuration steps, shut down the container. Rather than restarting as in Step #7, save out the new configuration settings at that point.</li>
	<li>Compare the new settings with the old settings to arrive at the settings that will need to be configured on the new container.</li>
	<li>If available, use automation to update the container configuration.</li>
	<li>Now complete <a href="#s02_05_container_01">Step 2-5: Create and configure the first container</a> by restarting the container, and verify that the configuration properties are set correctly.</li>
	<li>Follow steps 2 through 5 for additional containers until they are all configured.</li>
	<li>Continue with the post-install steps.</li>
</ol>
<p><a href="#top">Back to top</a></p>



<h3 id="upgrade_automation">Automation recipes for upgrade</h3>
<p>The table below lists some of the automation recipes you could use to automate the upgrade process.</p>
<p>Recipes are in the <strong>{install_dir}/recipes</strong> folder of your installation.</p>
<p><strong>Note</strong>: Automation recipes for creating containers are valid for Linux only. See <a href="../automation/automation_ref.htm#ov_automation_windows">Running automation recipes on Windows</a>.</p>
<table class="doctable">
	<thead>
		<tr>
			<th>Use this recipe...</th>
			<th>To...</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>cm-upgrade</td>
			<td>Perform CM upgrade recipe.</td>
		</tr>
		<tr>
			<td>pm-cm-new-upgrade </td>
			<td>Create new PM/CM container on an existing database and perform any upgrade tasks.</td>
		</tr>
		<tr>
			<td>pm-cm-upgrade</td>
			<td>Perform PM/CM upgrade recipe.</td>
		</tr>
		<tr>
			<td>pm-upgrade</td>
			<td>Perform PM upgrade recipe.</td>
		</tr>
		</tbody>
</table>
<p><strong>Note</strong>: If you want to create a new Network Director container, rather than replicating an existing one, you will need to re-register the new container. For an example of doing this via automation, see <a href="../automation/automation_examples.htm#h_container_nd_register">Registering the ND container</a> (automation doc).</p>
<p><a href="#top">Back to top</a></p>



<h3 id="tech_support_contact">Contacting Technical Support</h3>
<p>If you need to contact Technical Support, submit an email to <a href="mailto:support@akana.com">support@akana.com</a>.</p>
<p>When sending a support query, please provide the following information:</p>
<ul>
	<li>Your name</li>
	<li>Email address</li>
	<li>Subject</li>
	<li>As much information as possible regarding your question.</li>
</ul>
<p>You'll receive an acknowledgment email and one of our support staff will contact you.</p>
<p>You can also access the Support site at <a href="https://servicedesk.akana.com/servicedesk/customer/user/login" title="Akana technical support site" target="_blank">https://servicedesk.akana.com/servicedesk/customer/user/login</a>.</p>
<p><a href="#top">Back to top</a></p>



<div class = "divider1"></div>



<h3 id="related_topics">Related Topics</h3>
<div class="relatedlinks" id="install"><!-- #BeginLibraryItem "/Library/relatedtopics_install.lbi" -->
<ul>
	<li><a href="upgrading_akana_api_platform_all.htm">Upgrading the Akana API Platform (all versions)</a></li>
	<li><a href="upgrading_min_downtime.htm">Use Case: Upgrading with Minimum Downtime</a></li>
	<li><a href="upgrading_micro.htm">Minor-Version Update Notes</a></li>
</ul>
<ul>
	<li><a href="../platform_install/installing_akana_api_platform_all.htm">Installing the Akana API Platform (all versions)</a></li>
	<li><a href="../platform_install/implementation_planning.htm">Planning Your Implementation</a></li>
	<li><a href="../platform_install/install_cm_jython_script.htm">Installation Jython Script</a></li>
	<li><a href="../platform_install/install_es_config.htm">Installing and Configuring Elasticsearch</a></li>
	<li><a href="../platform_install/install_es_secure_tc.htm">Configuring Elasticsearch with Security</a></li>
</ul><!-- #EndLibraryItem --></div>