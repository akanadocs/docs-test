---
layout: page
title: Installing and Configuring Elasticsearch (2018.0.0)
description: Learn how to install and configure the Elasticsearch search feature for the developer portal (2018.0.0).
product: sp
category: gs
weight: 08
sub-nav-class: Installation - Akana API Platform
type: page
nav-title: Installing and Configuring Elasticsearch (2018.0.0)
---
<h2 id="top">Installing and Configuring Elasticsearch (2018.0.0)</h2>
<p>This document provides reference information and examples relating to installation and configuration of the Elasticsearch search feature for the Akana API Platform developer portal.</p>

<p>
<a href="install_es_secure_tc.htm" class="button secondary">Configuring Elasticsearch with Security</a>  
<a href="install_es_config_84.htm" class="button secondary">Installing and Configuring Elasticsearch (8.4x)</a>  
</p>


<h5 class="stamp">API Platform Version: 8.1 and later. Updated for 2018.0.0.</h5>
<p><strong>Note</strong>: For information about secure configuration of Elasticsearch, see <a href="install_es_secure_tc.htm">Configuring Elasticsearch with security</a>.</p>
<p>For information about installing and configuring Elasticsearch in version 8.4x, see <a href="install_es_config_84.htm">Installing and Configuring Elasticsearch (8.4x)</a>.</p>
<div class = "divider1"></div>



<h3 style="color: gray;">Table of Contents</h3>


<h5 style="color: gray;"><a href="#h_es_feature_info">Elasticsearch feature overview:</a></h5>
<ol class="table_of_contents">
	<li><a href="#es_about">About the Elasticsearch feature</a></li>
	<li><a href="#es_version">Elasticsearch version</a></li>
	<li><a href="#es_planning">Planning your Elasticsearch feature</a></li>
	<li><a href="#es_deployment_mode">Should I choose Transport Client or REST Client mode?</a></li>
	<li><a href="#es_ref_info">Links to additional information about Elasticsearch</a></li>
</ol>


<h5 style="color: gray;"><a href="#h_es_configuring">Installing and Configuring Elasticsearch:</a></h5>


<ol class="table_of_contents">
	<li><a href="#es_installing">Installing Elasticsearch</a></li>
	<li><a href="#es_config_highlevel">High-level steps for Elasticsearch configuration</a></li>
	<li><a href="#es_yaml">What changes do I need to make to the Elasticsearch YAML file?</a>
		<ul>
			<li><a href="#es_config_default_ports">Default ports for Elasticsearch configuration</a></li>
		</ul>
	</li>
	<li><a href="#config_es_ac">How do I configure Elasticsearch?</a></li>
	<li><a href="#es_config_settings">How do I configure the number of nodes and shards?</a></li>
</ol>




<div class = "divider1"></div>
<h3 id="h_es_feature_info">Elasticsearch feature information:</h3>




<h3 id="es_about">About the Elasticsearch feature</h3>
<p>Elasticsearch is a search engine based on Apache Lucene. It is robust, and allows fast indexing and responsive updating. It's an extremely popular tool in very broad use&#8212;a scalable search solution that uses JSON messaging over an HTTP interface with a native Java API.</p>
<p>Elasticsearch is run in standalone mode. Your installation will need to have Elasticsearch installed on at least one server. Just as with a relational database, you'll need to provide the software and hardware required. You can get started with a trial license.</p>
<p>All containers running the Akana API Platform can use Elasticsearch. A cluster is recommended for redundancy.</p>
<p>There are two deployment options:</p>
<ul>
	<li><strong>Transport Client</strong>: previously supported by the platform (not recommended for 2018.0.0).</li>
	<li><strong>REST Client</strong>: New in 2018.0.0.</li>
</ul>
<p>For more information on these choices, see <a href="#es_deployment_mode">Should I choose Transport Client or REST Client mode?</a> below.</p>
<p>Administration of Elasticsearch is done with the configuration wizard in the Akana Administration Console.</p>
<p>For more information on Elasticsearch terminology, refer to the Elasticsearch glossary: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/glossary.html" title="Elasticsearch glossary of terms" target="_blank">https://www.elastic.co/guide/en/elasticsearch/reference/current/glossary.html</a>.</p>
<p><strong>Note</strong>: In version 8.0, Elasticsearch embedded mode was offered as a short-term option to help customers to migrate from Compass to Elasticsearch. This was never the recommended option; standalone mode is better. In version 2018.0.0, only standalone mode is supported.</p>
<p><a href="#top">Back to top</a></p>



<h3 id="es_version">Elasticsearch version</h3>
<p>Support for Elasticsearch was introduced in Akana API Platform version 8.0. The initial version, and all later versions prior to 2018.0.0, use Elasticsearch 1.5.</p>
<p>In version 2018.0.0, the Akana API platform uses Elasticsearch 6.3.1. See <a href="#es_installing">Installing Elasticsearch</a>.</p>
<p><a href="#top">Back to top</a></p>



<h3 id="es_planning">Planning your Elasticsearch feature</h3>
<p>As part of planning your installation, you'll need to make some decisions about how you want to set up the Elasticsearch feature:</p>
<ul>
	<li>Do you want one or more Elasticsearch servers? Additional servers are recommended, for fallback reasons.</li>
	<li>Do you want dedicated Elasticsearch servers? You could also install Elasticsearch on one or more servers running the Akana API Platform.</li>
	<li>Which deployment mode do you want to use, Transport Client or REST Client? see <a href="#es_deployment_mode">Should I choose Transport Client or REST Client mode?</a> below.</li>
</ul>
<p><a href="#top">Back to top</a></p>



<h3 id="es_deployment_mode">Should I choose Transport Client or REST Client mode?</h3>
<p>There are two options for <strong>Deployment Mode</strong>:</p>
<ul>
	<li><strong>Transport Client</strong>: The client uses a TCP connection to communicate to the Elasticsearch server or cluster. Transport Client mode will be deprecated in a later version of Elasticsearch, and will be removed in 8.0. It's best to use REST Client.</li>
	<li><strong>REST Client</strong>: The client communicates to the Elasticsearch server or cluster by accessing a URL. Introduced in a recent version of Elasticsearch. Recommended.</li>
</ul>
<p><a href="#top">Back to top</a></p>



<h3 id="es_ref_info">Links to additional information about Elasticsearch</h3>
<p>For more information about Elasticsearch, refer to the following:</p>
<ul>
	<li>Elasticsearch website: <a href="https://www.elastic.co/">https://www.elastic.co/</a></li>
	<li><a href="install_es_secure_tc.htm">Configuring Elasticsearch with Security</a> (specific to Akana)</li>
	<li>Elasticsearch glossary: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/glossary.html" title="Elasticsearch glossary of terms" target="_blank">https://www.elastic.co/guide/en/elasticsearch/reference/current/glossary.html</a></li>
</ul>
<p><a href="#top">Back to top</a></p>




<div class = "divider1"></div>
<h3 id="h_es_configuring">Installing and configuring Elasticsearch:</h3>




<h3 id="es_installing">Installing Elasticsearch</h3>
<p>You'll need to download Elasticsearch version 6.3.1, and install it on the server or servers you'll be using.</p>
<p>Download file: <a href="https://www.elastic.co/downloads/past-releases/elasticsearch-6-3-1" title="Link for Elasticsearch 6.3.1 download" target="_blank">https://www.elastic.co/downloads/past-releases/elasticsearch-6-3-1</a>. Follow the instructions provided by Elasticsearch.</p>
<p><a href="#top">Back to top</a></p>



<h3 id="es_config_highlevel">High-level steps for Elasticsearch configuration</h3>
<p>To use Elasticsearch on the Akana API Platform you'll need to:</p>
<ul>
	<li>Install Elasticsearch on one or more servers. See <a href="#es_installing">Installing Elasticsearch</a> above.</li>
	<li>As part of the Elasticsearch installation, modify the Elasticsearch YAML file. See <a href="#es_yaml">What changes do I need to make to the Elasticsearch YAML file?</a> below.</li>
	<li>Optional: set up security for your Elasticsearch, which requires additional setup and additional modifications to the Elasticsearch YAML file. See <a href="install_es_secure_tc.htm">Configuring Elasticsearch with Security</a>.</li>
	<li>Complete the global configuration steps, once for all containers. See <a href="#config_es_ac">How do I configure Elasticsearch?</a> below.</li>
</ul>
<p><a href="#top">Back to top</a></p>



<h3 id="es_yaml">What changes do I need to make to the Elasticsearch YAML file?</h3>
<p>You'll need to make some changes to one of the Elasticsearch configuration files, <strong>elasticsearch.yml</strong>, so that Elasticsearch will work for your Akana API Platform installation.</p>
<p>The <strong>elasticsearch.yml</strong> file is generally stored in the<strong> {elasticsearch_home}/config</strong> folder. It might have some default placeholder content, but not all the placeholder values.</p>
<p>As a starting point to model your changes, you can use the example in <a href="#yaml_sample_no_xpack">Sample Elasticsearch YAML file</a> below.</p>
<p><strong>Note</strong>: If you want security, you'll need to add some extra values, using the example in <a href="install_es_secure_tc.htm#yaml_xpack">Sample Elasticsearch YAML file with security settings</a>. If you don't want security, just set up the values listed below.</p>
<ul>
	<li>Cluster name: needed for both Transport Client and REST Client. For example:
		<pre>cluster.name: akana</pre>
	</li>
	<li>Node name: needed for both Transport Client and REST Client, if you want to name your own node. For example:
		<pre>node.name: node-1</pre>
	</li>
	<li>Transport TCP port: needed for Transport Client. For example:
		<pre>transport.tcp.port: 9300</pre>
	</li>
	<li>Path to directory where to store the data: needed for both. For example:
		<pre>/vars/elasticsearch/data</pre>
	</li>
	<li>Optional if you don't want to bind to all interfaces: Set the bind address to a specific IP. For example:
		<pre>network.host: 192.164.0.1</pre>
	</li>
	<li>Pass an initial list of hostnames for all the nodes in the cluster, to provide a seed list of other nodes in the cluster that are likely to be live and contactable, as part of discovery. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.4/discovery-settings.html#unicast.hosts">Discovery Settings</a> on the Elasticsearch website. For example:
		<pre>discovery.zen.ping.unicast.hosts: [&quot;localhost&quot;, &quot;[::1]&quot;]</pre>
	</li>
</ul>
<p>For general information about the <strong>elasticsearch.yml</strong> file, see <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html" title="Information about the elasticsearch.yml file" target="_blank">https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html</a>.</p>

<h5 id="yaml_sample_no_xpack">Sample Elasticsearch YAML file</h5>
<pre># ======================== Elasticsearch Configuration =========================
#
# NOTE: Elasticsearch comes with reasonable defaults for most settings.
#       Before you set out to tweak and tune the configuration, make sure you
#       understand what are you trying to accomplish and the consequences.
#
# The primary way of configuring a node is via this file. This template lists
# the most important settings you may want to configure for a production cluster.
#
# Please consult the documentation for further information on configuration options:
# https://www.elastic.co/guide/en/elasticsearch/reference/index.html
#
# ---------------------------------- Cluster -----------------------------------
#
# Use a descriptive name for your cluster:
#
cluster.name: akana
#
# ------------------------------------ Node ------------------------------------
#
# Use a descriptive name for the node:
#
node.name: node-1
#
# Add custom attributes to the node:
#
#node.attr.rack: r1
#
# ----------------------------------- Paths ------------------------------------
#
# Path to directory where to store the data (separate multiple locations by comma):
#
path.data: /vars/elasticsearch/data
#
# Path to log files:
#
path.logs: /vars/elasticsearch/logs
#
# ----------------------------------- Memory -----------------------------------
#
# Lock the memory on startup:
#
#bootstrap.memory_lock: true
#
# Make sure that the heap size is set to about half the memory available
# on the system and that the owner of the process is allowed to use this
# limit.
#
# Elasticsearch performs poorly when the system is swapping the memory.
#
# ---------------------------------- Network -----------------------------------
#
# Set the bind address to a specific IP (IPv4 or IPv6):
#
#network.host: 192.168.0.1
network.host: 0.0.0.0

transport.tcp.port: 9300
#
# Set a custom port for HTTP:
#
http.port: 9200
#
# For more information, consult the network module documentation.
#
# --------------------------------- Discovery ----------------------------------
#
# Pass an initial list of hosts to perform discovery when new node is started:
# The default list of hosts is [&quot;127.0.0.1&quot;, &quot;[::1]&quot;]
#
discovery.zen.ping.unicast.hosts: [&quot;localhost&quot;, &quot;[::1]&quot;]
#
# Prevent the &quot;split brain&quot; by configuring the majority of nodes (total number of master-eligible nodes / 2 + 1):
#
discovery.zen.minimum_master_nodes: 1
#
# For more information, consult the zen discovery module documentation.
#
# ---------------------------------- Gateway -----------------------------------
#
# Block initial recovery after a full cluster restart until N nodes are started:
#
#gateway.recover_after_nodes: 3
#
# For more information, consult the gateway module documentation.
#
# ---------------------------------- Various -----------------------------------
# (This section is needed only if you want to configure security)</pre>
<p><strong>Note</strong>: If you want to use security with Elasticsearch, you'll need to set up additional values in the YAML file. See <a href="install_es_secure_tc.htm#yaml_xpack">Sample Elasticsearch YAML file with security settings</a>.</p>


<h4 id="es_config_default_ports">Default ports for Elasticsearch configuration</h4>
<p>The default ports for Elasticsearch configuration are as follows:</p>
<ul>
	<li><strong>HTTP</strong>: Default is 9200, default range is 9200&#8211;9299</li>
	<li><strong>TCP</strong>: Default is 9300, default range is TCP is 9300&#8211;9399</li>
</ul>
<p>Range implies that if the first port is busy, the platform tries the next one and so on.</p>
<p class="apidoc_note"><strong>Note to Administrators</strong>: When setting up your implementation, make sure that all ports in the range 9300&#8211;9305 are open, on all containers that the Elasticsearch feature is installed on.</p>
<p><a href="#top">Back to top</a></p>



<h3 id="config_es_ac">How do I configure Elasticsearch?</h3>
<p>In configuring the Elasticsearch feature for your Akana API Platform implementation, there are two deployment modes; follow the applicable set of steps as listed below.</p>
<ul>
	<li><a href="#proc_es_global_config_tc">Transport Client</a></li>
	<li><a href="#proc_es_global_config_rc">REST Client</a> (recommended)</li>
</ul>
<p>For information on which mode to choose, see <a href="#es_deployment_mode">Should I choose Transport Client or REST Client mode?</a></p>
<p><strong>Note</strong>: Configuration needs to be set up only once, for all containers, and can be done in any one  container. The settings are stored in the database for the entire implementation.</p>

<h5 id="proc_es_global_config_tc">Configure Elasticsearch Global Configuration: Transport Client</h5>
<ol>
	<li>In the Akana Administration Console, on the <strong>Configuration</strong> tab, under <strong>Configuration Actions</strong>, choose <strong>Configure Elasticsearch Global Configuration</strong>. The wizard opens.</li>
	<li>Make sure the Deployment Mode is set to <strong>Transport Client</strong>, as shown below.
		<p><img src="images_2018/es_global_config_tc.jpg" alt="Configure Elasticsearch Global Configuration: Transport Client" /></p>
		</li>
	<li>Provide the name of the cluster for the Elasticsearch feature; for example, <strong>akana</strong>.</li>
	<li>In the ES Server URL field, provide the transport address for the Elasticsearch server (one or more, separated by commas), in the format: {hostname}:{port} (without the protocol). Examples:
		<ul>
			<li>localhost:9300</li>
			<li>10.12.121.116:9300</li>
			<li>10.12.121.116:9300,10.12.122.140:9300</li>
		</ul>
		</li>
	
	<li>Click <strong>Finish</strong> and then click <strong>Close</strong>.</li>
</ol>
<h5 id="proc_es_global_config_rc">Configure Elasticsearch Global Configuration: REST Client</h5>
<ol>
	<li>In the Akana Administration Console, on the <strong>Configuration</strong> tab, under <strong>Configuration Actions</strong>, choose <strong>Configure Elasticsearch Global Configuration</strong>. The wizard opens.</li>
	<li>For Deployment Mode, choose <strong>REST Client</strong>.
		<p><img src="images_2018/es_global_config_rc.jpg" alt="Configure Elasticsearch Global Configuration: REST Client" /></p></li>
	<li>In the <strong>ES HTTP URLs</strong> field, provide the HTTP URLs for each container where Community Manager is running, as well as any container running scheduled jobs. Provide full URLs; use a comma separator between values. Examples:
		<ul>
			<li>http://localhost:9200</li>
			<li>https://localhost:9200</li>
			<li>http://localhost:9200,http://localhost:9250</li>
		</ul>
		<p><strong>Note</strong>: If there are multiple URLs, the protocol must be the same for all. For example, you cannot mix HTTP and HTTPS.</p>
		</li>
	
	<li>Click <strong>Finish</strong> and then click <strong>Close</strong>.</li>
</ol>
<p><a href="#top">Back to top</a></p>



<h3 id="es_config_settings">How do I configure the number of nodes and shards?</h3>
<h5 class="stamp">New in version: 8.0.3</h5>
<p class="apidoc_note"><strong>Note</strong>: This step is optional. The platform defaults are sufficient.</p>
<p>The platform includes configuration settings that you can use to manage your Elasticsearch setup. These are controlled by configuration settings in the Akana Administration Console.</p>
<p>In the Akana Administration Console, the configuration category is: <strong>com.akana.elasticsearch</strong>.</p>
<p>In the default configuration, shown below, there are two shards and one replica. Let's say there are two nodes in the cluster. One shard, approximately half the index, is stored on each node. The one replica includes a replica of each shard:</p>
<ul>
	<li>Node 1 has Shard 1 and the replica of Shard 2</li>
	<li>Node 2 has Shard 2 and the replica of Shard 1</li>
</ul>
<p>In this scenario, if one node goes down, the other node has the full search index. Additional nodes add additional safety.</p>
<p>There are two settings, as shown below.</p>

<dl>
<dt>elastic.config.index.number.of.replicas</dt>
	<dd>The number of replicas (additional copies) of the Elasticsearch index. Each replica includes a replica of each shard, so one replica might be distributed across multiple nodes, just as the index itself is split into shards which are distributed across nodes.</dd>
	<dd>Default: 1</dd>
<dt>elastic.config.index.number.of.shards</dt>
	<dd>The number of <a href="../../cm/learnmore/basics_glossary.htm#gl_es_shard">shards</a> (splits) for the Elasticsearch index. </dd>
	<dd><strong>Note</strong>: This is a one-time setting. An Elasticsearch index cannot be re-sharded; if you want to change the number of shards, after changing the setting you'll need to delete the /index folder that the search index is stored in and then rebuild the index.</dd>
	<dd>Default: 2</dd>
</dl>

<p>For additional information about configuration settings in the Akana Administration Console, see <a href="../../cm/learnmore/site_admin_admin_console_settings.htm">Admin Console Settings</a>.</p>
<p><a href="#top">Back to top</a></p>




<div class = "divider1"></div>




<h3 id="related_topics">Related Topics</h3>
<div class="relatedlinks" id="install">
<ul>
	<li><a href="../upgrade/upgrading_akana_api_platform_84_2018.htm">Upgrading Akana API Platform from Version 8.4x to Version 2018.0.x</a></li>
	<li><a href="../upgrade/upgrading_akana_api_platform_82_84.htm">Upgrading Akana API Platform from Version 8.2 to Version 8.4x</a></li>
	<li><a href="../upgrade/upgrading_min_downtime.htm">Use Case: Upgrading with Minimum Downtime</a></li>
	<li><a href="../upgrade/upgrading_micro.htm">Micro-Version Upgrade</a></li>
</ul>
<ul>
	<li><a href="../platform_install/installing_akana_api_platform.htm">Installing the Akana API Platform 2018.0.0</a></li>
	<li><a href="../platform_install/installing_akana_api_platform_v84.htm">Installing the Akana API Platform 8.4x</a></li>
	<li><a href="../platform_install/installing_akana_api_platform_v82.htm">Installing the Akana API Platform 8.2x</a></li>
	<li><a href="../platform_install/implementation_planning.htm">Planning Your Implementation</a></li>
	<li><a href="../platform_install/install_cm_jython_script.htm">Installation Jython Script</a></li>
	<li><a href="../platform_install/install_es_config.htm">Installing and Configuring Elasticsearch</a></li>
	<li><a href="../platform_install/install_es_secure_tc.htm">Configuring Elasticsearch with security</a></li>
</ul>
</div>
