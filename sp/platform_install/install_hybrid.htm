---
layout: page
title: Hybrid Installation Scenario
description: A use case for hybrid installation
product: sp
category: ref
weight: 90
sub-nav-class: Akana API Platform Installation
type: page
nav-title: Hybrid Installation Scenario
---
<h2><a name="top"></a>Installation Use Case: Hybrid Installation</h2>
<p>This document provides reference information and examples relating to installing and configuring a hybrid installation.</p>



<p>
<a href="installing_akana_api_platform_v84.htm" class="button secondary">Installing the Akana API Platform 8.4x</a>
<a href="../admin_console/using_admin_console.htm" class="button secondary">Using the Admin Console</a>
<a href="../admin_console/installing_tools.htm" class="button secondary">Installing Tools</a>
<a href="../admin_console/installing_plugins.htm" class="button secondary">Installing Plug-ins</a>
<a href="../admin_console/config_actions.htm" class="button secondary">Configuration Actions</a>
</p>

<div class = "divider1"></div>
<h3 style="color: gray;">Table of Contents</h3>
<ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#prerequisites">Prerequisites</a></li>
  <li><a href="#hybrid_01">Installation first steps</a></li>
  <li><a href="#hybrid_02_core">Installing the Core Platform</a></li>
  <li><a href="#hybrid_03_nd">Configuring the Network Director (ND)</a></li>
  <li><a href="#hybrid_install_register_nd">Registering ND with the Akana SaaS Platform</a></li>
  <li><a href="#hybrid_appx_proxy_server">Appendix 1: using a proxy server for API Gateway call-out</a></li>
</ul>
<div class = "divider1"></div>



<h3 id="introduction">Introduction</h3>
<p>This document summarizes the installation of Akana Platform 8.4 API Gateway on a CentOS7 or RHEL7 environment for hybrid deployment purposes.</p>
<p>This scenario presumes availability of an Akana SaaS tenant environment (API Portal).</p>



<h3 id="prerequisites">Prerequisites</h3>
<p>You'll need to download the installation ZIP files from the Akana Library site:</p>
<ul>
	<li><a href="#prereq_01">Akana software packages (Akana Platform and Akana API Platform)</a></li>
	<li><a href="#prereq_01">Optional: additional plug-ins</a></li>
</ul>


<h4 id="prereq_01">Akana software packages (Akana Platform and Akana API Platform)</h4>
<p>From download location <a href="https://library.roguewave.com/display/MAIN/AP+8.4" title="https://library.roguewave.com/display/MAIN/AP+8.4" target="_blank">https://library.roguewave.com/display/MAIN/AP+8.4</a>:</p>
<ul>
	<li><strong>Akana Platform AP8.4</strong> (AP 84GA): akana-platform-linux-jre-8.4.14.zip (or akana-platform-8.4.14.zip in case embedded JRE is not used)</li>
	<li><strong>Cumulative update 8.4.12</strong>: akana-platform-update-cumulative-8.4.12.zip</li>
</ul>
<p>From download location <a href="https://library.roguewave.com/display/MAIN/Akana+API+Platform+8.4 " title="https://library.roguewave.com/display/MAIN/Akana+API+Platform+8.4 " target="_blank">https://library.roguewave.com/display/MAIN/Akana+API+Platform+8.4</a>:</p>
<ul>
	<li><strong>Akana API Platform 8.4</strong> (8.4GA): akana-api-platform-8.4.682.zip</li>
	<li><strong>Cumulative update 8.4.15</strong>: akana-api-platform-update-cumulative-8.4.15.zip</li>
</ul>
<p><strong>Note</strong>: Verify the MD5 checksums after download, to be sure you have the complete download files.</p>


<h4 id="prereq_02">Optional: additional plug-ins</h4>
<p>The following optional additional plug-ins add the <strong>Map Headers</strong> and <strong>Normalize</strong> activities to the <strong>Process Designer </strong>user interface. These plug-ins are not available for download on the Akana Library site, but will be provided separately if needed. {<span class="apidoc_red">ask Pro Serv? Or can customers as Support for these?</span>}</p>
<ul>
	<li><strong>Headers</strong>: com.akana.activity.headers_8.4.0.zip</li>
	<li><strong>Normalize</strong>: com.akana.activity.normalize_8.2.0.zip</li>
</ul>
<p><a href="#top">Back to top</a></p>



<h3 id="hybrid_01">Installation first steps</h3>
<p>First, complete the following steps:</p>
<p>{<span class="apidoc_red">where did they get the hybrid server from? Maybe that should be in prerequisites?</span>}</p>
<ul>
	<li>Verify connectivity between hybrid server and Akana SaaS
	<p><strong>Note</strong>: the hybrid Gateway will call out to the Akana SaaS platform. The <span class="apidoc_red">metadata exchange service</span> mentioned under <a href="#metadata_ex_url">xxx</a> <span class="apidoc_red">#5 on page 5</span> must be accessible from the hybrid server.</p></li>
	<li>Verify file handles O/S. For instructions, see <a href="http://docs.akana.com/sp/performance-tuning.html#os-file-handles" title="http://docs.akana.com/sp/performance-tuning.html#os-file-handles">Configuring O/S File Handles</a> in the Performance Tuning doc.</li>
</ul>
<p>A sample hybrid deployment requires Akana containers for the following Akana Platform component:</p>
<ul>
	<li>Network Director</li>
</ul>


<h4 id="hybrid_01_akana_home">Akana Home</h4>
<p>All Akana software will be created in a folder which we will refer to as the <strong>{AkanaHome}</strong> folder. For example, this folder might be:</p>
<pre>/home/akana/platform84</pre>


<h4 id="hybrid_02_properties_files">Properties files</h4>
<p>In this example, we will do a <strong>silent</strong> installation. This means that it runs in the background; it does not require a GUI.</p>
<p>For silent installation, we need to create a properties file for each container. For example, <strong>ND84-1.properties</strong> represents the properties file for a single ND installation.</p>
<p>A properties file will have content similar to the following example:</p>
<pre>container.instance.name=instancename
credential.username = administrator
credential.password = password
default.host=localhost
default.port=9900</pre>
<p>For the ND container, the properties file might look something like the below:</p>
<pre>container.instance.name=ND84-1
credential.username=admin
credential.password=myPassword
default.host=0.0.0.0
default.port=9904</pre>
<p><a href="#top">Back to top</a></p>



<h3 id="hybrid_02_core">Installing the Core Platform</h3>
<p>Follow the steps below.</p>
<h5>To install the core platform</h5>
<ol>
	<li>Unzip akana-platform-linux-jre-8.4.0.zip into the <strong>Akana Home</strong> directory. After unzipping, your directory structure should look as follows:
	<p><img src="images_hybrid/hybrid_01.jpg" alt="Hybrid installation: folder structure" /></p>
	</li>
	<li>Unzip akana-platform-update-cumulative-8.4.12.zip into the same <strong>Akana Home</strong> folder.
		<p>After completing these steps, we have essentially created a basic Platform container. Additional features are made accessible to the container by uploading repositories to the container. The repositories are contained in the Akana-API-Platform zip files. These will be uploaded in the next step.</p>
	<p>Different Platform components (for example, Policy Manager or API Gateway/Network Director) require different features.</p></li>
	<li>Unzip <strong>akana-api-platform-8.4.682.zip</strong> into the same <strong>Akana Home</strong> folder.</li>
	<li>Unzip <strong>akana-api-platform-update-cumulative-8.4.15.zip</strong> into the same <strong>Akana Home</strong> folder.</li>
	<li>Optional: unzip c<strong>om.akana.activity.headers_8.4.0.zip</strong> and <strong>com.akana.activity.normalize_8.2.0.zip</strong> into the same <strong>Akana Home</strong> folder.</li>
	<li>Go to the {AkanaHome}/bin directory. Here, run the configurator using the following command (we recommend that you manually type, rather than copy, this command). {<span class="apidoc_red">why?</span>}
<pre>./startup.sh configurator –Dsilent=true –Dproperties={your ND properties file}</pre>
	<p>Example:</p>
	<pre>./startup.sh configurator -Dsilent=true -Dproperties=/home/akana/properties/ND84-1.properties</pre></li>
	<li>Once the configurator has finished, your <strong>Akana Home</strong> folder will show the created instance in the /{AkanaHome}/instances folder.</li>
	<li>Start the container by running the following command:
	<pre>./startup.sh {MyInstanceName} -bg</pre>
	<p>Once started, you should be able to access the Akana Administration Console for the container through this URL:</p>
	<pre>http://{my hostname}:9904/admin</pre>
	<p>The Console will be accessible using the credentials specified in the properties file that was used to configure the container (for example, <strong>admin / myPassword</strong>).</p></li>
	<li>In the Console, go to the <strong>Repository</strong> tab. It should show the <strong>Akana Platform Repository</strong> and <strong>Akana API Platform Repository</strong>, as shown below (page refresh may be needed):
		<p><img src="images_hybrid/hybrid_02.jpg" alt="Hybrid installation: Repository features" /></p>
		<p>Note: the version numbers show will differ from the ones shown above.</p></li>
	</ol>
<p>We will now start by installing the features required for the hybrid ND container.</p>
<p><a href="#top">Back to top</a></p>



<h3 id="hybrid_03_nd">Configuring the Network Director (ND)</h3>
<p>To add one or multiple Network Director instances, you'll need to repeat part of the steps as described in the previous section.</p>
<ol>
	<li>Make sure you have created the required properties file or files. Verify that the properties files use a distinct port number each (for instance, 9904 and 9905, respectively).</li>
	<li>Go to the {AkanaHome}/bin directory. Run the configurator using the following command:
		<pre>./startup.sh configurator –Dsilent=true –Dproperties={your ND84-1 prop file}</pre></li>
	<li>Once the configurator has finished, your <strong>Akana Home</strong> folder will show the created instance in the /{AkanaHome}/instances folder.</li>
	<li>Start the container by running the following command:
		<pre>./startup.sh {MyInstanceName} -bg</pre>
		<p>Once started, you should be able to access the Akana Administration Console for the container:</p>
		<pre>http://{my hostname}:9904/admin</pre>
	<p>The Console will be accessible using the credentials specified in the properties file that was used to configure the container (for example, admin / password).</p></li>
	
	<li id="metadata_ex_url">Install the necessary features. For a Network Director container, the essential feature is <strong>Network Director</strong>. Select this feature and run the installer. Once done, you will be prompted for feature configuration.
	<p>When prompted for the <strong>Meta Data Exchange Service</strong>, provide the following URL:</p>
	<pre>https://platform-eu.apiportal.akana.com/wsmex</pre></li>
	<li>Configuration will be completed by installing some additional plug-ins. The following Plug-ins have to be installed (through ND Admin Console – in the dropdown on the Available Features tab, select <strong>Plug-ins</strong> rather than <strong>Features</strong>):
		<ul>
			<li>Akana API Platform ND Extensions Feature</li>
			<li>Optional: Akana Headers Activity Runtime Plugin</li>
			<li>Optional: Akana Normalize Activity Runtime Plugin</li>
		</ul>
	<p>Restart the container.</p></li>
	<li>One final configuration step: in ND Admin Console, go to the <strong>Configuration</strong> tab and look for the Configuration Category <strong>com.soa.monitor.usage</strong>. Click <strong>Category</strong> and change two properties, as shown below:
		<ul>
			<li>Set <strong>usage.local.writer.enabled</strong> to <strong>false</strong>.</li>
			<li>Set <strong>usage.remote.writer.enabled</strong> to <strong>true</strong>.</li>
		</ul>
		<p><img src="images_hybrid/hybrid_03.jpg" alt="Hybrid installation: setting properties" /></p>
	</li>
	<li>Click <strong>Apply Changes</strong>.</li>
	</ol>
<p>Once the above steps are completed, the ND container is ready to be registered with the SaaS Platform.</p>
<p>If applicable, repeat the above steps to configure an additional ND container.</p>
<p><a href="#top">Back to top</a></p>



<h3 id="hybrid_install_register_nd">Registering ND with the Akana SaaS Platform</h3>
<p>The ND container configured above can be added as an API Gateway through the API Portal (Site Admin privileges required).</p>
<ol>
	<li>Once logged in, click the vertical ellipsis icon and choose <strong>Admin</strong>. In the left-side navigation menu, click <strong>API Gateways</strong>.</li>
	<li>Click <strong>Register API Gateway</strong>. Provide a meaningful name; for example, <strong>Hybrid-1</strong>. In the <strong>Metadata Auto-Discovery</strong> field, provide the following URL value, substituting valid hostname and port:
		<pre>http://{my hostname}:{my port}/metadata</pre>
	<p>Hostname and port refer to the host where ND container has been configured and port the process is listening on.</p>
	<p>You can verify the contents of the metadata file by accessing this URL through a browser. It should return an XML file with container metadata.</p></li>
	<li>Save the API Gateway configuration.
	<p><strong>Note</strong>: the API Gateway can be configured with a lat-long value in order to have the Deployment Zone associated with this Gateway appear on its proper location in the ap widget (without this step, the Deployment Zone will appear as <strong>Unknown Location</strong>).</p></li>
	<li>Next, go to <strong>Deployment Zones</strong> in the left nav and click <strong>Add</strong>. Provide a meaningful Deployment Zone name and optional description. In the <strong>API Gateway</strong> drop-down list, select the API Gateway that was added in the above steps. Keep the other default settings and save the Deployment Zone.</li>
	<li>By default, the HTTP listener generated for the API Gateway configuration will show an internal IP representation. Usually, it is preferable to replace this with the DNS hostname of the server that the Gateway is deployed on.
	<p>To modify the listener hostname, navigate through Admin->API Gateways->{ my added API Gateway }. On the API Gateway details page, navigate to the Inbound Listeners section and click <strong>Edit</strong>. Click the listener you'd like to update and click <strong>Edit</strong> again. In the <strong>Edit Listener</strong> page, modify the <strong>Hostname</strong> property (for example, replace the <strong>internal IP</strong> value with the DNS hostname); also, add a forward slash (/) to the Context Path property and click <strong>Save</strong>.</p></li>
	<li>If applicable, repeat the above step to register additional ND nodes.</li>
</ol>
<p><a href="#top">Back to top</a></p>



<h3 id="hybrid_appx_proxy_server">Appendix 1: using a proxy server for API Gateway call-out</h3>
<p>Use case: customer using a proxy server for outgoing traffic. In this case, the Gateway will have to be configured to use the proxy server to call-out to the Akana Cloud.</p>
<p>Summary:</p>
<ol>
	<li>Create two cfg files (with AND without <strong>:443</strong>).
<p>Example 1, <strong>com.soa.http.proxy-portno.cfg</strong>:</p>
	<pre>url=https://platform-eu.apiportal.akana.com
proxy=https://proxy.customer.local:8880</pre>
	<p>Example 2, <strong>com.soa.http.proxy-portyes.cfg</strong>:</p>
	<pre>url=https://platform-eu.apiportal.akana.com:443
	proxy=https://proxy.customer.local:8880</pre>
	<p>This example includes two fles because some platform services have :443 explicitly in the URL, whereas others (or perhaps only wsmex) do not. <span class="apidoc_red"><strong>Seems ND matches the literal url string</strong></span><strong>?</strong></p></li>
	<li>Place these files in the <strong>{ND instance directory}/deploy</strong> folder.
<p>This will give you the <strong>com.soa.http.proxy property</strong> in the ND admin console (instructing ND to use the proxy for given hosts). ND should now be able to access the required Platform services through the proxy.</p></li>
</ol>
<p><a href="#top">Back to top</a></p>



<div class = "divider1"></div>



<h3 id="related_topics">Related Topics</h3>
<div class="relatedlinks">
<ul>
	<li><a href="installing_akana_api_platform_v84.htm">Installing the Akana API Platform 8.4x</a></li>
	<li><a href="install_cm_jython_script.htm">Installation Jython Script</a></li>
	<li><a href="implementation_planning.htm">Planning Your Implementation</a></li>
</ul>
<ul>
	<li><a href="installing_akana_api_platform_v82.htm">Installing the Akana API Platform 8.2x</a></li>
	<li><a href="installing_akana_platform.htm">Installing Akana Platform 8.x</a></li>
	<li><a href="installing_policy_manager_v80.htm">Installing Policy Manager 8.x</a></li>
</ul>
</div>