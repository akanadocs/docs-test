---
layout: page
title: Monitoring the health of a container
description: Learn how to use the Akana System Health tool to monitor container health.
product: sp
category: learn
weight: 6
sub-nav-class: Monitoring
type: page
nav-title: System Health Tool
---
<h2 id="top">Monitoring the Health of a Container: Akana System Health Tool</h2>
<p>This technical note provides information about the Akana System Health tool and its associated API.</p>


<p><a href="using_admin_console.htm" class="button secondary">Using Admin Console</a>  
<a href="../container_management/container_management.htm" class="button secondary">Managing Containers</a></p>


<h5 class="stamp">Supported Platforms: 8.2 and later</h5>


<div class = "divider1"></div>
<h3 style="color: gray;">Table of Contents</h3>
<ol class="table_of_contents">
	<li><a href="#summary">Summary</a></li>
	<li><a href="#configuration">Configuration</a></li>
	<li><a href="#panels">Panels</a></li>
	<li><a href="#settings">Settings</a></li>
	<li><a href="#system_health_tool_api">System Health Tool API</a></li>
	<li><a href="#links">System Health Tool API: Links</a></li>
	<li><a href="#thresholds">Thresholds</a></li>
	<li><a href="#checking_health_stats">Checking Health Statistics</a></li>
	<li><a href="#custom_panel">Custom Panel</a></li>
	<li><a href="#next">What's Next?</a></li>
</ol>
<div class = "divider1"></div>



<a name="summary"></a><h3>Summary</h3>
<p>Before API Platform version 8.2, container health statistics were only available visually through the Monitoring Tool (see <a href="using_admin_monitoring_tool.htm" title="monitoring tool">Using the Admin Monitoring Tool</a>). 
Since these statistics were only available through the GUI, there was no way to use the data for operational use. With the introduction of the System Health Tool in version 8.2, you can now retrieve these health statistics by making a GET call to any Akana container. In addition, the System Health Tool allows thresholds to be configured for any monitored attributes, providing the means to get information on any values that fall outside normal or expected ranges.</p>
<p>This is a feature of the core platform and can be leveraged by all containers, including Policy Manager, Community Manager, and Envision. A primary use case for this tool is to check the health of the container to determine if it is ready to handle traffic.</p>
<p>The health statistics available are the same as the Monitoring Tool, which means that any standard OSGi <a href="https://osgi.org/javadoc/r4v42/org/osgi/service/monitor/Monitorable.html">Monitorable</a> instance in the system can be tracked, including but not limited to:</p>
<ul>
<li>Outgoing HTTP connection pool statistics</li>
<li>Incoming HTTP thread pools</li>
<li>Database connection pools</li>
<li>Container memory usage</li>
<li>Usage monitoring queues</li>
<li>JMS connections</li>
<li>Container configuration state</li>
<li>Container lifecycle</li>
</ul>
<p><a href="#top">Back to top</a></p>



<a name="configuration"></a><h3>Configuration</h3>
<p>All 8.2 containers will have the System Health Tool installed when any of the PM, CM, or ND features are installed. No additional configuration is required.</p>
<p>You can start exploring this feature through the <strong>Health</strong> tab in the Akana Administration Console:</p>
<p><img src="images/health_screenshot_1.png" alt="Health tab" /></p>
<p><a href="#top">Back to top</a></p>



<a name="panels"></a><h3>Panels</h3>
<p>A panel is a grouping of various types of system health information. Each panel can have any combination of types of system health information that you want to monitor.</p>
<p>Depending on the features installed, the <strong>Health</strong> tab will include a number of pre-configured panels. You can expand them to view detailed monitoring information, as shown below.</p>
<p><img src="images/health_screenshot_3.png" alt="detailed monitoring information" /></p>
<p><a href="#top">Back to top</a></p>



<a name="settings"></a><h3>Settings</h3>
<p>The slider in the top right corner allows you to change the frequency of the polling interval.  In addition, each panel has a toggle to enable or disable authentication when accessing the 
System Health Tool API using the links provided.</p>
<p><img src="images/health_screenshot_2.png" alt="settings" /></p>
<p><a href="#top">Back to top</a></p>



<a name="system_health_tool_api"></a><h3>System Health Tool API</h3>
<p>You can access the API by usinga GET method on <strong>/admin/health</strong> context for any Akana container. For example, if the container Akana Administration Console URL is <strong>http://acme.akana.com:9900/admin</strong>, the URL for the System Health Tool API is <strong>http://acme.akana.com:9900/admin/health</strong>.</p>
<p>A sample response is shown below.</p>
<h4>System Health API: Response</h4>
<pre>{
  "links": [
    {
      "rel": "self",
      "href": "http://acme.akana.com:9905/admin/health/"
    },
    {
      "rel": "measurables",
      "href": "http://acme.akana.com:9905/admin/health/measurables"
    },
    {
      "rel": "available",
      "href": "http://acme.akana.com:9905/admin/health/available"
    }
  ],
  "measurables": [
    {
      "id": "akana.system.health",
      "name": "System Health",
      "path": "akana.system.health",
      "state": "NORMAL",
      "childCount": 2,
      "editable": false,
      "options": {
        "enableAuth": false,
        "links": [
          {
            "rel": "self",
            "href": "http://acme.akana.com:9905/admin/health/measurables/akana.system.health/configuration"
          }
        ]
      },
      "links": [
        {
          "rel": "self",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.system.health"
        },
        {
          "rel": "brief",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.system.health?brief=true"
        },
        {
          "rel": "children",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.system.health/children"
        },
        {
          "rel": "options",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.system.health/configuration"
        },
        {
          "rel": "values",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.system.health/values"
        }
      ]
    },
    {
      "id": "akana.service.container.readiness",
      "name": "Service Container Readiness",
      "path": "akana.service.container.readiness",
      "state": "NORMAL",
      "childCount": 6,
      "editable": false,
      "options": {
        "enableAuth": false,
        "links": [
          {
            "rel": "self",
            "href": "http://acme.akana.com:9905/admin/health/measurables/akana.service.container.readiness/configuration"
          }
        ]
      },
      "links": [
        {
          "rel": "self",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.service.container.readiness"
        },
        {
          "rel": "brief",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.service.container.readiness?brief=true"
        },
        {
          "rel": "children",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.service.container.readiness/children"
        },
        {
          "rel": "options",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.service.container.readiness/configuration"
        },
        {
          "rel": "values",
          "href": "http://acme.akana.com:9905/admin/health/measurables/akana.service.container.readiness/values"
        }
      ]
    }
  ]
}</pre>
<p>This provides an overview of the available health monitors (named <strong>measurables</strong>), and a set of links that provide access to more detailed information. Each of the measurables in the response corresponds to a monitoring panel shown on the Akana Administration Console.</p>
<p><a href="#top">Back to top</a></p>



<a name="links"></a><h3>System Health Tool API: Links</h3>
<p>You can follow each of the links on the response to view different health dimensions as well as the configuration info.</p>
<p>For example, to get detailed information on the <strong>akana.system.health</strong> category, you would perform a HTTP GET using the <strong>self</strong> link. In the above example, the link is <strong>http://acme.akana.com:9900/admin/health/measurables/akana.system.health</strong>.</p>
<p>Or, for example, if you want to view all the available configurable options, you can fetch <strong>http://acme.akana.com:9900/admin/health/available</strong>.</p>
<p><a href="#top">Back to top</a></p>



<a name="thresholds"></a><h3>Thresholds</h3>
<p>Each health monitor may have a set of threshold settings. These settings are used to indicate current health status using three values: <strong>NORMAL</strong>, <strong>WARNING</strong>, or <strong>FAILURE</strong>.</p>
<p>System default health monitors have the threshold ranges predefined. To view or modify the values, go to the Akana Administration Console and click the status icon, as shown below.</p>
<p><img src="images/health_screenshot_5.png" alt="warning threshold" /></p>
<p>Thresholds are defined using the Apache Java Expression Language syntax. For more information, refer to <a href="http://commons.apache.org/proper/commons-jexl/reference/syntax.html">the JEXL definition on the Apache Commons site</a>. Currently, only a single variable named <strong>value</strong> is accessible, which is the current value of the monitored property.</p>
<p><a href="#top">Back to top</a></p>



<a name="checking_health_stats"></a><h3>Checking Health Statistics</h3>
<p>You can check the system health information by following the links provided in the health monitor's panel.</p>
<p>An example of how you can use this feature is to provide load balancers with an appropriate status based on the health of any aspect of container operation.</p>
<p><img src="images/health_screenshot_4.png" alt="links" /></p>

<h4 id="checking_health_stats_resp_eg">Checking Health Statistics: Response</h4>
<pre>{
  "id": "akana.service.container.readiness",
  "name": "Service Container Readiness",
  "path": "akana.service.container.readiness",
  "state": "NORMAL",
  "childCount": 6,
  "editable": false,
  "options": {
    "enableAuth": true,
    "links": [
      {
        "rel": "self",
        "href": "http://localhost:9905/admin/health/measurables/akana.service.container.readiness/configuration"
      }
    ]
  },
  "links": [
    {
      "rel": "self",
      "href": "http://localhost:9905/admin/health/measurables/akana.service.container.readiness"
    },
    {
      "rel": "brief",
      "href": "http://localhost:9905/admin/health/measurables/akana.service.container.readiness?brief=true"
    },
    {
      "rel": "children",
      "href": "http://localhost:9905/admin/health/measurables/akana.service.container.readiness/children"
    },
    {
      "rel": "options",
      "href": "http://localhost:9905/admin/health/measurables/akana.service.container.readiness/configuration"
    }
  ]
}</pre>


<h4 id="checking_health_define_resp_code">Using query parameters to define the HTTP response status code</h4>
<p>If the health category is NORMAL, WARNING, or FAILURE, you can use an optional set of query parameters to control the HTTP status code returned for each of the thresholds. This avoids the need to parse the JSON response content, allowing decisions to be made solely on the response code.</p>
<p>The following query parameters are valid for specifying response HTTP status when you run the GET operation on the health category:</p>
<ul>
	<li>normal-status</li>
	<li>warning-status</li>
	<li>failure-status</li>
</ul>
<p>Example: <strong>GET http://acme.akana.com:9900/admin/health/measurables/akana.system.health?normal-status=200&amp;warning-status=217&amp;failure-status=230</strong>.</p>
<p><a href="#top">Back to top</a></p>



<a name="custom_panel"></a><h3>Custom Panel</h3>
<p>To display a custom set of system health statistics, you can create your own panel. To create a new panel, click the <strong>plus</strong> icon. Once the panel has been created, you can then add your own combination of health monitors.</p>
<p>The sample custom panel below is configured on the Policy Manager container and is called <strong>Health Monitoring for ACME</strong>. The failure threshold is set to anything below the currently provisioned number of PM APIs.</p>
<p>The threshold below defines a normal condition where there is greater than 20% of capacity remaining in the pool.</p>
<p><img src="images/health_screenshot_6.png" alt="links" /></p>
<p>The threshold below defines a warning condition where between 20% and 5% of capacity remains in the pool.</p>
<p><img src="images/health_screenshot_7.png" alt="links" /></p>
<p>The threshold below defines a failure condition when less than 5% of capacity remains in the pool.</p>
<p><img src="images/health_screenshot_8.png" alt="links" /></p>
<p>To check the status of this custom panel, you would simply follow the links provided, which in this case might be 
<strong>http://acme.akana.com:9900/admin/health/measurables/health.monitoring.for.acme</strong>.</p>
<p><a href="#top">Back to top</a></p>



<a name="next"></a><h3>What's Next?</h3>
<p>Container health data can be polled and collected into a data store. You can use the collected data to gain valuable operational insight.</p>
<p><a href="#top">Back to top</a></p>