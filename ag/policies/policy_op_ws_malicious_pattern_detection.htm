---
layout: page
title: WS-Malicious Pattern Detection Policy
description: Learn about the WS-Malicious Pattern Detection Policy and policy configuration options.
product: ag
category: learn
sub-nav-class: Policies - Operational
weight: 04
type: page
nav-title: WS-Malicious Pattern Detection
---
<h2 id="top">Using the WS-Malicious Pattern Detection Policy</h2>
<p>Learn about the WS-Malicious Pattern Detection Policy and policy configuration options.</p>

<p>
<a href="about_policies_view.htm" class="button secondary">About Policies</a>  
<a href="policy_management.htm" class="button secondary">Managing Policies</a>  
<a href="policies_operational_about.htm" class="button secondary">About Operational Policies</a>
</p>



<div class = "divider1"></div>



<h3 style="color: gray;">Table of Contents</h3>
<ol class="table_of_contents">
	<li><a href="#ws_malicious_pattern_detection_policy_about">About the WS-Malicious Pattern Detection policy</a></li>
	<li><a href="#ws_malicious_pattern_detection_policy_create">Creating a WS-Malicious Pattern Detection policy</a></li>
	<li><a href="#ws_malicious_pattern_detection_policy_config">Configuring a WS-Malicious Pattern Detection policy</a></li>
	<li><a href="#ws_malicious_pattern_detection_policy_view">Viewing a WS-Malicious Pattern Detection policy</a></li>
<li><a href="#policy_attach">Attaching the policy</a></li>
	<li><a href="#examples">Examples: out-of-the-box SOAP XPath Injection policy</a></li>
</ol>
<div class = "divider1"></div>



<h3 id="ws_malicious_pattern_detection_policy_about">About the WS-Malicious Pattern Detection policy</h3>
<p>The WS-Malicious Pattern Detection policy is very similar to the HTTP Malicious Pattern Detection policy, but it is tailored for SOAP messages. In particular, the SOAP body and SOAP headers can be handled differently. You can use the WS-Malicious Pattern Detection policy for SOAP message (transmitted over HTTP), but the envelope has no special meaning and would be treated as any XML content.</p>
<p><a href="#top">back to top</a></p>



<h3 id="ws_malicious_pattern_detection_policy_create">Creating a WS-Malicious Pattern Detection policy</h3>
<p>The first step in creating a policy is to define the basic policy information. Then, you can configure the policy details.</p>
<h5>To add an operational policy</h5>
<ol>
<li>Go to <strong>Workbench</strong> &gt; <strong>Browse</strong> &gt; <strong>Organization</strong>, and select <strong>Policies</strong> &gt; <strong>Operational Policies</strong>. The <strong>Policies Summary</strong> is displayed.</li>
<li>Click <strong>Add Policy</strong>.</li>
<li>Choose the policy type and click <strong>Next</strong>.</li>
<li>Specify a name (required) and description (optional) and click <strong>Finish</strong>. At the <strong>Completion Summary</strong>, Click <strong>Close</strong>. The <strong>Add Policy</strong> Wizard creates a draft policy instance that you can then configure on the <strong>Policy Details</strong> page.</li>
</ol>
<p>For more information, see <a href="policy_management.htm#add_policy">Add Policy</a>.</p>
<p><a href="#top">back to top</a></p>



<h3 id="ws_malicious_pattern_detection_policy_config">Configuring a WS-Malicious Pattern Detection Policy</h3>
<p>The <strong>Modify WS-Malicious Pattern Detection Policy</strong> screen allows you to modify the required content options for the WS-Malicious Pattern Detection policy.</p>
<h5 id="h">To configure a WS-Malicious Pattern Detection policy</h5>
<ol>
<li>Go to <strong>Workbench</strong> &gt; <strong>Browse</strong> &gt; <strong>Organization</strong> and select the <strong>Policies</strong> &gt; <strong>Operational Policies</strong> folder. The <strong>Policies Summary</strong> is displayed.</li>
<li>Find the policy on the list and double-click to go to the <strong>Details</strong> page for the policy.</li>
<li>In the second panel, click <strong>Modify</strong> to access the <strong>Modify WS-Malicious Pattern Detection Policy</strong> page, as shown below.
<p><img src="images/ws_malicious_pattern_detection_02_modify.jpg" alt=""/></p>
</li>
<li>Specify values. For information about the fields, refer to <a href="#ws_malicious_pattern_detection_policy_options">WS-Malicious Pattern Detection policy options</a> below.</li>
<li>When done, click <strong>Apply</strong>.</li>
</ol>
<p><a href="#top">Back to top</a></p>
<h3 id="ws_malicious_pattern_detection_policy_options">WS-Malicious Pattern Detection policy options</h3>
<p>The <strong>Modify WS-Malicious Pattern Detection Policy</strong> wizard has only one page. It includes the options listed below.</p>
<dl>
<dt>Inspect Binding Headers</dt>
<dd>Optionally, SOAP headers can be scanned for patterns. By default, if you select this option, all headers will be scanned. To scan only certain headers, add the header names in the table.</dd>
<dt>Exclude Markup</dt>
<dd>If markup is excluded only the content of the properties, not the markup itself, will be scanned. For example, an XML tag will not be scanned, just the tag's value.</dd>
<dt>Patterns</dt>
<dd>One or more regular expression patterns to scan for. Any match will cause the message to be rejected. For more information about using regular expressions, see <a href="policy_management.htm#policies_regex">Using Regular Expressions in Policies</a>.</dd>
</dl>
<p><a href="#top">back to top</a></p>



<h3 id="ws_malicious_pattern_detection_policy_view">Viewing WS-Malicious Pattern Detection Policy Details</h3>
<h5>To view the WS-Malicious Pattern Detection policy details:</h5>
<ol>
<li>Go to <strong>Workbench</strong> &gt; <strong>Browse</strong> &gt; <strong>Organization</strong>, and select <strong>Policies</strong> &gt; <strong>Operational Policies</strong>. The <strong>Policies Summary</strong> is displayed.</li>
<li>Find the policy on the list and double-click to go to the <strong>Details</strong> page for the policy. An example is shown below.
<p><img src="images/ws_malicious_pattern_detection_01.jpg" alt=""/></p>
</li>
</ol>
<p><a href="#top">Back to top</a></p>



<h3 id="policy_attach">Attaching the policy</h3>
<p>To use the policy, go to the <strong>Policies</strong> folder in the Root Organization and attach the policy to a web service, binding, or binding operation.</p>
<p><a href="#top">Back to top</a></p>



<h3 id="examples">Examples: out-of-the-box SOAP XPath Injection policy</h3>
<p>The following examples illustrate an out-of-the-box SOAP XPath Injection policy which is an application of the WS-Malicious Pattern Detection policy.</p>
<h5>Regular Expressions:</h5>
<p>In the example below, the regular expression matches XPath symbols.</p>
<p><img src="images/ws_malicious_pattern_detection_03_reg_expression.jpg" alt=""/></p>
<p>For more information about using regular expressions, see <a href="policy_management.htm#policies_regex">Using Regular Expressions in Policies</a>.</p>

<h5>SQL Expressions:</h5>
<p>A SOAP SQL detection policy is also included out-of-the-box. Its expressions match SQL symbols and keywords, as shown below.</p>
<p><img src="images/ws_malicious_pattern_detection_04_sql_expression.jpg" alt=""/></p>
<p><a href="#top">Back to top</a></p>



<div class = "divider1"></div>



<h3 id="related_topics">Related Topics</h3>
<div class="relatedlinks">
<ul>
	<li><a href="about_policies_view.htm">About Policies</a></li>
	<li><a href="policy_management.htm">Managing Policies</a></li>
	<li><a href="policies_operational_about.htm">About Operational Policies</a></li>
</ul>
<ul>
	<li><a href="../../cm/learnmore/basics_glossary.htm">Glossary of Terms for the Developer Portal</a></li>
</ul>
</div>