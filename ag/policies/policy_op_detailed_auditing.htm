---
layout: page
title: Using the Detailed Auditing Policy
description: Learn how to audit messages and record the message metrics in the Monitoring Logs tab as well as messages of each exchange.
product: ag
category: learn
sub-nav-class: Policies - Operational
weight: 26
type: page
nav-title: Detailed Auditing
---
<h1 id="top">Using the Detailed Auditing Policy</h1>
<p>Learn how to enable detailed auditing of message size, bindings, and contracts.</p>
<p>For information about using policies in the context of the Community Manager developer portal, see <a href="../../cm/learnmore/bus_admin_organizations.htm#h_business_policies">Business Policies</a>.</p>
<p class="Note"><strong>Note</strong>: The difference between the Basic Auditing and Detailed Auditing policies is that the Detailed Auditing policy captures the payload, and the Basic Auditing policy does not.</p>
<hr class="divide_hr" />



<h2 style="color: gray;">Table of Contents</h2>
<ol class="table_of_contents">
	<li><a href="#introduction">Introduction</a></li>
	<li><a href="#detailed_auditing_policy_create">Creating a Detailed Auditing Policy</a></li>
	<li><a href="#detailed_auditing_config">Configuring the Detailed Auditing Policy</a></li>
	<li><a href="#policy_activating">Activating a policy</a></li>
	<li><a href="#policy_attach">Attaching a policy</a></li>
	<li><a href="#uc_policy_op_detailed_auditing_pm">Detailed Auditing Policy: use cases</a>
		<ol>
			<li><a href="#uc_policy_op_detailed_auditing_pm_01">Detailed Auditing: Audit Entire Message and Message Metrics</a></li>
			<li><a href="#uc_policy_op_detail_aud_failure_basic_aud_success">Detailed Auditing on failure, Basic Auditing on success</a></li>
		</ol>
	</li>
</ol>
<hr class="divide_hr" />



<h2 id="introduction">Introduction</h2>
<p>The Detailed Auditing Policy is an out-of-the-box policy that is part of the Policy Manager default installation. It is an instance of the Auditing Service Policy. It provides detailed auditing of messages and records the message metrics in the <strong>Monitoring</strong><em> &gt; </em><strong>Logs</strong> tab as well as the messages of each exchange. The policy is located in the <strong>Policies</strong> folder of the root organization.</p>
<p class="Note"><strong>Note</strong>: In versions prior to 2019.0.0, the platform did not support attaching multiple auditing policies to a service or API; for example, <a href="policy_op_basic_auditing.htm">Basic Auditing</a> policy or <a href="policy_op_detailed_auditing.htm">Detailed Auditing</a> policy. In 2019.0.0 and later you can set up Basic Auditing for successful messages and Detailed Auditing for error conditions.</p>
<p>The following message metrics are recorded:</p>
<ul>
	<li><strong>Input Message</strong>: Audits Input Message content.</li>
	<li><strong>Output Message</strong>: Audits Output Message content.</li>
	<li><strong>Fault Message</strong>: Audits Fault Message content.</li>
	<li><strong>Message Size</strong>: Audits the size of messages in the exchange.</li>
	<li><strong>Binding</strong>: Audits binding information.</li>
	<li><strong>Transport</strong>: Audits 	 Transport information.</li>
	<li><strong>Contract</strong>: Audits the contract governing a message.</li>
</ul>
<p>The following identities are audited:</p>
<ul>
	<li><strong>Consumer</strong>: Audits consumer identity sent with a request message.</li>
	<li><strong>End User</strong>: Audits end-user identity sent with a request message.</li>
</ul>
<p><a href="#top">Back to top</a></p>



<h2 id="detailed_auditing_policy_create">Creating a Detailed Auditing Policy</h2>
<p>The first step in creating a policy is to define the basic policy information.</p>
<h4>To add an operational policy</h4>
<ol>
<li>Go to <strong>Workbench</strong> &gt; <strong>Browse</strong> &gt; <strong>Organization</strong>, and select <strong>Policies</strong> &gt; <strong>Operational Policies</strong>. The <strong>Policies Summary</strong> is displayed.</li>
<li>Click <strong>Add Policy</strong>.</li>
<li>Choose the policy type and click <strong>Next</strong>.</li>
<li>Specify a name (required) and description (optional) and click <strong>Finish</strong>. At the <strong>Completion Summary</strong>, click <strong>Close</strong>. The <strong>Add Policy</strong> Wizard creates a draft policy instance that you can then configure on the <strong>Policy Details</strong> page.</li>
</ol>
<p>For more information, see <a href="policy_management.htm#add_policy">Add Policy</a>.</p>
<p>At this point, you've created the policy, but it doesn't do anything. The next step is to configure the policy details. See <a href="#detailed_auditing_config">Configuring a Detailed Auditing Policy</a> below.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="detailed_auditing_config">Configuring the Detailed Auditing Policy</h2>
<p>Once you've created the policy, you can configure the policy details that determine how the policy works. Then you can activate the policy so that it can be used.</p>

<h4>To configure a Detailed Auditing policy in Policy Manager</h4>
<ol>
	<li>In the Organization Tree, find the level where the policy was defined. Click to select.</li>
	<li>In the center pane, in the <strong>Auditing Service Policy</strong> section, click <strong>Modify</strong>. The <strong>Modify Auditing Service Policy</strong> overlay is displayed, as shown below.
		<p><img src="images/detailed_auditing_modify_2018.jpg" alt="Modify Auditing Service Policy" /></p>
	</li>
	<li>Specify values as needed, such as specific transport headers to exclude.
	<p class="Note"><strong>Note</strong>: For explanations of the individual fields, see <a href="policy_op_auditing_service.htm#auditing_service_policy_config">Configuring an Auditing Service Policy</a>. The Basic Auditing Policy and Detailed Auditing Policy are both pre-configured out-of-the-box instances of the Auditing Service Policy that are part of the default installation.</p></li>
	<li>Click <strong>Apply</strong>.</li>
</ol>
<p>Now that the policy is defined, you can activate it and start using it. On the right, under <strong>Actions</strong>, choose <strong>Activate Policy</strong>.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="policy_activating">Activating a policy</h2>
<p>When you create and configure a policy, the policy is in <strong>Draft</strong> state. When the policy configuration is complete, activate the policy: click <strong>Activate Policy</strong> and then confirm. See <a href="policy_management.htm#policy_activate">Activate a Policy</a>.</p>
<p>A policy in Draft state is not available for general use. Once you activate the policy, it is in <strong>Active</strong> state and is available for use.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="policy_attach">Attaching a policy</h2>
<p>To use the Detailed Auditing Policy, go to the <strong>Policies</strong> folder in the respective organization and attach the policy to a web service, binding, or binding operation. Then, go to the <strong>Services</strong><em> &gt; </em><strong>Monitoring</strong> section to view the results for Logs, Real Time Charts, and Historical Charts.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="uc_policy_op_detailed_auditing_pm">Detailed Auditing Policy: use cases</h2>
<p>This section includes the following usage scenario for the Detailed Auditing Policy:</p>
<ul>
	<li><a href="#uc_policy_op_detailed_auditing_pm_01">Detailed Auditing: Audit Entire Message and Message Metrics</a></li>
	<li><a href="#uc_policy_op_detail_aud_failure_basic_aud_success">Detailed Auditing on failure, Basic Auditing on success</a></li>
</ul>


<h3 id="uc_policy_op_detailed_auditing_pm_01">Detailed Auditing: Audit Entire Message and Message Metrics</h3>
<p>Audit entire message and message metrics of each exchange in usage logs of Monitoring tab.</p>
<ol>
	<li>Create a physical service in the <strong>Policy Manager Management Console</strong> using <strong>Create Physical Service</strong>.</li>
	<li>Provide service details and finish the wizard.</li>
	<li>Using <strong>Virtualize Service</strong>, virtualize and host the physical service on Network Director (<strong>ND1</strong>), and assign a name (for example, <strong>Vs1</strong>).</li>
	<li>Attach the Detailed Auditing Policy located in the Root Organization Policies folder to the Vs1 service in <strong>Service Details</strong> &gt; <strong>Policy Attachments</strong> &gt; <strong>Operational Policies</strong>.</li>
	<li>Send requests from the application/client to the Vs1 service.</li>
	<li>The details of the usage logs show the recorded information for each exchange.
	<p><img src="images/detailed_auditing_uc_pm_01.jpg" alt="Detailed Auditing policy use case: log details" /></p>
	<p>The fields that are recorded in each exchange are:</p>
		<ol>
			<li>Message Size</li>
			<li>Input Message</li>
			<li>Output Message</li>
			<li>Fault Message</li>
			<li>Transport</li>
			<li>Contract</li>
			<li>Binding</li>
			<li>Identities: Consumer/End-User</li>
		</ol>
		<p><img src="images/detailed_auditing_uc_pm_02.jpg" alt="Detailed Auditing policy use case: Usage Detail tab" /></p>
</li>
</ol>
<p><a href="#top">Back to top</a></p>


<h3 id="uc_policy_op_detail_aud_failure_basic_aud_success">Detailed Auditing on failure, Basic Auditing on success</h3>
<h4 class="stamp">Valid in Version: 2019.0.0 and later</h4>
<p>In versions prior to 2019.0.0, the platform did not support attaching multiple auditing policies to a service or API; for example, <a href="policy_op_basic_auditing.htm">Basic Auditing</a> policy or <a href="policy_op_detailed_auditing.htm">Detailed Auditing</a> policy. In 2019.0.0 and later you can set up Basic Auditing for successful messages and Detailed Auditing for error conditions, as shown below.</p>

<h4>Basic Auditing policy</h4>
<p>Default configuration is shown below. No changes needed.</p>
<p><img src="images/basic_auditing_uc_02_01.png" alt="Basic Auditing on Success" /></p>

<h4>Detailed Auditing</h4>
<p>In the below scenario, in the Community Manager developer portal:</p>
<ol>
	<li>Navigate to <strong>Organizations</strong> &gt; organization &gt; <strong>Policies</strong>. Choose the Detailed Auditing policy and choose <strong>Start New Version</strong>.</li>
	<li>Choose <strong>Filter Messages</strong>. The default is <strong>Exchanges resulting in an error</strong>. Save.</li>
	<li>Activate the policy.</li>
</ol>
<p>The resulting policy configuration is shown below.</p>
<p><img src="images/detailed_auditing_uc_02_02.png" alt="Detailed Auditing on Failure" /></p>
<p>Now, attach these two policies to your API.</p>
<p>With this 
	
	
	
	configuration, you'll have minimal log entries for successful messages. However, any unsuccessful messages will have all message details (subject to configuration settings).</p>
<p><a href="#top">Back to top</a></p>



<hr class="divide_hr" />



<h2 id="related_topics">Related Topics</h2>
<div class="relatedlinks">
<ul>
	<li><a href="about_policies_view.htm">About Policies</a></li>
	<li><a href="policy_management.htm">Managing Policies</a></li>
	<li><a href="policies_operational_about.htm">About Operational Policies</a></li>
</ul>
<ul>
	<li><a href="../../cm/learnmore/basics_glossary.htm">Glossary of Terms for the Community Manager developer portal</a></li>
</ul>
</div>