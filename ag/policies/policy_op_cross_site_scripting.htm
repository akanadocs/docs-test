---
layout: page
title: Using the Cross-Site Scripting Detection Policy in Policy Manager 
description: Learn how to configure a tag allowlist to protect your web service from being exploited by cross-site scripting.
product: ag
category: learn
sub-nav-class: Policies - Operational
weight: 24
type: page
nav-title: Cross-Site Scripting
---
<h1 id="top">Using the Cross-Site Scripting Detection Policy</h1>
<p>Learn how to configure a tag <a href="../../cm/learnmore/basics_glossary.htm#gl_allowlist">allowlist</a> to protect your web service from being exploited by cross-site scripting.</p>
<p>For information about using policies in the context of the Community Manager developer portal, see <a href="../../cm/learnmore/bus_admin_organizations.htm#h_business_policies">Business Policies</a>.</p>
<hr class="divide_hr" />



<h2 style="color: gray;">Table of Contents</h2>
<ul class="table_of_contents">
	<li><a href="#allowlist_introduction">Introduction</a></li>
	<li><a href="#allowlist_default_policy">Default allowlist (Default Policy)</a></li>
	<li><a href="#allowlist_configuration">Configuration</a></li>
	<li><a href="#policy_activating">Activating a policy</a></li>
	<li><a href="#policy_attach">Attaching a policy</a></li>
</ul>
<hr class="divide_hr" />



<h2 id="allowlist_introduction">Introduction</h2>
<p>The Cross-Site Scripting Detection Policy is an Operational policy that allows you to block potentially malicious HTML tags in the request message body using an <strong>allowlist</strong> of tags. Notes:</p>
<ul>
<li>The allowlist includes a list of HTML tags that will be accepted if they are found in the request message body.</li>
	<li>You can use the default allowlist (Add Default HTML tags), customize the default list, or define your own set of tags and attributes that are allowed in the request message body.</li>
	<li>If an allowlist tag is found, Network Director passes the request message to the downstream service.</li>
	<li>Make sure you do <strong>not</strong> add malicious tags to the allowlist.</li>
	<li>All tags specified in the allowlist are allowed. All other tags are disallowed. This is referred to as a <a href="../../cm/learnmore/basics_glossary.htm#gl_denylist"><strong>denylist</strong></a>.</li>
</ul>
<p>Say for example your web service includes an anchor &lt;a&gt; tag. When you attach a default Cross-Site Scripting Detection Policy to a REST service and send a request message to the Network Director container that is hosting the service, you will get an &quot;HTTP 403 Forbidden&quot; error response. This is because the &lt;a&gt; tag is not defined in the policy's allowlist.</p>
<p><a href="#top">Back to top</a></p>


<h2 id="allowlist_default_policy">Default allowlist (Default Policy)</h2>
<p>You can add a default allowlist that includes basic HTML tags such as those shown below. You can then modify the list.</p>
<p><img src="images/cross_site_scripting_default_tags.png" alt="" /></p>
<p><a href="#top">Back to top</a></p>


<h2 id="allowlist_configuration">Configuration</h2>
<p>Let's take a quick walkthrough of the Cross-Site Scripting Detection Policy configuration process to get you started.</p>

<h4>Add Policy / Use System Policy</h4>
<ul>
	<li>In Policy Manager, to create a Cross-Site Scripting Detection Policy instance, go to <strong>Policies</strong> &gt; <strong>Operational Policies</strong> and choose <strong>Add Policy</strong>.</li>
	<li>You can also use the pre-defined Cross-Site Scripting Detection Policy called <strong>AllowListedCrossSiteScripting</strong>. This is an out-of-the-box System Policy that is preconfigured with the default allowlist. You can customize the allowlist configuration to suit your needs and then attach it directly to a web service or operation.
  	<p>If you use the default configuration, all tags in the allowlist are accepted when Network Director passes the request message to the downstream service.</p>
  </li>
</ul>

<h4>Modify Policy</h4>
<p>When you click <strong>Modify</strong> to make changes to the Cross-Site Scripting Detection policy on the <strong>Policy Details</strong> page, the initial policy looks like this:</p>
<p><img src="images/cross_site_scripting_modify.png" alt="" /></p>
<p>If you use the default policy without defining an allowlist, all tags will be disallowed. If you define an allowlist, all tags in the allowlist will be accepted, and all other tags (the denylist) will be forbidden when Network Director passes the request message to the downstream service. Instead, an HTTP 404 Forbidden error will be returned.</p>

<h4>Configure allowlist / Custom Tags</h4>
<p>The next step is to define your tag allowlist. These represent tags that comprise the HTML in your request message body and that you have designated as ones that could be potentially attacked. Allowlist tags are allowed when Network Director passes the request message to the downstream service. The following options are available:</p>
<ul>
	<li>Use <strong>Add Default HTML Tags</strong> to add a default set of tags to your policy (the allowlist) and customize using the <strong>Remove Selected Row</strong> option.</li>
	<li>Use <strong>Add Tag</strong> to add a custom tag and attributes (if applicable).</li>
</ul>

<h4>Activate and Attach Policy</h4>
<p>After you've saved your policy, activate it. You can then attach it:</p>
<ul>
	<li>To an individual web service to apply it to that service</li>
	<li>At the Organization level and the policy will be active for all services defined within the organization.</li>
</ul>
<p><img src="images/attach policy.jpg" alt="" /></p>
<p><a href="#top">Back to top</a></p>



<h2 id="policy_activating">Activating a policy</h2>
<p>When you create and configure a policy, the policy is in <strong>Draft</strong> state. When the policy configuration is complete, activate the policy: click <strong>Activate Policy</strong> and then confirm. See <a href="policy_management.htm#policy_activate">Activate a Policy</a>.</p>
<p>A policy in Draft state is not available for general use. Once you activate the policy, it is in <strong>Active</strong> state and is available for use.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="policy_attach">Attaching a policy</h2>
<p>To use the policy, go to the <strong>Policies</strong> folder in the respective organization and attach the policy to a web service, binding, or binding operation.</p>
<p><a href="#top">Back to top</a></p>



<hr class="divide_hr" />



<h2 id="related_topics">Related Topics</h2>
<div class="relatedlinks">
<ul>
	<li><a href="about_policies_view.htm">About Policies</a></li>
	<li><a href="policy_management.htm">Managing Policies</a></li>
	<li><a href="policies_operational_about.htm">About Operational Policies</a></li>
</ul>
<ul>
	<li><a href="../../cm/learnmore/basics_glossary.htm">Glossary of Terms for the Community Manager developer portal</a></li>
</ul>
</div>