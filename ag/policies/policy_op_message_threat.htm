---
layout: page
title: Using the Message Threat Policy
description: Learn about using the Message Threat Policy to guard against XML-based denial of service attacks.
product: ag
category: learn
sub-nav-class: Policies - Operational
weight: 04
type: page
nav-title: Message Threat
---
<h1 id="top">Using the Message Threat Policy</h1>
<p>Learn about using the Message Threat Policy to guard against XML-based denial of service attacks.</p>
<p>For information about using policies in the context of the developer portal, see <a href="../../cm/learnmore/bus_admin_organizations.htm#h_business_policies">Business Policies</a>.</p>
<hr class="divide_hr" />



<h2 style="color: gray;">Table of Contents</h2>
<ol class="table_of_contents">
	<li><a href="#message_threat_policy_about">About the Message Threat policy</a></li>
	<li><a href="#message_threat_policy_create">Creating a Message Threat policy</a></li>
	<li><a href="#message_threat_policy_modify">Configuring a Message Threat policy</a></li>
	<li><a href="#message_threat_policy_options">Message Threat policy options</a></li>
	<li><a href="#policy_activating">Activating a policy</a></li>
	<li><a href="#policy_attach">Attaching a policy</a></li>
</ol>
<hr class="divide_hr" />



<h2 id="message_threat_policy_about">About the Message Threat policy</h2>
<p>The Message Threat Policy is used to guard against XML-based denial of service attacks. An attacker can construct XML messages in such a way that parsing them could result in overwhelming CPU and/or memory consumption. This policy can detect such situations and reject the messages immediately.</p>
<p>Configure the policy by specifying acceptable parameters that will support your usual and expected traffic while protecting your system from attackers.</p>
<p><a href="#top">back to top</a></p>



<h2 id="message_threat_policy_create">Creating a Message Threat policy</h2>
<p>The first step in creating a policy is to define the basic policy information.</p>
<h4>To add an operational policy</h4>
<ol>
	<li>Go to <strong>Workbench</strong> &gt; <strong>Browse</strong> &gt; <strong>Organization</strong>, and select <strong>Policies</strong> &gt; <strong>Operational Policies</strong>. The <strong>Policies Summary</strong> is displayed.</li>
	<li>Click <strong>Add Policy</strong>.</li>
	<li>Choose the policy type and click <strong>Next</strong>.</li>
	<li>Specify a name (required) and description (optional) and click <strong>Finish</strong>. At the <strong>Completion Summary</strong>, click <strong>Close</strong>. The <strong>Add Policy</strong> Wizard creates a draft policy instance that you can then configure on the <strong>Policy Details</strong> page.</li>
</ol>
<p>For more information, see <a href="policy_management.htm#add_policy">Add Policy</a>.</p>
<p><a href="#top">back to top</a></p>



<h2 id="message_threat_policy_modify">Configuring a Message Threat policy</h2>
<p>Once you've created the policy, you can configure the policy options.</p>
<h4>To configure a Message Threat policy</h4>
<ol>
	<li>Go to <strong>Workbench</strong> &gt; <strong>Browse</strong> &gt; <strong>Organization</strong> and select the <strong>Policies</strong> &gt; <strong>Operational Policies</strong> folder. The <strong>Policies Summary</strong> is displayed.</li>
	<li>Find the policy on the list and click to go to the pane for the Message Threat policy.</li>
	<li>In the second section, click <strong>Modify</strong>. The <strong>Modify Message Threat Policy</strong> page opens, as shown below.
		<p><img src="images/message_threat.jpg" alt=""/></p>
	</li>
	<li>Specify values for the policy as needed. For information on the individual options, see <a href="#message_threat_policy_options">Message Threat Policy Options</a> below.</li>
	<li>Save the policy definition.</li>
</ol>
<p>That completes the policy configuration. You can now assign the policy to a service.</p>
<p><a href="#top">back to top</a></p>



<h2 id="message_threat_policy_options">Message Threat policy options</h2>
<p>The <strong>Modify Message Threat Policy</strong> wizard has one page, <strong>Specify Message Threat Policy Options</strong>. It includes the options listed below.</p>

<dl>
<dt>Maximum Nested Element Depth Allowed</dt>
<dd>Maximum amount of nesting levels that the Message Threat Policy allows in messages.</dd>
<dd>In the absence of this optional sub-assertion, services are not protected against a denial of service attack through too many nested elements.</dd>


<dt>Maximum Attributes Per Element</dt>
<dd>Maximum number of attributes allowed per element in messages.</dd>
<dd>In the absence of this optional sub-assertion, services are not protected against a denial of service attack through too many nested elements. An attacker could nest XML elements to the depth of thousands, which would clog the memory and slow the processor.</dd>


<dt>Maximum Size of a Document Node</dt>
<dd>Maximum number of kilobytes that a single node in the XML DOM tree can use.</dd>
<dd>In the absence of this optional sub-assertion, services are not protected against a denial of service attack through excessive node size. An attacker could overload an XML node with a huge amount of data.</dd>


<dt>Maximum Number of Name Space Prefixes</dt>
<dd>Maximum number of namespace prefixes allowed in the message.</dd>
<dd>In the absence of this optional sub-assertion, services are not protected against a denial of service attack through having a very large number of namespace prefixes, meaning that an attacker could include hundreds or thousands of namespaces in a single XML message.</dd>


<dt>Maximum Number of Name Space Definitions</dt>
<dd>Maximum number of namespace definitions allowed per message.</dd>
<dd>In the absence of this optional sub-assertion, services are not protected against a denial of service attack through having an excessive number of namespace definitions, meaning that an attacker could overload an XML message with a huge number of namespace definitions.</dd>


<dt>Maximum Entity Size Definable in DTD</dt>
<dd>If a DTD is present (internal or external) and there are entities defined, this value limits the maximum size (number of chars) of any given entity.</dd>
<dd>In the absence of this optional sub-assertion, services are not protected against a denial of service attack through DTD entity size that is too large, meaning that an attacker could overload an internal or external DTD entity with huge value in terms of number characters.</dd>


<dt>Maximum Number of Entities That Could Be Defined</dt>
<dd>If a DTD is present (internal or external) and there are entities defined, the maximum number of entities allowed per message.</dd>
<dd>In the absence of this optional sub-assertion, services are not protected against a denial of service attack through having an excessive number of entities, meaning that an attacker could overload a message with a huge number of entities (millions).</dd>


<dt>Maximum Recursive Depth of an Entity Definition</dt>
<dd>If a DTD is present (internal or external) and there are entities defined, the maximum depth allowed recursively.</dd>
<dd>In the absence of this optional sub-assertion, services are not protected against a denial of service attack through too great a recursive depth of entities, meaning that an attacker could employ huge number of entities recursively defined with value of other entities. This could cause combinatorial explosion of entities.</dd>
</dl>
<p><a href="#top">back to top</a></p>



<h2 id="policy_activating">Activating a policy</h2>
<p>When you create and configure a policy, the policy is in <strong>Draft</strong> state. When the policy configuration is complete, activate the policy: click <strong>Activate Policy</strong> and then confirm. See <a href="policy_management.htm#policy_activate">Activate a Policy</a>.</p>
<p>A policy in Draft state is not available for general use. Once you activate the policy, it is in <strong>Active</strong> state and is available for use.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="policy_attach">Attaching a policy</h2>
<p>To use the policy, go to the <strong>Policies</strong> folder in the respective organization and attach the policy to a web service, binding, or binding operation.</p>
<p><a href="#top">Back to top</a></p>



<hr class="divide_hr" />



<h2 id="related_topics">Related Topics</h2>
<div class="relatedlinks">
<ul>
	<li><a href="about_policies_view.htm">About Policies</a></li>
	<li><a href="policy_management.htm">Managing Policies</a></li>
	<li><a href="policies_operational_about.htm">About Operational Policies</a></li>
</ul>
<ul>
	<li><a href="../../cm/learnmore/basics_glossary.htm">Glossary of Terms for the Developer Portal</a></li>
</ul>
</div>