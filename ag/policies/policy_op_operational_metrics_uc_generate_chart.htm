---
layout: page
title: Operational Metrics Policy Use Case - Generate a Chart from Operational Metrics Obtained from Service Operational Data
description: Learn how to generate a chart from Operational Metrics obtained from service operational data.
product: ag
category: learn
weight: 05
sub-nav-class: Policies - Operational
type: page
nav-title: Operational Metrics Policy Use Case - Generating a Chart from Operational Metrics
---
<h2 id="top">Generating a Chart from Operational Metrics Obtained from Service Operational Data</h2>
<p>The following use case illustrates how to generate a chart from Operational Metrics obtained from Service Operational Data.</p>

<h3>Configuration</h3>
<ol>
  <li>Perform the <a href="http://docs.akana.com/docs-test/ev/envision_install/installing_pm_env_integration_v11.html">Policy Manager / Envision Integration Installation</a>. At the end of this process you will have configured Envision, Policy Manager, and Network Director container instances. This process also includes using <strong>Add Container</strong> in the Policy Manager Management Console to register the Network Director container.</li>
  <li>Launch the Akana Administration Console for the Network Director container instance, and change the following configuration properties via the <strong>Configuration</strong> tab:
    <ol>
      <li><strong>com.soa.metrics</strong>: <strong>metrics.rollup.reporter.requireMetricsPolicy</strong> set to <strong>true</strong>.
  <p><img src="images/oper_metrics_usecase1a.jpg" alt="Changing the metrics rollup configuration" /></p></li>
      <li><strong>com.soa.monitor.usage</strong>: set values as shown below.
        <p><img src="images/oper_metrics_usecase1b.jpg" alt="Changeing the monitor usage configuration" /></p></li>
    </ol></li>
  <li>Restart the Network Director container instance.</li>
  <li>Launch the Policy Manager Management Console and create a physical service using the file at this URL: <a href="http://petstore.swagger.io/v2/swagger.json" target="_blank">http://petstore.swagger.io/v2/swagger.json</a>.</li>
  <li>Select <strong>Virtualize Service</strong>, and virtualize the physical service in the Network Director container. </li>
  <li>Go to <strong>Policies</strong> &gt; <strong>Operational</strong> and use <strong>Add Policy</strong> to create an Operational Metrics Policy and configure it based on the illustration below.
    <p><img src="images/oper_metrics_usecase1c.jpg" alt="Adding the Operational Metrics policy"/></p> 
  </li>
  <li>Attach a Detailed Auditing Policy (found in the root Policies folder) and an Operational Metrics Policy to the virtual service.</li>
  <li>Send requests to the virtual service.
    <p><img src="images/oper_metrics_usecase1d.jpg" alt="Send requests to the virtual service" /></p></li>
  <li>View the  usage logs for the service.
    <p><img src="images/oper_metrics_usecase1e.jpg" alt="Viewing the usage logs" /></p>
    <p><img src="images/oper_metrics_usecase1f.jpg" alt="Usage data details" /></p></li>
  <li>View the recorded logs in MongoDB in the AUDIT_LOG collection.
    <p><img src="images/oper_metrics_usecase1g.jpg" alt="Viewing the logs in MongoDB" /></p></li>
  <li>METRICDATASEC should be aggregating the logs per second. To see this, view the following collections: API Operational Metric Data Set, API Contract Metric Data Set, and API User Metric Data Set.
    <p><img src="images/oper_metrics_usecase1h.jpg" alt="Viewing the User Metric data set" /></p>
    <p><img src="images/oper_metrics_usecase1i.jpg" alt="Viewing the Operational Metric data set" /></p>
    <p><img src="images/oper_metrics_usecase1j.jpg" alt="Viewing the Contract Metric data set" /></p></li>
  <li>METRICDATAMIN should be aggregating the logs per minute on the basis of METRICDATASEC. To see this, view the following collections: API Operational Metric Data Set, API Contract Metric Data Set, and API User Metric Data Set.</li>
  <li>Send requests to various operations.
    <p><img src="images/oper_metrics_usecase1k.jpg" alt="Sending requests to generate data" /></p></li>
  <li>View the usage logs in MongoDB. The logs should contain the fields and information as per the Operational policy configuration made above
    <p><img src="images/oper_metrics_usecase1l.jpg" alt="Viewing the usage logs in MongoDB" /></p></li>
  <li>
    Launch the Envision Console and make a chart using the collections API Operational Metric Data Set, API Contract Metric Data Set, and API User Metric Data Set. The charts should show appropriate data:  
    
    <ul>
      <li>API Operational Metric Data Set
        <p><img src="images/oper_metrics_usecase1m.jpg" alt="Making a chart in Envision" /></p>
        <p><img src="images/oper_metrics_usecase1n.jpg" alt="Chart axis properties" /></p>
        <p><img src="images/oper_metrics_usecase1o.jpg" alt="Chart preview" /></p></li>
      </ul>
  </li>
  <li>In the same way, verify charts for the API Contract Metric Data Set and API User Metric Data Set.</li>
</ol>
<p><a href="#top">Back to top</a></p>