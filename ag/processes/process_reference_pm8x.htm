---
layout: page
title: Process Reference for Policy Manager 8.x
description: Learn to create a process and use process activities in Policy Manager 8.x.
product: ag
category: ref
weight:	1
sub-nav-class: Processes
type: page
nav-title: Policy Manager 8.x Process Reference

---
<a name="top"></a>

<h2 name="top">Process Reference for Policy Manager 8.x</h2>

<p>Learn  to create a process and use process activities.</p>

<p></p>

<h5 class="stamp">Supported Platforms: 8.x</h5>

<p>
</p>

<p><a href="getting_started_with_processes_pm8x.htm" class="button secondary"> Getting Started (PM8x)</a>
  
  
<a href="process_management_pm8x.htm" class="button secondary">Managing Processes (PM8x)</a></p>

<p></p>
<div class = "divider1"></div>

<h3 style="color: gray;">Table of Contents</h3>


<ol class="table_of_contents">

 <li><a href="#processes">About Processes</a></li>
 <li><a href="#processeditor">Process Editor</a></li>

 <li><a href="#faultsequenceeditor">Fault Sequence Editor</a></li>

  <li><a href="#variableeditor">Variable and Faults Editor</a></li>

    <li><a href="#receiveactivity">Receive Activity</a></li>
        <li><a href="#replyactivity">Reply Activity</a></li>

         <li><a href="#invokeactivity">Invoke Activity</a></li>


    <li><a href="#scriptactivity">Script Activity</a></li>

                <li><a href="#branchactivity">Branch Activity</a></li>
  <li><a href="#transformationactivity">Transformation Activity</a></li>

    <li><a href="#auditactivity">Audit Activity</a></li>

    <li><a href="#insertcontentactivity">Insert Content Activity</a></li>

        <li><a href="#processactivity">Process Activity</a></li>
        
         <li><a href="#throwactivity">Throw Activity</a></li>
      
</ol>



<div class = "divider1"></div>



<a name="processes">
<h3>About Processes</h3></a>
<p>A process is an ordered graph of activities that can be performed by a container that supports the virtualization capability, like the Network Director. The logic performed in a virtual service operation is defined as a process. When a message is received by the container, once the virtual service operation is identified, its process is executed. As dictated by the activities in the process, down-stream services may be invoked. As a result of process execution, a response to the original message is generated.
</p>
<p>An example of a process is the default process of a virtual service operation. In that process a message is received using a <a href="#receiveactivity">Receive Activity</a>, an Invoke Activity is executed that calls the virtualized service operation, and a Reply responds with the response from the Invoke Activity.  </p>
<p>Processes can get much more complex to perform functions like transformation and content based routing. The author of the process can assemble activities to achieve the results they would like.  </p>
<p>Policy Manager allows the creation of processes within two different contexts:</p>
<ul class="usingOrderedList">
  <li>As the implementation of a virtual service operation (<em>Services &gt; Operation &gt; Process</em> or <em>Services &gt; Operation &gt; Fault </em>section)<br />
    <br />
    and<br />
    <br />
  </li>
  <li>As a standalone process (Processes Folder) that can be invoked by another process to achieve reusability. </li>
   
</ul>
<p> In all contexts, a graphical editor is provided to construct the process. </p>

<p><a href="#top">Back to top</a></p>

<a name="processeditor"><h3>Process Editor</h3></a>

<p>The <em>Process Editor</em> allows you to create a process in a graphical drag-and-drop environment. The process begins by receiving a message (see the <a href="#receiveactivity">Receive Activity</a>) and the process ends when a message is returned (see the <a href="#replyactivity">Reply Activity</a>) to the caller.</p>
<p><img src="images/process_editor_activity_palette.jpg" width="577" height="395"></p>
<p>Figure. Process Editor Activity Palette</p>
<h5>Activities</h5>
<p>The activities available to be called from within a process are available on an <em>Activity Palette</em> located on the upper left hand side of the editor graph. An activity icon in the palette can be selected and dragged on to the process editor graph. Activities are called in order and are linked together by directional connectors. To link two activities select the middle of the activity that will be executed first. A circle with an error should appear. <br>
  <br>
  <img src="images/starting_a_link_between_activities.jpg" width="402" height="230"></p>
<p>Figure. Starting a Link Between Activities</p>
<p>Drag your mouse to the center of the activity to be executed next and release. A directional connector should be drawn linking the two activities.</p>
<p><img src="images/completing_a_link_between_activities.jpg" width="442" height="138"></p>
<p>Figure. Completing a Link Between Activities</p>
<h5>Sequence</h5>
<p>A series of activities linked together is called a <em>Sequence</em>. A sequence is terminated by either a <a href="#branchactivity">Branch Activity</a> (see below) or by a <a href="#replyactivity">Reply Activity</a> (see below). A set of linked activities from the <a href="#receiveactivity">Receive Activity</a> to a <a href="#replyactivity">Reply Activity</a> may contain several sequences separated by Branch Activities. That entire set of linked activities is called a <em>Flow</em>. </p>
<p>Functions that can be performed on the entire process are available on a toolbar located on the lower left hand side of the editor graph.</p>
<p><img src="images/process_editor_toolbar.jpg" width="539" height="371"></p>
<p>Figure. Process Editor Toolbar</p>
<p>The toolbar has functions such as saving the process, editing the variables used in the process (see <a href="#variableeditor">Variable Editor</a>), refreshing the page, or undoing the last action.</p>

<p><a href="#top">Back to top</a></p>
<a name="faultsequenceeditor">
<h3>Fault Sequence Editor</h3></a>
<p>Next to the Process Editor tab is a tab labeled <em>Fault</em>. On this tab you define a sequence of activities you want executed when a fault is encountered at any point of your main process. In the main process once a fault is encountered, the process execution immediately stops and the activity sequence in the Fault tab is executed.</p>
<p>The editor supports a flow for each named fault as  identified in the Variables and Faults Editor.</p>
<p>A pull-down of fault names as defined in the Variables and  Faults Editor will be displayed on the Fault tab. When selecting a fault name  from the pull-down the fault flow for the named fault will be displayed on the  graph. By default each fault flow will have a single Reply activity. The  default fault flow will be displayed in the pull-down with the &ldquo;Unnamed&rdquo; label.<br>
  <br>
<img src="images/fault_sequence_editor_v80.jpg" width="630" height="350" /></p>
<p>Figure. Fault Sequence Editor</p>
<p>The <em>Fault Sequence Editor </em>works exactly like the main Process Editor except that the sequence does not need to begin with a Receive Activity. The Receive from the external client has already been executed in the main process. At this point we are just executing activities within the same process context. </p>
<p>When the fault sequence is executed, the reserved variable name “fault” will contain the fault message that is triggering the sequence. Activities that reference variables can use this fault variable.  </p>
<p>A fault sequence is not required. If there is no fault sequence the system will simply return the fault back to the client. If a sequence is constructed, at a minimum a Reply Activity must be present at the end. Any of the activities in the activity palette can be used in the fault sequence including <a href="#branchactivity">Branch </a> activities. Each branch however must end with a Reply Activity.</p>
<p> The Reply Activity can be configured to return a fault message or a regular message as controlled by Fault field in the Reply Activity Editor (see the <a href="#replyactivity">Reply Activity</a> section below). The reserved fault name “CurrentFault” as seen in the fault name pull-down indicates that the fault name for the content of the fault variable will be used as-is. The name can be changed however to any of the operation faults or to a Binding Fault instead. This will allow you to perform fault mediation. </p>

<p><a href="#top">Back to top</a></p>
<a name="variableeditor">
<h3><img src="images/variables_editor_icon.jpg" width="26" height="30"> Variables and Faults Editor</h3></a>
<p>The <em>Variables and Faults Editor </em>allows you to define variables that can be  used in the process and faults that are handled within the process.</p>
<p>  Variables can be used in different activities to dictate behavior, such as  using a variable to identify the endpoint of a service to invoke. Variables can  also be used to store the output from web service invocations or provide input  to web service invocations.</p>
<h4>Variables</h4>


<p>A variable is identified by a name and defined by a type, or syntax. The  type recognized by the system are message (used for input or output of a web  service invocation, request, or Reply Activity), string, int, long, boolean,  float, or any (can hold any content). Activities that support the use of variables  in their configurations will often restrict the use of variables based on type.  Optionally a default value can be given to a variable. If there is a default,  at the beginning of process execution the variable will be given that value.</p>
<h4>Faults</h4>
<p>  Faults can be thrown as a result of an activity. If  unhandled the default fault flow is invoked. Optionally, fault flows can be  defined for each named fault thrown within the process if they are identified  here.<br>
<img src="images/variables_faults_editor_pm80.jpg" width="569" height="300" /></p>
<p>Figure. Variables and Faults Editor</p>
<p><a href="#top">Back to top</a></p>
<a name="receiveactivity"><h3><img src="images/receive_activity_icon.jpg" width="44" height="42">Receive Activity</h3></a>
<p>The Receive Activity provides the entry point into the process. The caller will invoke the process by providing it with a message. That message will be stored in the variable selected in the activity’s configuration screen. Only variables of type message can be used. There can only be one Receive activity in a process.<br>
  <br>
  <img src="images/receive_activity_editor.jpg" width="631" height="69">
</p>
<p>Figure. Receive Activity Editor</p>

<p><a href="#top">Back to top</a></p>
<a name="replyactivity"><h3><img src="images/receive_activity_icon.jpg" width="44" height="42">Reply Activity</h3></a>
<p>The Reply Activity provides the exit point from a process. Every flow through the process must have one and only one Reply Activity. This means if there are multiple branches created from a <a href="#branchactivity">Branch Activity</a>, each branch must be terminated with a Reply Activity. The Reply Activity can return a message to the caller. It is not required for one-way operation processes. Only variables of type message can be used.<br>
  <br>
  <img src="images/reply_activity_editor.jpg" width="630" height="68">
</p>
<p>Figure. Reply Activity Editor</p>
<h5>Application and Binding Faults</h5>
<p>In addition to specifying the variable holding the message to return you can also indicate that the message is a fault by providing a Fault Name. Faults fall into two main categories, application faults and binding faults. </p>

<ul class="usingOrderedList">

<li>An application fault is caused by a problem in the business process of the operation. For example if the operation was to withdraw funds an application fault may be for identifying there were insufficient funds.</li>
<li>A binding fault is not specific to the business function of the operation. It a problem at the protocol layer itself. Binding faults are general to all operations. Examples would be security failures, communication failures, message parsing errors, etc. </li>

</ul>

<p>An application fault will be defined in the WSDL document for the operation. Policies can be attached to them. A binding fault is typically not referenced anywhere. In the Reply Activity Editor a Fault Name pull-down is provided that will contain the application faults found in the WSDL document for the operation as well as a reserved fault name of “BindingFault.” You can choose what the message being returned represents. One other option is provided that is called “CurrentFault.” That option is available only in the Fault Sequence Editor. It requires the reserved fault variable to be filled with a message and its fault name to be already known and used here.<br>
  <br>
  <img src="images/fault_reply_activity.jpg" width="630" height="151"></p>
<p>Figure. Fault Reply Activity</p>

<p><a href="#top">Back to top</a></p>


<a name="invokeactivity">
<h3><img src="images/invoke_activity_icon.jpg" width="41" height="38" align="absbottom"> Invoke Activity</h3></a>

<p>The Invoke Activity invokes the operation of a service  registered in the system. The operation is invoked by sending it a message that  is specified using a single input variable or multiple input parameters. The  response from the operation invocation is stored in an output variable. These  variables can be configured on the Manage Input/Output Parameters screen.<br>
<br>
The operation that will get invoked can be specified either  statically or dynamically through the use of variables. To statically identify  the operation to invoke, first start by searching for the service with the  operation.</p>
<p>  The search is performed using QNames. When the Search button is  clicked the system searches for any service with a QName that contains what is  typed in the Service QName field. If nothing is entered all services will be  returned.</p>
<p><img src="images/invoked_service_search_pm8x.jpg" width="504" height="85" /></p>
<p>Figure. Invoked Service Search</p>
<p>  Variables can be used for specifying the service, interface,  and/or operation. The variable must be a string typed variable. </p>
<p><img src="images/Invoke_Activity_Variables_8x.jpg" width="519" height="128" /></p>
<p>Figure. Static  Operation Selection</p>
<p>  By default the access point (endpoint) that is called when  invoking the operation is selected by the runtime container using its selection  strategy. </p>
<p><img src="images/invoke_activity_access_point_8x.jpg" width="545" height="109" /></p>
<p>Figure. Direct Access Point Invocation</p>
Auditing the message as it  is sent over the wire to the access point can be achieved by simply selecting  the Audit checkbox. The virtual service operation invocation that is executing  the process must be currently being audited by use of an auditing policy for  the downstream message to be audited.
<h4>Manage Input/Output Parameters</h4>
<p>An invocation activity must define where inputs to the  invocation will come from and where the output to the invocation will be held  within the process.</p>
<p>  An operation may have 0 or more parameters, or message parts  that must be provided input values. Depending on the protocol used these  parameters can be encoded differently.</p>
<p>  By default a single message can be used as input using the  Single Input Message option. The runtime engine will construct protocol  messages using a default mapping of parameters from the single input message  according to protocol specific rules. In cases where there are multiple input  parameters that cannot be constructed using the default mapping one can  directly specify values for each parameter with the Multiple Input Parameters  option. </p>
<p>  When choosing the Multiple Input Parameters option,  variables in the process can be identified as the inputs to the  parameters/parts defined for the operation. Each parameter of the operation  will be listed in the Parameters table. A variable can be selected from the  drop down in the same row to populate the parameter. If a variable is not  assigned to a parameter the runtime engine will attempt to perform its own  mapping for that parameter.</p>
<p><img src="images/invoke_activity_manage_input_output1_8x.jpg" width="615" height="192" /></p>
<p>A single output message will be returned from an invocation.  A variable can be selected to hold that output for later use within the  process.</p>
<p><img src="images/invoke_activity_manage_input_output2_8x.jpg" width="607" height="60" /></p>

<h4>Manage Outbound Identities</h4>
<p>You can  configure whether you want to use  incoming identities as outbound identities (the default), or specify custom identities to be used for all outbound messages  to the down-stream service on the The &quot;Manage  Outbound Identities&quot; screen.</p>
<p>  When securing outbound calls from a virtual service, identities  will typically be required to be specified in request messages. Those  identities can be categorized as different actors in a message exchange.<br />
  The &ldquo;Use Incoming Identities as Outbound Identities&rdquo; option is  selected by default. This means identities used when invoking the operation are  dictated by the outbound identity configuration of the virtual service.</p>
<p>You can also define identities for outgoing messages in the  &quot;Specify Outbound  Identities&quot; section .  Added identities are stored in an Identity Table where they can be modified or  deleted. Perform the configuration tasks as needed (i.e., Add, Modify, or  Delete).</p>
<p><img src="images/invoke_activity_manage_outbound_identities_8x.jpg" width="539" height="295" /></p>

<h4>Assign Parameter Values from Script</h4>
<p>You can also specify parameters, or parts using the following methods:</p>
<ul class="usingOrderedList">
  <li><strong>getPart (String);</strong> - Adds a value for a part (parameter) with the given name.</li>
  <li><strong>addPart (String, Object part)</strong> - Removes the value for the part (parameter) with the given name.</li>
  <li><strong>removePart (String);</strong> - Returns the names of all parts (parameters) that have been assigned a va value.</li>
  <li><strong>getPartNames()</strong> - Returns the names of all parts (parameters) that have been assigned a value</li>
</ul>
<p>Refer to the <a href="http://docs.soa.com/ag/assets/scriptDocs_pm80/index.html">Policy Manager Scripting API (8.0)</a> for details.</p>
<p><a href="#top">Back to top</a></p>


<a name="scriptactivity"><h3><img src="images/script_activity_icon.jpg" width="39" height="34">Script Activity</h3></a>

<p>The Script Activity provides the ability to execute a script at the point in the process the activity is connected. The script can be written in either JavaScript, Jython, or BeanShell.
</p>
<p>The Script Details Editor is organized into two separate areas, Imports and Source. The Source has a pull-down where you can select the script language. It also has a large source code editor text area. <br>
  <br>
  <img src="images/script_activity_source_area.jpg" width="591" height="140"></p>
<p>Figure. Script Activity Source Area</p>
<p>Common functions that you may need to perform in your scripts can be saved in Script objects using the <strong>Add Script</strong> function in the <em>Scripts</em> section of each Organization in the Policy Manager Workbench. To make use of those common functions from the Script Activity the Script objects defining those functions must be imported. The Imports area is where those scripts are identified for import. The available scripts are listed in the Available Scripts tree. Any number of Scripts in that tree can be moved to the Imported Scripts list box. Only scripts that match the language type will be available for selection in the tree. The script does not return a value. </p>
<p><br>
  <br>
  <img src="images/script_activity_imports_area.jpg" width="572" height="174"></p>
<p>Figure. Script Activity Imports Area</p>
<p>In the figure above the json2 Script from the Registry Scripts folder is imported. Any functions defined in json2 can be used within the Script Activity source code.
</p>
<p>The following pre-defined variables are provided.  For more information refer to the Policy Manager Scripting API located in the docs\scriptDocs folder of the Policy Manager 8.x release folder. </p>
<p>You can access the scripting API for your Policy Manager version here: <a href="http://docs.akana.com/ag/assets/scriptDocs_pm80/index.html" >Policy Manager 8.x</a></p>
<p>Click index.htm to launch the documentation: </p>
<ul class="usingOrderedList">

<li>
  <strong>processContext</strong> – Provides functions for retrieving and changing information about the currently running process, such as the variables defined in the process and the authenticated subject(s) of the process.
</li>


<li>
  <strong>systemLog</strong> – Provides logging functions to the container&rsquo;s log. The statements logged with this interface are mixed with the other system log statements.
</li>

<li>
  <strong>auditLog</strong> – Provides logging functions to the process audit log. If auditing is enabled for the virtual service operation that is invoking the process statements logged using this variable log information will be inserted into the audited message log for the operation&rsquo;s execution. This can be found on the service&rsquo;s Monitoring tab in the Logs sub-tab.
</li>

<li>
  <strong>alerter</strong> – Provides an interface for generating alerts that are displayed in on the Policy Manager alert pages.
</li>
<li>
  <strong>recorder</strong> – Provides an interface for recording content in the Policy Manager usage log pages.
</li>

<li>
  <strong>msgFactory</strong> – Providers functions for create message variables. A message variable cannot  simply be assigned content like a simple string or int variable. It must be initialized using one of the functions in the msgFactory.
</li>
</ul>

<h5>Normalized Copy Example</h5>
<p>The following is a script that creates a normalized copy of a message and saves it as a variable.</p>
  <img src="images/script_activity_message1.jpg" width="589" height="39"><br>
</p>

<p>On line 1 the processContext is used to get the message variable named “message”. On line 2 a normalized copy is made of the message. Finally on line 3 the processContext is used to save the normalized copy as a variable named “copy” that can be used in other activities that execute after this one in the process.<br>
</p>
<h5>Normalized Message Creation Example</h5>

<p>The next script illustrates the use of the msgFactory to create a normalized message. A normalized message contains the XML element referenced in the wsdl:Message element in a WSDL document.</p>

<p><img src="images/script_activity_message2.jpg" width="613" height="67"> </p>
<p>On line 3 the msgFactory is used to create a normalized message named temp. On line 4 the content from line 1 is set as the temp message content. On line 5 the processContext is used to save the new message as a variable named temp.</p>

<h5>Protocol Message Creation Example</h5>

<p>
  Message creation is not limited to normalized messages. Protocol specific messages of any content-type can be constructed using the msgFactory. The following example shows the creation of a JSON message.</p>
<p><img src="images/script_activity_message3.jpg" width="602" height="65"></p>
<p>Note on line 2 the call on the msgFactory to create the message is different, both in function name and the need for specifying the content-type of the message, application/json in this case.</p>

<p><a href="#top">Back to top</a></p>
<a name="branchactivity">
<h3><img src="images/branch_activity_icon.jpg" width="31" height="24"> Branch Activity</h3></a>
<p>The Branch Activity provides a mechanism to have alternate process flows, or branches, based on boolean conditions. Drop the Branch Activity on the Process page and connect the last activity to be executed before the branch to the Branch Activity.<br>
  <br>
  <img src="images/adding_a_branch_activity.jpg" width="262" height="140">
</p>
<p>Figure. Adding a Branch Activity</p>
<p>The Branch Activity itself has very little configuration. It is the branch conditions themselves that have most of the information. If you double click on the Branch Activity you can see a list of the conditions and most importantly you can establish what expression language each branch condition will use. All branch conditions must use the same language. The supported languages are XPath, JavaScript, Jython, or BeanShell.<br>
  <br>
  <img src="images/branch_activity_editor.jpg" width="577" height="162"></p>
<p>Figure. Branch Activity Editor</p>
<p>To create a branch add the next activity to be performed to the process graph, select the Branch Activity and connect it  to the next activity.<br>
  <br>
  <img src="images/creating_a_branch.jpg" width="487" height="160"></p>
<p>Figure. Creating a Branch</p>
<p>A Branch Activity is similar to a Java switch statement. It can support multiple branches. Only one branch will be followed. The branches have boolean conditions defined either by an XPath expression or a script.  Each branch is evaluated in order. The first to evaluate to true is selected and the sequence of activities associated with the branch are performed. </p>
<p>Branch conditions are defined separately from the main Branch Activity in the Condition Details Editor. You add a branch condition by adding a new activity to the sequence (e.g., Script Activity, Invoke Activity, etc. ) and dragging a connector from the main Branch Activity to the target activity. There must always be a default branch that can be selected if no other branch conditions evaluate to true. This default branch condition is named &quot;Otherwise&quot; and must be added and set for each Branch Activity configuration. </p>
  <p>A branch condition can be written in any of the languages in the drop-down, is set in the Branch Details Editor  and can only be changed there. The language selected will apply to all conditions within the branch. </p>
  <p>Note that if you have branch conditions defined and you choose to change the language all source will be deleted.  It is recommended that you make a copy of your source content prior to changing the language.</p>
  <p>After you select the language for case conditions, you then save and exit your Branch Activity and add your connections. </p>
  <p>The result of the condition must be either true or false. If there are multiple conditions for a branch, the order in which they are executed can be changed by moving each condition up or down in the Case Conditions table. Note that the &quot;Otherwise&quot; condition does not display in the Case Conditions table but must still be defined. </p>

<p>  The first branch created in most cases will become the Otherwise branch although that can be changed. To change a branch&rsquo;s condition double click on the connector between the Branch Activity and the next activity in the branch sequence. The branch condition can be written in either XPath, JavaScript, Jython, or BeanShell. The result of the condition must be either true or false.<br>
  <br>
  <img src="images/branch_condition_editor.jpg" width="521" height="371"></p>
<p>Figure. Branch Condition Editor</p>
<p>In the figure above the condition is configured to use XPath as the language for the boolean expression. The expression checks for the first price element found in the content of the message named “message” and if its value is greater than 100 then this condition is met. Note the namespace prefix is defined at the bottom of the page.
</p>
<p>When using XPath as the expression language a field for selecting a message variable to use as the context of the expression is displayed. The expression will be evaluated against that variable’s content. The variable’s content must be XML or an error will be generated at runtime.</p>
<p> When using a script language the script is evaluated and the last line of execution is expected to result in a boolean true or false. The context of the script is provided with a subset of the variables described in the Script Activity above: </p>
<ul class="usingOrderedList">

<li>
  <strong>processContext</strong> – Provides functions for retrieving and changing information about the currently running process, such as the variables defined in the process and the authenticated subject(s) of the process.
</li>


<li>
  <strong>systemLog</strong> – Provides logging functions to the container&rsquo;s log. The statements logged with this interface are mixed with the other system log statements.
</li>

<li>
  <strong>auditLog</strong> – Provides logging functions to the process audit log. If auditing is enabled for the virtual service operation that is invoking the process statements logged using this variable will be inserted into the audited message log for the operation&rsquo;s execution. This can be found on the service&rsquo;s <em>Monitoring</em> tab in the <em>Logs</em> sub-tab. </li>
</ul>
<p>In the following figure the condition is triggered when the value of the price variable is greater than 100.</p>
<p><img src="images/javascript_branch_condition.jpg" width="569" height="163"></p>
<p>Figure. JavaScript Branch Condition</p>

<p><a href="#top">Back to top</a></p>

<a name="transformationactivity"><h3><img src="images/transformation_activity_icon.jpg" width="40" height="36">Transformation Activity</h3></a>
<p>The Transformation Activity provides a mechanism for transforming XML message or string content. The transformation is based on XSLT. The input to the activity can be a message or string variable. The transformed content will replace the input variable content at the completion of the activity.<br>
  <br>
  <img src="images/transformation_activity_example.jpg" width="581" height="301"></p>
<p>Figure. Transformation Activity Example<br>
</p>
<p>In the figure above, the XSL Stylesheet will remove the BankId element and prefix the account id of each account with the bank id. If the message variable had the following content:<br>
  <br>
  <img src="images/transformation_activity_message1.jpg" width="519" height="145"></p><br>

<p>After executing this Transformation Activity the content of the message variable will be:</p>
<p><br>
  <img src="images/transformation_activity_message2.jpg" width="515" height="127"> </p>
<a name="auditactivity">
<h3><img src="images/Audit Activity Icon.jpg" width="28" height="29"> Audit Activity</h3></a>
<p>The Audit Activity provides a mechanism for auditing a message. The audited message content is recorded and displayed as audited message content from an Auditing Policy. This information displays on the   <em>Monitoring</em> pages of a service (i.e., Services &gt; Monitoring). The input to the activity can be a message variable. </p>
<p>There are several options for what portion of the message variable content will be audited. In the Capture Details section of the Activity Editor there are two primary options; to capture the <em>complete</em> message or a <em>portion</em> of the message. <br>
  <br>
  <img src="images/auditing_complete_message.jpg" width="601" height="115"></p>
<p>Figure. Auditing Complete Message</p>
<p>If the &quot;Capture complete message&quot; option is selected only a record name, or label, needs to be specified. If the &quot;Capture message at the following expressions&quot; option is  selected a list of expressions can be entered.<br>
  <br>
  <img src="images/auditing_portions_of_message.jpg" width="534" height="219"></p>
<p>Figure. Auditing Portions of Message</p>
<p>Each expression can use a different language. The supported languages are XPath, JSONPath, and Regular Expression. The XPath expressions are used when the input content is XML. The JSONPath expressions are used when the input content is JSON. The Regular Expressions are used for all other types of content. Each expression will have its own Record Name, or label.
</p>
<p>In case there is content that should not be viewable by others in the audit log there is an option for masking content. In the Masked Elements section you specify a mask (e.g., password, account number) and a list of expressions that identify the content to be masked. <br>
  <br>
  <img src="images/masking_audited_elements.jpg" width="576" height="235"></p>
<p>Figure. Masking Audited Elements</p>
<p>The expressions in the Masked Elements section are similar to those in the Capture Details section. The same languages are supported for masking and the same mapping of message content type to expression language. The results of the expressions will be replaced by the mask string.</p>
<p>If we look at the entire activity definition we can see that we are auditing just the account elements/properties of XML and JSON messages but we are masking out the account id&rsquo;s with a mask of *******.</p>
<p><img src="images/audit_activity_example.jpg" width="497" height="548"></p>
<p>Figure. Audit Activity Example</p>
<p>Note the XPath expressions require namespace prefix definitions that are specified at the bottom of the editor.</p>

<p><a href="#top">Back to top</a></p>
<a name="insertcontentactivity"><h3><img src="images/insert_content_activity_icon.jpg" width="45" height="37">Insert Content Activity</h3></a>
<p>The Insert Content Activity can be used to fill the content of a String or Message variable. The source of the content can be either statically defined content or an existing variable.
</p>
<p>The From section of the activity editor identifies the source of the content. To specify static content to be inserted select the Static Content radio button. Once selected a text area will be displayed where content of any type, XML, JSON, text, etc. can be entered. A text field will also be displayed where you must enter the mime content type of the static content you entered in the text area (i.e., application/xml or application/json). <br>
  <br>
  <img src="images/static_content.jpg" width="537" height="232"></p>
<p>Figure. Static Content</p>
<p>To use content from a variable as input select the Variable radio button. Once selected a Filter section is displayed. Select the Filter check box if you would like only a portion of the variable’s content to be inserted. To insert the entire content of the variable do not select the checkbox.
</p>
<p>A filter is defined using a filter expression written in a selected language. The languages supported are XPath (for XML content), JSONPath (for JSON content), or Regular Expression (for any content).  The result of the filter expression applied to the input variable will be inserted. It is possible that the filter expression results in multiple elements or properties being used as input. </p>
<p><img src="images/filtered_variable_content.jpg" width="571" height="173"></p>
<p>Figure. Filtered Variable Content</p>
<p>When defining XPath filter expressions the namespaces of specified elements must be included. That is done by using a namespace prefix in the expression. All namespace prefixes must be mapped to a namespace in the Namespace Prefixes table at the bottom of the activity page.</p>
<p><img src="images/namespace_prefixes.jpg" width="568" height="117"></p>
<p>Figure. Namespace Prefixes</p>
<p>The To section of the activity identifies the target of the content specified in the From section. The target of the inserted content must be a variable. The From content can either initialize/replace the content of the variable in the To section or it can be inserted into the existing content of the target variable. If replacing the entire content of a variable and the variable has not yet been initialized it will be initialized as a result of the activity.</p>
<p>
  To insert into existing content the target location must be identified using a filter similar to the one described in the To section. Based on the filter expression it is possible that multiple target locations can be found. Once a target location can be identified the choice of whether the source content should be inserted/added to that location or the source content should replace what is at that location needs to be made. That choice is made by selecting either the Append or Replace radio button. Note, only the Replace option is available when using the Regular Expression language.</p>
<p><img src="images/filtered_content_target.jpg" width="554" height="146"></p>
<p>Figure. Filtered Content Target</p>
<p>The following figure illustrates the use of the Insert Content to initialize a message with static XML content.</p>
<p><img src="images/static_content_example.jpg" width="512" height="465"></p>
<p>Figure. Static Content Example</p>
<p>Since no filter is defined in the To section the static XML content will replace the content of var1, but if var1 has not yet been initialized in the process the static XML content will be used to initialize var1.
</p>
<p>The next figure illustrates using the Insert Content Activity to extract a portion of a source variable and append it to a target variable in a specified location. </p>
<p><img src="images/append_content_example.jpg" width="549" height="424"></p>
<p>Figure. Append Content Example</p>
<p>All account elements in the message variable will be appended to the accounts element in var1. If no accounts element is found at the root of var1 an error will be generated. To see how this activity would perform at runtime take the following content for the message variable:</p>
<p><img src="images/insert_content_activity_message1.jpg" width="550" height="229"></p>
<p>And the following content for the var1 variable:</p>
<p><img src="images/insert_content_activity_message2.jpg" width="512" height="15"></p>
<p>As a result of the activity var1 would have the following content:</p>
<p><img src="images/insert_content_activity_message3.jpg" width="521" height="131"></p>

<p><a href="#top">Back to top</a></p>
<a name="processactivity">
<h3><img src="images/process_activity_icon.jpg" width="41" height="40"> Process Activity</h3></a>
<p>The Process Activity allows you to call one process from another so that you can create processes with common activities and then call those processes at an appropriate point of another process. These processes with common activities are reusable and are organized in the <em>Processes</em> folder of each Organization in the Policy Manager Workbench. Reusable processes can themselves have Process activities so that they can call other reusable processes. </p>
<p>The configuration of a Process Activity is simple. The editor presents a tree of reusable processes in the <em>Processes</em> folder of each Organization in the  Policy Manager Workbench. You simply select one. </p>
  <p><img src="images/process_activity_editor.jpg" width="550" height="222"></p>
  <p>Figure. Process Activity Editor</p>

  <p>When a process is called from another process, the calling process’s context is passed to the called process. All the variables and their values from the calling process are passed through. If the called process defines variables with the same names as ones in the calling process, the calling process’s variables will be used.</p>
  
  <a name="throwactivity">
<h3><img src="images/throw_activity_icon.jpg" width="30" height="29"> Throw Activity</h3></a>
<p>The Throw Activity exits the current flow of activities and enters the fault flow. You can add a Throw Activity at any point in the process  (not in the fault flow). At the conclusion of the Throw Activity the current flow will be terminated and either the fault flow defined for the thrown fault will be executed (if defined) or the default flow will be executed. </p>
<p>The Throw Details Editor allows you to configure the Throw Activity. Here you define a Fault Name, and the  message variable can be identified as the fault message. </p>
<p><img src="images/throw_activity_editor.jpg" width="617" height="103" /></p>
<p>Figure. Throw Details Editor</p>
<p><img src="images/throw_activity_illustration.jpg" width="638" height="363" /></p>
<p>Figure. Adding a Throw Activity</p>
<p>The Throw Activity is defined  by the fault it throws and optionally a message containing information about  the fault.</p>
<p>If there is a fault flow  constructed for the fault with the given name the flow will be executed. If  there is not, the default, or unnamed fault flow, will be executed. The  variable identifies a message variable in the process that holds the contents  of the fault. It is assigned to the standard &ldquo;fault&rdquo; variable that is used in  the default Reply activity of fault flows.</p>
<p><a href="#top">Back to top</a></p>
<div class = "divider1"></div>
