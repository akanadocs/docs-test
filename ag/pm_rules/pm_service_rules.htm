---
layout: page
title: Policy Manager Service Rules
description: Learn how to add security to your services by adding and managing Allow and Deny rules.
product: ag
category: learn
weight: 06
sub-nav-class: Rules
type: page
nav-title: Policy Manager Service Rules
---
<h1 id="top">Policy Manager Service Rules</h1>
<p>Learn how to add security to your services by adding and managing Allow and Deny rules.</p>
<hr class="divide_hr" />



<h2 style="color: gray;">Table of Contents</h2>

<ol class="table_of_contents">
	<li><a href="#rules_overview">Rules: Overview</a></li>
	<li><a href="#rules_types">Types of rules</a></li>
	<li><a href="#rules_managing">Managing rules</a></li>
	<li><a href="#rules_field_descriptions">Service Rules: Field Descriptions</a></li>
	<li><a href="#web_service_security_practices">Web services: Security practices</a></li>
</ol>



<hr class="divide_hr" />



<h2 id="rules_overview">Rules: Overview</h2>
<p>Policy Manager allows you to configure rules for securing XML physical and virtual web services, to help protect the services. This functionality is useful for two important Web service security practices:</p>
<ul>
	<li>implementation of XML filtering</li>
	<li>Protection against XML denial of service (DoS) attacks.</li>
</ul>
<p>For more information about security practices for web services, see <a href="#web_service_security_practices">Web services: Security practices</a>.</p>
<p><strong>Note</strong>: Policy Manager doesn't support service rules for the JMS listener protocol.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="rules_types">Types of rules</h2>
<p>There are two types of rules that you can use to add security to a service:</p>
<ul>
	<li><strong>Allow</strong> rules allow you to configure:
	<ul>
			<li>IP address filtering for allowing access to the current service.</li>
			<li>Denial of service parameters such as maximum message size allowed.</li>
		</ul>
	</li>
	<li><strong>Deny</strong> rules allow you to configure:
	<ul>
			<li>IP address filtering configuration parameters for denying access to the current service.</li>
		</ul>
	</li>
	</ul>
<p><a href="#top">Back to top</a></p>



<h2 id="rules_managing">Managing rules</h2>
<p>In Policy Manager, rules are defined in the context of a specific service within the organization.</p>
<p>You can:</p>
<ul>
	<li><a href="#proc_rules_view">View existing rules</a></li>
	<li><a href="#proc_rules_add_allow">Add an Allow rule</a></li>
	<li><a href="#proc_rules_add_deny">Add a Deny rule</a></li>
	<li><a href="#proc_rules_modify">Modify an existing rule</a></li>
	<li><a href="#proc_rules_delete">Delete a rule</a></li>
</ul>

<h4 id="proc_rules_view">To view existing rules</h4>
<ol>
	<li>In Policy Manager, select <strong>Workbench</strong> &gt; <strong>Browse</strong>. In the left pane, find the organization, click to expand it, and then click <strong>Services</strong>. Choose the service. The summary page for the service is displayed.</li>
	<li>Click the <strong>Rules</strong> tab, as shown below.
	<p><img src="images/rules_overview.jpg" alt="Rules page for a service" /></p>
	</li>
</ol>
<p>If there are any rules already defined for the service, they are displayed.</p>


<h4 id="proc_rules_add_allow">To add an Allow rule</h4>
<ol>
	<li>In Policy Manager, go to the <strong>Rules</strong> page for the service (see <a href="#proc_rules_view">To view existing rules</a> above).</li>
	<li>Click <strong>Add Allow Rule</strong>. The <strong>Add Allow Rule</strong> page is displayed, as shown below.
	<p><img src="images/rules_allow_add.png" alt="Adding an Allow rule" /></p>
	</li>
	<li>Choose configuration options. For information on the choices available, refer to:
	<ul>
			<li><a href="#rules_field_descriptions_allow_01">Allow Rules: IP Address Filtering</a></li>
			<li><a href="#rules_field_descriptions_allow_02">Allow Rules: Denial of Service</a></li>
		</ul>
	</li>
	<li>Click <strong>Apply</strong>.</li>
</ol>

<h4 id="proc_rules_add_deny">To add a Deny rule</h4>
<ol>
	<li>In Policy Manager, go to the <strong>Rules</strong> page for the service (see <a href="#proc_rules_view">To view existing rules</a> above).</li>
	<li>Click <strong>Add Deny Rule</strong>. The <strong>Add Deny Rule</strong> page is displayed, as shown below.
	<p><img src="images/rules_allow_deny.png" alt="Adding a Deny rule" /></p>
	</li>
	<li>Choose configuration options. For information on the choices available, refer to:
	<ul>
		<li><a href="#rules_field_descriptions_deny">Deny Rules: IP Address Filtering</a></li>
	</ul></li>
	<li>Click <strong>Apply</strong>.</li>
</ol>

<h4 id="proc_rules_modify">To modify a rule</h4>
<ol>
	<li>In Policy Manager, go to the <strong>Rules</strong> page for the service (see <a href="#proc_rules_view">To view existing rules</a> above).</li>
	<li>On the list, find the rule you want to modify and double-click to open the <strong>Modify</strong> page.</li>
	<li>Update the configuration options as needed. For information on the choices available, refer to <a href="#rules_field_descriptions">Service Rules: Field Descriptions</a>.</li>
	<li>Click <strong>Apply</strong>.</li>
</ol>

<h4 id="proc_rules_delete">To delete a rule</h4>
<ol>
	<li>In Policy Manager, go to the <strong>Rules</strong> page for the service (see <a href="#proc_rules_view">To view existing rules</a> above).</li>
	<li>On the list, select the rule you want to delete and click <strong>Delete Rule</strong>.</li>
	<li>At the confirmation prompt, click <strong>OK</strong>. The rule is deleted.</li>
</ol>
<p><a href="#top">Back to top</a></p>



<h2 id="rules_field_descriptions">Service Rules: Field Descriptions</h2>
<p>The tables below provide information about the fields available for configuring <strong>Allow</strong> or <strong>Deny</strong> rules.</p>
<p><strong>Note</strong>: Policy Manager doesn't support service rules for the JMS listener protocol.</p>
<p>There are two sets of options for <strong>Allow</strong> rules and one set for <strong>Deny</strong> rules:</p>
<ul>
	<li><a href="#rules_field_descriptions_allow_01">Allow Rules: IP Address Filtering</a></li>
	<li><a href="#rules_field_descriptions_allow_02">Allow Rules: Denial of Service</a></li>
	<li><a href="#rules_field_descriptions_deny">Deny Rules: IP Address Filtering</a></li>
</ul>

<h4 id="rules_field_descriptions_allow_01">Allow Rules: IP Address Filtering</h4>
<p>The <strong>IP Address Filtering</strong> section allows you to configure the XML-based filtering using a variety of IP address combinations. XML-based filtering rules are designed to add security by reducing the "aperture of entry" into the corporate network.</p>
<p>For <strong>Allow</strong> rules, the message size, transaction rate, and connection duration (Denylist Time) are monitored through the specified IP Address filter. For <strong>Deny</strong> Rules, access is denied to all service requests made through the specified IP Address filter. This functionality addresses the <a href="#webservsec_filtering">Implement XML Filtering</a> XML Web Service Security Practice.</p>
<p>An IP address consists of two parts:</p>
<ol>
	<li>The first part of the address is called the <strong>network number</strong> and identifies a network on the internet.</li>
	<li>The remainder of the address identifies an individual host on the network.</li>
	</ol>
<p>An address mask determines which portion of an IP address identifies the network, and which portion identifies the host. A subnet mask is a modified address mask that is used to partition a network into two subnets.</p>
<p>The IP Address Filtering options for <strong>Allow</strong> rules are shown below.</p>

<table class="doctable">
	<thead>
		<tr>
			<th>Name</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
		<td>Allowed IP Address Range</td>
	 <td>Allows you to perform IP filtering for an IP address range. To use this option, click <strong>Allowed IP Address Range</strong> and then enter start and end IP addresses.</td>
	</tr>
	<tr>
		<td>Allow Subnet</td>
		<td>Allows you to perform IP filtering using a subnet mask. To use this option, click <strong>Allow Subnet</strong> and then specify the IP address and subnet mask.</td>
	</tr>
	<tr>
		<td>Specific IP Address</td>
		<td>Allows you to perform IP filtering for a single IP address. To choose this option, click <strong>Specific IP Address</strong> and then specify the IP address.</td>
	</tr>
	<tr>
		<td>Allow All</td>
		<td>Allows you to configure the <strong>Allow</strong> rule to disable IP filtering; however, to ensure optimum security, it's best to use the IP address filtering capability.</td>
	</tr>
</tbody>
</table>

<h4 id="rules_field_descriptions_allow_02">Allow Rules: Denial of Service</h4>
<p>The <strong>Denial of Service</strong> section provides protection against XML Denial of Service attacks and allow you to implement reasonable constraints for incoming messages based on the XML filtering rules specified in the <strong>IP Address Filtering</strong> section. This functionality addresses the <a href="#webservsec_dos">Protect Against XML Denial of Service Attacks</a> XML Web Service Security Practice.</p>
<table class="doctable">
	<thead>
		<tr>
			<th>Name</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
		<td>Message Size</td>
		<td>Allows you to specify an allowable maximum message size in Bytes (B), Kilobytes (KB), or Megabytes (MB). When choosing a maximum message size, bear in mind your specific business requirements and your Policy Manager production site configuration. You can also choose <strong>No Limit</strong>; we do not recommend this option, since it doesn't safeguard against a Denial of Service attack.</td>
	</tr>
	<tr>
		<td>Transaction Rate</td>
		<td>Allows you to specify the maximum allowable transaction rate in Seconds (sec), Minutes (min), and Hours (hour). When choosing a maximum transaction rate, bear in mind your specific business requirements and Policy Manager production site configuration. You can also choose <strong>No Limit</strong>; we do not recommend this option, since it doesn't safeguard against a Denial of Service attack.</td>
	</tr>
	<tr>
		<td>Denylist Time</td>
		<td>Allows you to specify how long violators of the rules are added to the denylist and how long undesirable traffic associated with the IP Address Filter will be blocked. You can specify the denylist time in Seconds (sec), Minutes (min), or Hours (hour). During this time, traffic that violated the rule is blocked. To use this option, click <strong>Deny Access For</strong>, select the unit of measure (sec, min, hour), and then enter the numeric time period. You can also choose not to add violations to the denylist; however, to ensure optimum security, it's best to use this capability.</td>
	</tr>
</tbody>
</table>

<h4 id="rules_field_descriptions_deny">Deny Rules: IP Address Filtering</h4>
<p>The IP Address Filtering options for <strong>Deny</strong> rules are shown below.</p>

<table class="doctable">
	<thead>
		<tr>
			<th>Name</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
		<td>Denied IP Address Range</td>
		<td>Allows you to perform IP filtering for an IP address range. To use this option, click <strong>Denied IP Address Range</strong> and then enter start and end IP addresses.</td>
	</tr>
		<tr>
			<td>Deny Subnet</td>
			<td>Allows you to perform IP filtering using a subnet mask. To use this option, click <strong>Deny Subnet</strong> and then specify the IP address and subnet mask.</td>
		</tr>
	<tr>
		<td>Specific IP Address</td>
		<td>Allows you to perform IP filtering for a single IP address. To choose this option, click <strong>Specific IP Address</strong> and then specify the IP address to block.</td>
	</tr>
	<tr>
		<td>Deny All</td>
		<td>Allows you to configure the Deny rule to filter all IP addresses. If you choose <strong>Deny All</strong>, the full range of IP addresses, 0.0.0.0 to 255.255.255.255, is applied as the default.</td>
	</tr>
</tbody>
</table>
<p><a href="#top">Back to top</a></p>



<h2 id="web_service_security_practices">Web services: Security practices</h2>
<p>Effectively deploying a secure web service requires technologies that can:</p>
<ul>
	<li>Parse, filter, and transform XML and SOAP packets.</li>
	<li>Apply security policies at the XML document level.</li>
</ul>
<p>These requirements have been defined at the industry level as a set of security practices for XML Web services.</p>
<p>The set of Web services security practices is designed to enhance existing transport-layer security systems with XML Web Services Security. They address important security activities such as:</p>
<ul>
	<li>Securing the transport layer</li>
	<li>Implementing XML filtering</li>
	<li>Masking internal resources</li>
	<li>Protecting against XML Denial of Service attacks</li>
	<li>Validating, transforming, and signing all messages</li>
	<li>Encrypting message fields</li>
	<li>Implementing secure auditing</li>
</ul>
<p>The key Web services security practices are summarized in the table below.</p>
<table class="doctable">
	<thead>
		<tr>
			<th>Category</th>
			<th>Recommendation</th>
		</tr>
	</thead>
	<tbody>
	<tr>
		<td id="webservsec_sec_tl">Secure the Transport Layer</td>
		<td>Recommends using transport layer security to ensure confidentiality of information during transport. This security practice also recommends the use of server certificates and client certificates during authentication.</td>
	</tr>
	<tr>
		<td id="webservsec_filtering">Implement XML Filtering</td>
		<td>Recommends applying content-level filtering policies to XML documents after they are parsed and processed. This security practice ensures XML documents cannot be read or processed at wire speed.</td>
	</tr>
	<tr>
		<td id="webservsec_mask">Mask Internal Resources</td>
		<td>Recommends use of Network Address Translation (NAT) to obscure internal IP addresses.</td>
	</tr>
	<tr>
		<td id="webservsec_dos">Protect Against XML Denial of Service Attacks</td>
		<td >Recommends applying reasonable constraints to incoming messages including the ability to configure message size, transaction rate, and connection duration.</td>
	</tr>
	<tr>
		<td id="webservsec_validate">Validate All Messages</td>
		<td>Recommends using XML schema validation to ensure that incoming and outgoing messages are valid.</td>
	</tr>
	<tr>
		<td id="webservsec_xform">Transform All Messages</td>
		<td>Recommends using XSLT functionality to transform all XML messages to make internal schemas and object layouts difficult for outside parties to understand.</td>
	</tr>
	<tr>
		<td id="webservsec_sign">Sign All Messages</td>
		<td>Recommends applying signatures to all outgoing documents and providing the recipient with an option of performing signature verification for authentication.</td>
	</tr>
	<tr>
		<td id="webservsec_timestamp">Time-Stamp All Messages</td>
		<td>Recommends using the Network Time Protocol (NTP) or XML Digital Signatures to time-stamp all incoming and outgoing messages.</td>
	</tr>
	<tr>
		<td id="webservsec_encrypt">Encrypt Message Fields</td>
		<td>Recommends the encryption of individual XML documents and data fields within documents with different encryption keys. This security practice ensures that a decrypted message exposed in XML plain text format is not vulnerable to a security attack.</td>
	</tr>
	<tr>
		<td id="webservsec_sec_aud">Implement Secure Auditing</td>
		<td>Recommends using a combination of XML Digital Signatures and time-stamping to add security to transaction logs.</td>
		</tr>
	</tbody>
</table>
<p><a href="#top">Back to top</a></p>
