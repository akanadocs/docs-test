---
layout: page
title: Using the Microsoft Service Identity Policy
description: Learn how to use the Microsoft Service Identity Policy to specify the SPN/UPN for a physical service or virtual service that requires Kerberos authentication.
product: ag
category: learn
weight: 05
sub-nav-class: Intermediary for Microsoft
type: page
nav-title: Microsoft Service Identity Policy
---
<h1 id="top">Using the Microsoft Service Identity Policy</h1>
<p>Learn how to use the Microsoft Service Identity Policy to specify the SPN/UPN for a physical service or virtual service that requires Kerberos authentication.</p>
<p><a href="../policies/policy_management.htm" class="button secondary">Managing Policies</a>  
<a href="ims_policies.htm" class="button secondary">Intermediary for Microsoft Policies</a></p>



<div class = "divider1"></div>
<h2 style="color: gray;">Table of Contents</h2>
<ol class="table_of_contents">
	<li><a href="#introduction">Introduction</a></li>
	<li><a href="#configuration">Configuration</a></li>
</ol>
<div class = "divider1"></div>



<h2 id="introduction">Introduction</h2>
<p>The <strong>Microsoft Service Identity Policy</strong> is an Intermediary for Microsoft operational policy that is installed to the <strong>Policy Manager Management Console</strong> as part of the Intermediary for Microsoft product installation.</p>
<p>With this policy, you can specify the SPN/UPN for a physical service or virtual service that requires Kerberos authentication. The API gateway will overwrite the service endpoint identity in the WSDL with the value from this policy.</p>
<p>To install this policy, see <strong>Chapter 3: Installing Akana Intermediary for Microsoft Policy Manager Policy</strong> section of the <strong>Akana Intermediary for MicrosoftÂ® Install Guide</strong> for installation instructions.</p>
<p><a href="#top">back to top</a></p>



<h2 id="configuration">Configuration</h2>
<p>Let's take a quick walkthrough of the Microsoft Service Identity Policy configuration process to get you started.</p>
<ul>
	<li><a href="#step_01">Step 1: Add Policy</a></li>
	<li><a href="#step_02">Step 2: Modify Policy</a></li>
	<li><a href="#step_03">Step 3: Configure Policy</a></li>
	<li><a href="#step_04">Step 4: Attach Policy</a></li>
	<li><a href="#step_05">Step 5: Test Policy</a></li>
</ul>

<h4 id="step_01">Step 1: Add Policy</h4>
<p>You can create a Microsoft Service Identity Policy instance using <strong>Add Policy</strong> in the <strong>Policies</strong> &gt; <strong>Operational Policies</strong> section. The summary screen will look like this:</p>
<p><strong><img src="images/ms_identity_pol_summary.JPG" alt="" /></strong></p>


<h4 id="step_02">Step 2: Modify Policy</h4>
<p>When you <strong>Modify</strong> the Microsoft Service Identity Policy on the <strong>Policy Details</strong> page the initial policy will look like this:</p>
<p><img src="images/modify_ms_identity_policy.JPG" alt="" /></p>
<p><img src="images/modify_ms_identity_policy2.JPG" alt="" /></p>


<h4 id="step_03">Step 3: Configure Policy</h4>
<p>Configure the Microsoft Service Identity Policy as follows:</p>

<p><strong>User Principal Name</strong></p>
<p>User principal name (UPN) lets you specify the user that this service is running under. In a Windows security use case, the consumer must communicate with the service using this identity as the service identity.</p>
<ul>
	<li><strong>Username&#8212;</strong>Enter the username that this service is running under. This is typically an Active Directory user or a local Windows Server account.</li>
	<li><strong>Domain&#8212;</strong>Enter the domain that this user is a part of. If the user is a local Windows Server account, enter the hostname of that Windows Server machine.</li>
</ul>

<p><strong>Service Principal Name</strong></p>
<p>Service principal name lets you specify the Service principal name (SPN) that this service is running under. In a Windows security use case, the consumer must communicate with the service using this service principal name.</p>
<ul>
	<li><strong>Service principal Name&#8212;</strong>Enter the SPN that this service is running under. This SPN be registered and mapped to the Windows identity that the service is running under.</li>
</ul>


<h4 id="step_04">Step 4: Attach Policy</h4>
<p>After you have saved your policy you can attach it to an Intermediary for Microsoft virtual Service in Policy Manager or you can attach the policy at the Organization level and the policy will be active for all services defined within the organization.</p>
<p><img src="images/ms_service_identity_pol_attach.JPG" alt="" /></p>


<h4 id="step_05">Step 5: Test Policy</h4>
<p>After you attached the Microsoft Service Identity Policy to a service, send a request to your service and view the results in your client. You can also go to the <strong>Services</strong> &gt; <strong>Monitoring</strong> section to view the results for Logs (View Usage Record Details), Real Time Charts, and Historical Charts. Refer to the Policy Manager Online Help (Help button) for more information on the using the monitoring functions.</p>
<p>If you receive errors, review the log information for details. In most cases, errors are typically associated with specifying the wrong value for the Microsoft Service Identity Policy. Update the policy and retry.</p>
<p><a href="#top">back to top</a></p>