---
layout: page
title: Add API to Policy Manager
description: Learn how to add a simple API to the Policy Manager Management Console, configure associated Policies and Contracts, and send a test request.
product: ag
category: gs
sub-nav-class: API Management
weight: 04
type: page
nav-title: Add API to Policy Manager
---
<h1 id="top">Add API to Policy Manager</h1>
<p>Learn how to add a simple API to the Policy Manager Management Console, configure associated Policies and Contracts, and send a test request.</p>
<hr class="divide_hr" />



<h2 style="color: gray;">Table of Contents</h2>
<ol class="table_of_contents">
	<li><a href="#introduction">Introduction</a></li>
	<li><a href="#s01_install_and_configure_pm">Step 1: Install and Configure Policy Manager</a></li>
	<li><a href="#s02_add_api_to_pm">Step 2: Add API to Policy Manager</a></li>
	<li><a href="#s03_configure_policies">Step 3: Configure Policies</a></li>
	<li><a href="#s04_create_contracts">Step 4: Create Contracts</a></li>
	<li><a href="#s05_send_test_requests">Step 5: Send Test Request</a></li>
	<li><a href="#uc_auditing">Auditing Use Cases</a></li>
</ol>
<hr class="divide_hr" />



<h2 id="introduction">Introduction</h2>
<p>Learn how to add a simple API to the Policy Manager Management Console, configure associated Policies and Contracts, and send a test request.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="s01_install_and_configure_pm">Step 1: Install and Configure Policy Manager</h2>
<p>Install and configure Policy Manager.</p>
<p>Refer to the applicable installation instructions; go to <a href="../../sp/platform_install/installing_akana_api_platform_all.htm">Installing the Akana API Platform (all versions)</a> and choose the applicable version.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="s02_add_api_to_pm">Step 2: Add API to Policy Manager</h2>
<p>This example uses the Swagger Petstore API, available at <a href="http://petstore.swagger.io/" title="http://petstore.swagger.io/" target="_blank">http://petstore.swagger.io/</a>. The JSON for this API is available at <a href="http://petstore.swagger.io/v2/swagger.json" title="http://petstore.swagger.io/v2/swagger.json" target="_blank">http://petstore.swagger.io/v2/swagger.json</a>. To keep it simple, we will just register the <strong>Get Pet by ID</strong> operation at <a href="http://petstore.swagger.io/#/pet/getPetById" title="http://petstore.swagger.io/#/pet/getPetById" target="_blank">http://petstore.swagger.io/#/pet/getPetById</a><a href="http://demo.akana-dev.net:3005/posts">.</a></p>
<p>There are three main steps:</p>
<ul>
	<li><a href="#s02_01_add_organization">Add Organization</a></li>
	<li><a href="#s02_02_register_api">Register API</a></li>
	<li><a href="#s02_03_add_access_point">Add Access Point to Physical Service</a></li>
</ul>
<p><a href="#top">Back to top</a></p>



<h2 id="s02_01_add_organization">Add Organization</h2>
<ol>
	<li>Log in to the <strong>Policy Manager Management Console</strong>.</li>
	<li>From the Organization Tree, click <strong>Registry</strong>.</li>
	<li>From the <strong>Actions Portlet</strong> on the right, click <strong>Add Organization</strong>.</li>
	<li>Indicate where you'd like to place the organization on the Organization Tree. Click <strong>Next</strong>.</li>
	<li>Give your organization a name, as shown below.
  <p><img src="images/add_api_pm_01.jpg" alt="Add Organization in PM" /></p></li>
	<li>click <strong>Finish</strong>, and then click <strong>Close</strong>.</li>
</ol>
<p><a href="#top">Back to top</a></p>


<h2 id="s02_02_register_api">Register API</h2>
<ol>
	<li>From the Organization Tree, click on the organization you created. </li>
	<li>From the <strong>Actions Portlet</strong> on the right, click <strong>Create Physical Service</strong>.</li>
	<li>Select the <strong>Create Without Using Service Descriptor Document</strong> option and click <strong>Next</strong>.</li>
	<li>On the <strong>Service Details</strong>, specify the following, then click <strong>Next</strong>.
<ul>
	<li><strong>Name</strong>&#8212;The name of the API.</li>
	<li><strong>QName and Localpart</strong>&#8212;in the <strong>Advanced Options</strong> section. This information is used internally by the system to uniquely route to a service or API. If you don't specify values, they are assigned automatically.</li>
</ul>
</li>
	<li>On <strong>Schema Import Options</strong>, select <strong>Use Existing Schemas</strong> and click <strong>Next</strong>.</li>
	<li>Click <strong>Add Operation</strong>. Specify an optional name and description and click <strong>Next</strong>.</li>
	<li>The <strong>Operation Details</strong> page gives you the opportunity to specify Schema elements/types for your operation. For simplicity's sake, under <strong>Schemas</strong>, click &gt;&gt; to assign <strong>anyType</strong> to <strong>Input</strong> and &quot;<strong>Output</strong>. Leave <strong>Fault</strong> blank, and click <strong>Next</strong> to continue.</li>
	<li>
On the <strong>Configure HTTP Binding Properties</strong> page, choose the following and click <strong>Next</strong>. Add the following values, shown in the illustration below:
<ul>
	<li>Method&#8212;This example uses the getPetbyId operation.</li>
	<li>Path&#8212;This is the path for your operation. You can also use regular expressions. For more information, refer to the help panel to the left of the page. </li>
</ul>
<p><img src="images/add_api_pm_02.jpg" alt="Adding the operation details" /></p>
</li>
	<li>Next, choose how you would like to manage the Service (API). Select <strong>Manage through a Virtual Service</strong> option. This will create a proxy service that is hosted in the container. Click <strong>Next</strong>. </li>
	<li>In <strong>Virtual Service Provider Organization</strong>, ensure that the correct organization is selected and click <strong>Next</strong>. </li>
	<li>Select the container that you created when registering the Network Director and click <strong>Next</strong>.</li>
	<li>Select the first Access Point in the list. Provide a name and click <strong>Next</strong>. </li>
	<li>In <strong>HTTP Details</strong>, enter a <strong>Location</strong>; for example, <strong>/posts</strong>.</li>
	<li>Click <strong>Finish</strong>, and then click <strong>Close</strong>. </li>
</ol>
<p>When you've finished, you'll have two services: a physical service and a virtual service.</p>
<p><a href="#top">Back to top</a></p>



<h2 id="s02_03_add_access_point">Add Access Point to Physical Service</h2>
<ol>
	<li>From the Organization Tree, select <strong>Organization</strong> &gt; <strong>Services</strong> of the physical API you're registering.</li>
	<li>Select the <strong>Access Points</strong> tab and click <strong>Add Access Point</strong>.</li>
	<li>Leave all defaults for the <strong>Service Details</strong> and <strong>Binding Details</strong>. </li>
	<li>Add a <strong>WSDL Port Name</strong> and click <strong>Next</strong>.</li>
	<li>Under the <strong>HTTP Details</strong> section, enter the API web address for our example: <a href="http://demo.akana-dev.net:3005/posts">http://demo.akana-dev.net:3005/posts</a> in the <strong>Location</strong> field and click <strong>Finish</strong>.</li>
</ol>
<p><a href="#top">Back to top</a></p>



<h2 id="s03_configure_policies">Step 3: Configure Policies</h2>
<p>Next you will configure your APIs with the policies you want Akana to enforce.</p>
<ol>
	<li>From the Organization Tree, select the organization youâ€™d like to apply the policies to.</li>
	<li>
Click <strong>Policies</strong>. In the <strong>Operational</strong> section of the <strong>Policy Attachments Portlet</strong> click <strong>Manage</strong>. For our example, we will set up an operational policy. The choices are:
<ul>
	<li>Compliance checks that the service is compliant with your set of standards.</li>
	<li>Operations does security and monitoring for the service. </li>
	<li>QoS (Quality of Service) does things like ensure availability, speed, etc. </li>
</ul>
</li>
	<li>From the <strong>Manage Operation Attachments</strong> window, click <strong>Policies &gt; Operational Policies</strong>.</li>
	<li>Choose <strong>DetailedAuditing</strong> then click <strong>Apply</strong>.</li>
</ol>
<p>You can find all descriptions of the policies in the Organization Tree.</p>



<h2 id="s04_create_contracts">Step 4: Create Contracts</h2>
<p>A contract gives someone (typically another application,) authorization to access an API.</p>
<ol>
	<li>From the Organization Tree, select your organization. </li>
	<li>Click <strong>Offer Contract</strong> from the <strong>Actions Portlet</strong>. The <strong>Add Contract Wizard</strong> launches.</li>
	<li>Enter the contract details.</li>
	<li>In the <strong>Access Controls</strong>, select the anonymous contract option (i.e., second option) and click <strong>Next</strong>.</li>
	<li>Select the Provider Organization and click <strong>Finish</strong>. </li>
</ol>
<p>Your contract is now in draft mode. Next you must activate it:</p>
<ol>
	<li>Navigate the Organization Tree to find your Organization. In the <strong>Contracts</strong> folder find your contract. </li>
	<li>Scroll down to the <strong>Consumers</strong> section. You'll see your contract in <strong>Draft</strong> state.</li>
	<li>Click on the contract. In this example, it shows as <strong>Anonymous</strong>.</li>
	<li>Review the contract, then in the <strong>Contracts Actions Portlet</strong> click <strong>Activate Contract</strong>, and then click <strong>OK</strong>.</li>
</ol>



<h2 id="s05_send_test_requests">Step 5: Send Test Request</h2>
<p>To send a test request, you will need the endpoint.</p>
<ol>
	<li>You can find this in the Policy Manager Organization Tree, under {specific Organization} &gt; <strong>Services</strong> &gt; <strong>API</strong>. </li>
	<li>Select the <strong>Access Points</strong> tab. </li>
	<li>Find the URL, and then copy the URL and paste into a browser window. You should get a successful response. </li>
	<li>Verify that the requests are coming through by checking the audit logs. You can see the logs by selecting the organization, then the API. From the API page, click <strong>Monitoring</strong> &gt; <strong>Logs</strong>. You'll see request details. </li>
</ol>


<h2 id="uc_auditing">Auditing Use Cases</h2>
<p>The following detailed use cases illustrate how to perform <strong>basic</strong> or <strong>detailed</strong> auditing of an entire message and view the message metrics in Policy Manager.</p>
<ul>
	<li><a href="../policies/policy_op_basic_auditing.htm#uc_policy_qos_basic_auditing_pm" target="_blank">Basic Auditing Policy: use case for Policy Manager</a></li>
	<li><a href="../policies/policy_op_detailed_auditing.htm#uc_policy_op_detailed_auditing_pm" target="_blank" >Detailed Auditing Policy: use cases</a></li>
</ul>
<p><a href="#top">Back to top</a></p>