---
layout: page
title: Using the DataPower Orchestration Policy
description: Learn how to sequence message flow through DataPower using the Orchestration Policy.
product: ag
category: learn
weight:	8
sub-nav-class: DataPower
type: page
nav-title: Using the DataPower Orchestration Policy
---
  <h2 name="top">Using the DataPower Orchestration Policy</h2>
  <p>Learn how to sequence message flow through DataPower using the Orchestration Policy.</p>


<a href="orch_policy_activities.htm" class="button secondary">Orchestration Policy Activities</a>
<a href="managing_orch_policy.htm" class="button secondary">Managing Orchestration Policy</a>

<a href="datapower_policies.htm" class="button secondary">DataPower Policies</a><p></p>

<a href="../policies/policy_management.htm" class="button secondary">Managing Policies</a>

  <p></p>

  <div class = "divider1"></div>
   <h3 style="color: gray;">Table of Contents</h3>

   <ol class="table_of_contents">

 <li><a href="#introduction">Introduction</a></li>

  <li><a href="#functionality">Functionality</a></li>

  <li><a href="#configuration">Configuration</a></li>


  </ol>
  <div class = "divider1"></div><p></p>

<a name="introduction">
<h3>Introduction</h3></a>

<p>The &quot;Orchestration Policy&quot; is a DataPower specific policy that is installed as part of the &quot;SOA Software IBM for Websphere DataPower&quot; option pack (PolicyManagerForDataPower_xxxx_x.x.x_xxxx.zip). It is installed to the Policy Manager Management Console when the <strong>SOA Software Policy Manager for IBM WebSphere DataPower Console Policy</strong> feature is installed.</p>
<p>The policy allows you to define the sequence of messages as they flow through DataPower. This is achieved by:</p>

<ul class="usingOrderedList">
  <li>Defining a <em>request sequence</em> using the <strong>Add Activity</strong> function where you can define one or more &quot;activities&quot; that represent policies that can be applied to the workflow.</li>
  <li>Activities types supported by the Orchestration Policy include Invoke Service (default), Insert XML, Auditing, User-Defined DataPower Policy, Dynamic User Defined DataPower Policy, and Transformation. See <a href="orch_policy_activities.htm">Orchestration Policy Activities</a> for more information.</li>
  <li>Configuring a <em>reply</em> that represents the message you want to send back to the user (i.e., client) of the virtual service. The reply applies to the entire policy configuration.</li>
  <li>After the activities are defined, you can sequence the order you would like them to be executed inSequencing the policies to the desired order of execution using <strong>Move U</strong>p and <strong>Move Down</strong>.</li>
</ul>
<p><em>Note: The minimum requirement for an Orchestration Policy is one Invoke Service Activity.</em></p>
<p>This policy is available in the Policy Manager &quot;Management Console&quot; if you have performed a DataPower integration by installing the &quot;SOA Software IBM for WebSphere DataPower Option Pack&quot; to the &quot;SOA Software Platform,&quot; and have installed and configured the Policy Manager and DataPower features as outlined in the &quot;Policy Manager for IBM WebSphere DataPower Installation Guide for Windows and UNIX Platforms.&quot;</p>
<p><a href="#top">Back to top</a></p>


<a name="functionality">
<h3>Functionality</h3></a>
<p>The &quot;Orchestration Policy&quot;is a Policy Manager operational policy that includes the following functionality:</p>
<h5>Add Activity</h5>
<p>Activities are added to an Orchestration Policy using the <strong>Add Activity</strong> function. The following activity types are supported.</p>
<ul class="usingOrderedList">
  <li><a href="invoke_service_activity.htm">
 Invoke Service Activity</a></li>


  <li> <a href="insert_xml_activity.htm">
  Insert XML Actiity</a></li>
  <li> <a href="auditing_activity.htm">
  Auditing Activity</a></li>
  <li> <a href="user_defined_dp_policy_activity.htm">
  User-Defined DataPower Policy Activity</a></li>
  <li>  <a href="dynamic_user_defined_dp_policy_activity.htm">
  Dynamic User-Defined DataPower Policy Activity</a></li>
  <li>
  <a href="transformation_activity.htm">
  Transformation Activity</a>
</li>
</ul>
<p><img src="images/add_activity_dropdown_dp.jpg" width="346" height="110"><br>
  Figure. Add Activity drop-down list box</p>
<h5>Sequencing</h5>
  <p>After you have completed configuring Activities for the Dynamic User-Defined DataPower Policy, you must then sequence the activities to the required execution order. Each Activity includes a button bar with Move Up and Move Down buttons for positioning activities.</p>
<p><img src="images/sequence_activities.jpg" width="178" height="34"><br>
  Figure. Sequence Activities
</p>

<h5>Copy Policy</h5>
<p>If you have multiple deployment use cases that require the reuse of one or more DataPower "Processing Rules," you can create one base Dynamic User-Defined DataPower Policy, add multiple Rules, save this as a baseline in the root level "Policies" folder, and use the <strong>Copy Policy</strong> function to replicate a copy of the policy each time you need to create a new one. This way you can save configuration time by removing the rules you do not need, and you can add and customize new rules. </p>
<h5>Message</h5>
<p>You must configure whether to use the default message or User-Defined message for each activity, and in the &quot;Reply With&quot; section which applies to the entire activity configuration. You can customize message output to: </p>
<ul class="usingOrderedList">
  <li>Modify a message.</li>
  <li>Make a call-out to another service and get the results.</li>
  <li>Utilize results to perform another action.</li>
  <li>Attach results to the portion of original message and forward to the Back-end Service for the current virtualized service.</li>
</ul>
<h5>Attach Policy</h5>
<p>Because each Orchestration Policy defines the workflow for a specific service operation, it must also be attached to that service operation.</p>
<ul class="usingOrderedList">
  <li>The policy must be attached via the &quot;Policy Attachments Portlet&quot; at the <em>Organization &gt; Services &gt; Operations</em> level.</li>
  <li>The policy should be attached in the &quot;Operation&quot; section of the Operational Policy Attachments Portlet, and <em>not</em> the &quot;Input Message&quot; or &quot;Output Message&quot; sections.</li>
  <li>Utilize results to perform another action.</li>
  <li>Attach results to the portion of original message and forward to the Back-end Service for the current virtualized service.</li>
</ul>
<p><img src="images/dp_attach_policy.jpg" width="623" height="197"><br>
  Figure. Operational Policy Attachments (Illustration of Orchestration Policy)
</p>
<p><a href="#top">Back to top</a></p>



<a name="configuration">
<h3>Configuration</h3></a>



<p>Let's take a quick walkthrough of the Orchestration   Policy configuration process to get your started.
</p>
<h5>Step 1: Add Policy</h5>

  <p>You can create a Orchestration Policy  instance using <strong>Add Policy</strong> in the <em>Policies &gt; Operational Policies</em> section.</p>
  <h5>Step 2: Modify Policy</h5>
<p>When you <strong>Modify</strong> the Orchestration Policy  policy on the <em>Policy Details</em> page the initial policy will look like this:</p>
<p><img src="images/orch_policy_default.jpg" width="428" height="440"></p>
<h5>Step 3: Configure Policy</h5>
<p>Configure the Orchestration policy as follows:</p>

<ul class="usingOrderedList">
  <li>Add a  <a href="transformation_activity.htm">
  Transformation Activity</a> to transform the DataPower request message into a request message for the mainframe. Place this in a message called <em>mainframe_request</em>.</li>
  <li>Add an <a href="invoke_service_activity.htm">
 Invoke Service Activity</a> using the mainframe account lookup service as the target. The result should go in a message called <em>mainframe_response</em>.</li>
  <li>Add a <a href="transformation_activity.htm">
  Transformation Activity</a> to transform the mainframe response message into an XML message with the account information. Place this in a message called <em>account_data</em>.</li>
  <li>Add an <a href="insert_xml_activity.htm">
  Insert XML Actiity</a> to insert <em>account_data</em> into the message called <em>message</em>, which is the DataPower request message.</li>
  <li>Add an <a href="invoke_service_activity.htm">
 Invoke Service Activity</a> to send the DataPower request message to the backend WebSphere service. The message now includes the account information from the mainframe.    </li>

</ul>
<h5>Step 4: Attach Policy</h5>
<p>Attach the Orchestration Policy to the DataPower service and deploy to DataPower. With these few simple steps, the DataPower service now includes a powerful orchestration that provides a rich integration function for the backend. The follow screenshot shows an example of an Orchestration Policy.</p>
<p><img src="images/orch_policy_example.jpg" width="576" height="548"><br>
  Figure. Example of completed Orchestration Policy
  <br>
</p>
<p><a href="#top">Back to top</a></p>

